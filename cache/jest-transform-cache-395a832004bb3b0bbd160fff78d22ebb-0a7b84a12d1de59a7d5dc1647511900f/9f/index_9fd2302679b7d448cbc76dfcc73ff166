88ed0f95cccf63a23071b24a13c19ef8
"use strict";

exports.__esModule = true;
exports.default = useEvent;

var _createEventHandle = _interopRequireDefault(require("../createEventHandle"));

var _useLayoutEffect = _interopRequireDefault(require("../useLayoutEffect"));

var _useStable = _interopRequireDefault(require("../useStable"));

function _interopRequireDefault(obj) {
  return obj && obj.__esModule ? obj : {
    default: obj
  };
}

function useEvent(event, options) {
  var targetListeners = (0, _useStable.default)(function () {
    return new Map();
  });
  var addListener = (0, _useStable.default)(function () {
    var addEventListener = (0, _createEventHandle.default)(event, options);
    return function (target, callback) {
      var removeTargetListener = targetListeners.get(target);

      if (removeTargetListener != null) {
        removeTargetListener();
      }

      if (callback == null) {
        targetListeners.delete(target);
      }

      var removeEventListener = addEventListener(target, callback);
      targetListeners.set(target, removeEventListener);
      return removeEventListener;
    };
  });
  (0, _useLayoutEffect.default)(function () {
    return function () {
      targetListeners.forEach(function (removeListener) {
        removeListener();
      });
      targetListeners.clear();
    };
  }, []);
  return addListener;
}

module.exports = exports.default;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImluZGV4LmpzIl0sIm5hbWVzIjpbImV4cG9ydHMiLCJfX2VzTW9kdWxlIiwiZGVmYXVsdCIsInVzZUV2ZW50IiwiX2NyZWF0ZUV2ZW50SGFuZGxlIiwiX2ludGVyb3BSZXF1aXJlRGVmYXVsdCIsInJlcXVpcmUiLCJfdXNlTGF5b3V0RWZmZWN0IiwiX3VzZVN0YWJsZSIsIm9iaiIsImV2ZW50Iiwib3B0aW9ucyIsInRhcmdldExpc3RlbmVycyIsIk1hcCIsImFkZExpc3RlbmVyIiwiYWRkRXZlbnRMaXN0ZW5lciIsInRhcmdldCIsImNhbGxiYWNrIiwicmVtb3ZlVGFyZ2V0TGlzdGVuZXIiLCJnZXQiLCJkZWxldGUiLCJyZW1vdmVFdmVudExpc3RlbmVyIiwic2V0IiwiZm9yRWFjaCIsInJlbW92ZUxpc3RlbmVyIiwiY2xlYXIiLCJtb2R1bGUiXSwibWFwcGluZ3MiOiJBQUFBOztBQUVBQSxPQUFPLENBQUNDLFVBQVIsR0FBcUIsSUFBckI7QUFDQUQsT0FBTyxDQUFDRSxPQUFSLEdBQWtCQyxRQUFsQjs7QUFFQSxJQUFJQyxrQkFBa0IsR0FBR0Msc0JBQXNCLENBQUNDLE9BQU8sd0JBQVIsQ0FBL0M7O0FBRUEsSUFBSUMsZ0JBQWdCLEdBQUdGLHNCQUFzQixDQUFDQyxPQUFPLHNCQUFSLENBQTdDOztBQUVBLElBQUlFLFVBQVUsR0FBR0gsc0JBQXNCLENBQUNDLE9BQU8sZ0JBQVIsQ0FBdkM7O0FBRUEsU0FBU0Qsc0JBQVQsQ0FBZ0NJLEdBQWhDLEVBQXFDO0FBQUUsU0FBT0EsR0FBRyxJQUFJQSxHQUFHLENBQUNSLFVBQVgsR0FBd0JRLEdBQXhCLEdBQThCO0FBQUVQLElBQUFBLE9BQU8sRUFBRU87QUFBWCxHQUFyQztBQUF3RDs7QUFvQi9GLFNBQVNOLFFBQVQsQ0FBa0JPLEtBQWxCLEVBQXlCQyxPQUF6QixFQUFrQztBQUNoQyxNQUFJQyxlQUFlLEdBQUcsQ0FBQyxHQUFHSixVQUFVLENBQUNOLE9BQWYsRUFBd0IsWUFBWTtBQUN4RCxXQUFPLElBQUlXLEdBQUosRUFBUDtBQUNELEdBRnFCLENBQXRCO0FBR0EsTUFBSUMsV0FBVyxHQUFHLENBQUMsR0FBR04sVUFBVSxDQUFDTixPQUFmLEVBQXdCLFlBQVk7QUFDcEQsUUFBSWEsZ0JBQWdCLEdBQUcsQ0FBQyxHQUFHWCxrQkFBa0IsQ0FBQ0YsT0FBdkIsRUFBZ0NRLEtBQWhDLEVBQXVDQyxPQUF2QyxDQUF2QjtBQUNBLFdBQU8sVUFBVUssTUFBVixFQUFrQkMsUUFBbEIsRUFBNEI7QUFDakMsVUFBSUMsb0JBQW9CLEdBQUdOLGVBQWUsQ0FBQ08sR0FBaEIsQ0FBb0JILE1BQXBCLENBQTNCOztBQUVBLFVBQUlFLG9CQUFvQixJQUFJLElBQTVCLEVBQWtDO0FBQ2hDQSxRQUFBQSxvQkFBb0I7QUFDckI7O0FBRUQsVUFBSUQsUUFBUSxJQUFJLElBQWhCLEVBQXNCO0FBQ3BCTCxRQUFBQSxlQUFlLENBQUNRLE1BQWhCLENBQXVCSixNQUF2QjtBQUNEOztBQUVELFVBQUlLLG1CQUFtQixHQUFHTixnQkFBZ0IsQ0FBQ0MsTUFBRCxFQUFTQyxRQUFULENBQTFDO0FBQ0FMLE1BQUFBLGVBQWUsQ0FBQ1UsR0FBaEIsQ0FBb0JOLE1BQXBCLEVBQTRCSyxtQkFBNUI7QUFDQSxhQUFPQSxtQkFBUDtBQUNELEtBZEQ7QUFlRCxHQWpCaUIsQ0FBbEI7QUFrQkEsR0FBQyxHQUFHZCxnQkFBZ0IsQ0FBQ0wsT0FBckIsRUFBOEIsWUFBWTtBQUN4QyxXQUFPLFlBQVk7QUFDakJVLE1BQUFBLGVBQWUsQ0FBQ1csT0FBaEIsQ0FBd0IsVUFBVUMsY0FBVixFQUEwQjtBQUNoREEsUUFBQUEsY0FBYztBQUNmLE9BRkQ7QUFHQVosTUFBQUEsZUFBZSxDQUFDYSxLQUFoQjtBQUNELEtBTEQ7QUFNRCxHQVBELEVBT0csRUFQSDtBQVFBLFNBQU9YLFdBQVA7QUFDRDs7QUFFRFksTUFBTSxDQUFDMUIsT0FBUCxHQUFpQkEsT0FBTyxDQUFDRSxPQUF6QiIsInNvdXJjZXNDb250ZW50IjpbIlwidXNlIHN0cmljdFwiO1xuXG5leHBvcnRzLl9fZXNNb2R1bGUgPSB0cnVlO1xuZXhwb3J0cy5kZWZhdWx0ID0gdXNlRXZlbnQ7XG5cbnZhciBfY3JlYXRlRXZlbnRIYW5kbGUgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KHJlcXVpcmUoXCIuLi9jcmVhdGVFdmVudEhhbmRsZVwiKSk7XG5cbnZhciBfdXNlTGF5b3V0RWZmZWN0ID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChyZXF1aXJlKFwiLi4vdXNlTGF5b3V0RWZmZWN0XCIpKTtcblxudmFyIF91c2VTdGFibGUgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KHJlcXVpcmUoXCIuLi91c2VTdGFibGVcIikpO1xuXG5mdW5jdGlvbiBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KG9iaikgeyByZXR1cm4gb2JqICYmIG9iai5fX2VzTW9kdWxlID8gb2JqIDogeyBkZWZhdWx0OiBvYmogfTsgfVxuXG4vKipcbiAqIENvcHlyaWdodCAoYykgRmFjZWJvb2ssIEluYy4gYW5kIGl0cyBhZmZpbGlhdGVzLlxuICpcbiAqIFRoaXMgc291cmNlIGNvZGUgaXMgbGljZW5zZWQgdW5kZXIgdGhlIE1JVCBsaWNlbnNlIGZvdW5kIGluIHRoZVxuICogTElDRU5TRSBmaWxlIGluIHRoZSByb290IGRpcmVjdG9yeSBvZiB0aGlzIHNvdXJjZSB0cmVlLlxuICpcbiAqIFxuICovXG5cbi8qKlxuICogVGhpcyBjYW4gYmUgdXNlZCB3aXRoIGFueSBldmVudCB0eXBlIGluY2x1ZGUgY3VzdG9tIGV2ZW50cy5cbiAqXG4gKiBjb25zdCBjbGljayA9IHVzZUV2ZW50KCdjbGljaycsIG9wdGlvbnMpO1xuICogdXNlRWZmZWN0KCgpID0+IHtcbiAqICAgY2xpY2suc2V0TGlzdGVuZXIodGFyZ2V0LCBvbkNsaWNrKTtcbiAqICAgcmV0dXJuICgpID0+IGNsaWNrLmNsZWFyKCk7XG4gKiB9KS5cbiAqL1xuZnVuY3Rpb24gdXNlRXZlbnQoZXZlbnQsIG9wdGlvbnMpIHtcbiAgdmFyIHRhcmdldExpc3RlbmVycyA9ICgwLCBfdXNlU3RhYmxlLmRlZmF1bHQpKGZ1bmN0aW9uICgpIHtcbiAgICByZXR1cm4gbmV3IE1hcCgpO1xuICB9KTtcbiAgdmFyIGFkZExpc3RlbmVyID0gKDAsIF91c2VTdGFibGUuZGVmYXVsdCkoZnVuY3Rpb24gKCkge1xuICAgIHZhciBhZGRFdmVudExpc3RlbmVyID0gKDAsIF9jcmVhdGVFdmVudEhhbmRsZS5kZWZhdWx0KShldmVudCwgb3B0aW9ucyk7XG4gICAgcmV0dXJuIGZ1bmN0aW9uICh0YXJnZXQsIGNhbGxiYWNrKSB7XG4gICAgICB2YXIgcmVtb3ZlVGFyZ2V0TGlzdGVuZXIgPSB0YXJnZXRMaXN0ZW5lcnMuZ2V0KHRhcmdldCk7XG5cbiAgICAgIGlmIChyZW1vdmVUYXJnZXRMaXN0ZW5lciAhPSBudWxsKSB7XG4gICAgICAgIHJlbW92ZVRhcmdldExpc3RlbmVyKCk7XG4gICAgICB9XG5cbiAgICAgIGlmIChjYWxsYmFjayA9PSBudWxsKSB7XG4gICAgICAgIHRhcmdldExpc3RlbmVycy5kZWxldGUodGFyZ2V0KTtcbiAgICAgIH1cblxuICAgICAgdmFyIHJlbW92ZUV2ZW50TGlzdGVuZXIgPSBhZGRFdmVudExpc3RlbmVyKHRhcmdldCwgY2FsbGJhY2spO1xuICAgICAgdGFyZ2V0TGlzdGVuZXJzLnNldCh0YXJnZXQsIHJlbW92ZUV2ZW50TGlzdGVuZXIpO1xuICAgICAgcmV0dXJuIHJlbW92ZUV2ZW50TGlzdGVuZXI7XG4gICAgfTtcbiAgfSk7XG4gICgwLCBfdXNlTGF5b3V0RWZmZWN0LmRlZmF1bHQpKGZ1bmN0aW9uICgpIHtcbiAgICByZXR1cm4gZnVuY3Rpb24gKCkge1xuICAgICAgdGFyZ2V0TGlzdGVuZXJzLmZvckVhY2goZnVuY3Rpb24gKHJlbW92ZUxpc3RlbmVyKSB7XG4gICAgICAgIHJlbW92ZUxpc3RlbmVyKCk7XG4gICAgICB9KTtcbiAgICAgIHRhcmdldExpc3RlbmVycy5jbGVhcigpO1xuICAgIH07XG4gIH0sIFtdKTtcbiAgcmV0dXJuIGFkZExpc3RlbmVyO1xufVxuXG5tb2R1bGUuZXhwb3J0cyA9IGV4cG9ydHMuZGVmYXVsdDsiXX0=