eacd64089646bc501fb4a371e3a83f7d
"use strict";

exports.__esModule = true;
exports.default = void 0;

var React = _interopRequireWildcard(require("react"));

var _createElement = _interopRequireDefault(require("../createElement"));

var _multiplyStyleLengthValue = _interopRequireDefault(require("../../modules/multiplyStyleLengthValue"));

var _StyleSheet = _interopRequireDefault(require("../StyleSheet"));

var _View = _interopRequireDefault(require("../View"));

function _interopRequireDefault(obj) {
  return obj && obj.__esModule ? obj : {
    default: obj
  };
}

function _getRequireWildcardCache() {
  if (typeof WeakMap !== "function") return null;
  var cache = new WeakMap();

  _getRequireWildcardCache = function _getRequireWildcardCache() {
    return cache;
  };

  return cache;
}

function _interopRequireWildcard(obj) {
  if (obj && obj.__esModule) {
    return obj;
  }

  if (obj === null || typeof obj !== "object" && typeof obj !== "function") {
    return {
      default: obj
    };
  }

  var cache = _getRequireWildcardCache();

  if (cache && cache.has(obj)) {
    return cache.get(obj);
  }

  var newObj = {};
  var hasPropertyDescriptor = Object.defineProperty && Object.getOwnPropertyDescriptor;

  for (var key in obj) {
    if (Object.prototype.hasOwnProperty.call(obj, key)) {
      var desc = hasPropertyDescriptor ? Object.getOwnPropertyDescriptor(obj, key) : null;

      if (desc && (desc.get || desc.set)) {
        Object.defineProperty(newObj, key, desc);
      } else {
        newObj[key] = obj[key];
      }
    }
  }

  newObj.default = obj;

  if (cache) {
    cache.set(obj, newObj);
  }

  return newObj;
}

function ownKeys(object, enumerableOnly) {
  var keys = Object.keys(object);

  if (Object.getOwnPropertySymbols) {
    var symbols = Object.getOwnPropertySymbols(object);
    if (enumerableOnly) symbols = symbols.filter(function (sym) {
      return Object.getOwnPropertyDescriptor(object, sym).enumerable;
    });
    keys.push.apply(keys, symbols);
  }

  return keys;
}

function _objectSpread(target) {
  for (var i = 1; i < arguments.length; i++) {
    var source = arguments[i] != null ? arguments[i] : {};

    if (i % 2) {
      ownKeys(Object(source), true).forEach(function (key) {
        _defineProperty(target, key, source[key]);
      });
    } else if (Object.getOwnPropertyDescriptors) {
      Object.defineProperties(target, Object.getOwnPropertyDescriptors(source));
    } else {
      ownKeys(Object(source)).forEach(function (key) {
        Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key));
      });
    }
  }

  return target;
}

function _defineProperty(obj, key, value) {
  if (key in obj) {
    Object.defineProperty(obj, key, {
      value: value,
      enumerable: true,
      configurable: true,
      writable: true
    });
  } else {
    obj[key] = value;
  }

  return obj;
}

function _extends() {
  _extends = Object.assign || function (target) {
    for (var i = 1; i < arguments.length; i++) {
      var source = arguments[i];

      for (var key in source) {
        if (Object.prototype.hasOwnProperty.call(source, key)) {
          target[key] = source[key];
        }
      }
    }

    return target;
  };

  return _extends.apply(this, arguments);
}

function _objectWithoutPropertiesLoose(source, excluded) {
  if (source == null) return {};
  var target = {};
  var sourceKeys = Object.keys(source);
  var key, i;

  for (i = 0; i < sourceKeys.length; i++) {
    key = sourceKeys[i];
    if (excluded.indexOf(key) >= 0) continue;
    target[key] = source[key];
  }

  return target;
}

var emptyObject = {};
var thumbDefaultBoxShadow = '0px 1px 3px rgba(0,0,0,0.5)';
var thumbFocusedBoxShadow = thumbDefaultBoxShadow + ", 0 0 0 10px rgba(0,0,0,0.1)";
var Switch = React.forwardRef(function (props, forwardedRef) {
  var accessibilityLabel = props.accessibilityLabel,
      _props$activeThumbCol = props.activeThumbColor,
      activeThumbColor = _props$activeThumbCol === void 0 ? '#009688' : _props$activeThumbCol,
      _props$activeTrackCol = props.activeTrackColor,
      activeTrackColor = _props$activeTrackCol === void 0 ? '#A3D3CF' : _props$activeTrackCol,
      _props$disabled = props.disabled,
      disabled = _props$disabled === void 0 ? false : _props$disabled,
      onValueChange = props.onValueChange,
      _props$style = props.style,
      style = _props$style === void 0 ? emptyObject : _props$style,
      _props$thumbColor = props.thumbColor,
      thumbColor = _props$thumbColor === void 0 ? '#FAFAFA' : _props$thumbColor,
      _props$trackColor = props.trackColor,
      trackColor = _props$trackColor === void 0 ? '#939393' : _props$trackColor,
      _props$value = props.value,
      value = _props$value === void 0 ? false : _props$value,
      other = _objectWithoutPropertiesLoose(props, ["accessibilityLabel", "activeThumbColor", "activeTrackColor", "disabled", "onValueChange", "style", "thumbColor", "trackColor", "value"]);

  var thumbRef = React.useRef(null);

  function handleChange(event) {
    if (onValueChange != null) {
      onValueChange(event.nativeEvent.target.checked);
    }
  }

  function handleFocusState(event) {
    var isFocused = event.nativeEvent.type === 'focus';
    var boxShadow = isFocused ? thumbFocusedBoxShadow : thumbDefaultBoxShadow;

    if (thumbRef.current != null) {
      thumbRef.current.style.boxShadow = boxShadow;
    }
  }

  var _StyleSheet$flatten = _StyleSheet.default.flatten(style),
      styleHeight = _StyleSheet$flatten.height,
      styleWidth = _StyleSheet$flatten.width;

  var height = styleHeight || '20px';
  var minWidth = (0, _multiplyStyleLengthValue.default)(height, 2);
  var width = styleWidth > minWidth ? styleWidth : minWidth;
  var trackBorderRadius = (0, _multiplyStyleLengthValue.default)(height, 0.5);

  var trackCurrentColor = function () {
    if (value === true) {
      if (trackColor != null && typeof trackColor === 'object') {
        return trackColor.true;
      } else {
        return activeTrackColor;
      }
    } else {
      if (trackColor != null && typeof trackColor === 'object') {
        return trackColor.false;
      } else {
        return trackColor;
      }
    }
  }();

  var thumbCurrentColor = value ? activeThumbColor : thumbColor;
  var thumbHeight = height;
  var thumbWidth = thumbHeight;
  var rootStyle = [styles.root, style, disabled && styles.cursorDefault, {
    height: height,
    width: width
  }];
  var trackStyle = [styles.track, {
    backgroundColor: disabled ? '#D5D5D5' : trackCurrentColor,
    borderRadius: trackBorderRadius
  }];
  var thumbStyle = [styles.thumb, value && styles.thumbActive, {
    backgroundColor: disabled ? '#BDBDBD' : thumbCurrentColor,
    height: thumbHeight,
    marginStart: value ? (0, _multiplyStyleLengthValue.default)(thumbWidth, -1) : 0,
    width: thumbWidth
  }];
  var nativeControl = (0, _createElement.default)('input', {
    accessibilityLabel: accessibilityLabel,
    checked: value,
    disabled: disabled,
    onBlur: handleFocusState,
    onChange: handleChange,
    onFocus: handleFocusState,
    ref: forwardedRef,
    style: [styles.nativeControl, styles.cursorInherit],
    type: 'checkbox',
    role: 'switch'
  });
  return React.createElement(_View.default, _extends({}, other, {
    style: rootStyle
  }), React.createElement(_View.default, {
    style: trackStyle
  }), React.createElement(_View.default, {
    ref: thumbRef,
    style: thumbStyle
  }), nativeControl);
});
Switch.displayName = 'Switch';

var styles = _StyleSheet.default.create({
  root: {
    cursor: 'pointer',
    userSelect: 'none'
  },
  cursorDefault: {
    cursor: 'default'
  },
  cursorInherit: {
    cursor: 'inherit'
  },
  track: _objectSpread(_objectSpread({
    forcedColorAdjust: 'none'
  }, _StyleSheet.default.absoluteFillObject), {}, {
    height: '70%',
    margin: 'auto',
    transitionDuration: '0.1s',
    width: '100%'
  }),
  thumb: {
    forcedColorAdjust: 'none',
    alignSelf: 'flex-start',
    borderRadius: '100%',
    boxShadow: thumbDefaultBoxShadow,
    start: '0%',
    transform: [{
      translateZ: 0
    }],
    transitionDuration: '0.1s'
  },
  thumbActive: {
    start: '100%'
  },
  nativeControl: _objectSpread(_objectSpread({}, _StyleSheet.default.absoluteFillObject), {}, {
    height: '100%',
    margin: 0,
    opacity: 0,
    padding: 0,
    width: '100%'
  })
});

var _default = Switch;
exports.default = _default;
module.exports = exports.default;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImluZGV4LmpzIl0sIm5hbWVzIjpbImV4cG9ydHMiLCJfX2VzTW9kdWxlIiwiZGVmYXVsdCIsIlJlYWN0IiwiX2ludGVyb3BSZXF1aXJlV2lsZGNhcmQiLCJyZXF1aXJlIiwiX2NyZWF0ZUVsZW1lbnQiLCJfaW50ZXJvcFJlcXVpcmVEZWZhdWx0IiwiX211bHRpcGx5U3R5bGVMZW5ndGhWYWx1ZSIsIl9TdHlsZVNoZWV0IiwiX1ZpZXciLCJvYmoiLCJfZ2V0UmVxdWlyZVdpbGRjYXJkQ2FjaGUiLCJXZWFrTWFwIiwiY2FjaGUiLCJoYXMiLCJnZXQiLCJuZXdPYmoiLCJoYXNQcm9wZXJ0eURlc2NyaXB0b3IiLCJPYmplY3QiLCJkZWZpbmVQcm9wZXJ0eSIsImdldE93blByb3BlcnR5RGVzY3JpcHRvciIsImtleSIsInByb3RvdHlwZSIsImhhc093blByb3BlcnR5IiwiY2FsbCIsImRlc2MiLCJzZXQiLCJvd25LZXlzIiwib2JqZWN0IiwiZW51bWVyYWJsZU9ubHkiLCJrZXlzIiwiZ2V0T3duUHJvcGVydHlTeW1ib2xzIiwic3ltYm9scyIsImZpbHRlciIsInN5bSIsImVudW1lcmFibGUiLCJwdXNoIiwiYXBwbHkiLCJfb2JqZWN0U3ByZWFkIiwidGFyZ2V0IiwiaSIsImFyZ3VtZW50cyIsImxlbmd0aCIsInNvdXJjZSIsImZvckVhY2giLCJfZGVmaW5lUHJvcGVydHkiLCJnZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3JzIiwiZGVmaW5lUHJvcGVydGllcyIsInZhbHVlIiwiY29uZmlndXJhYmxlIiwid3JpdGFibGUiLCJfZXh0ZW5kcyIsImFzc2lnbiIsIl9vYmplY3RXaXRob3V0UHJvcGVydGllc0xvb3NlIiwiZXhjbHVkZWQiLCJzb3VyY2VLZXlzIiwiaW5kZXhPZiIsImVtcHR5T2JqZWN0IiwidGh1bWJEZWZhdWx0Qm94U2hhZG93IiwidGh1bWJGb2N1c2VkQm94U2hhZG93IiwiU3dpdGNoIiwiZm9yd2FyZFJlZiIsInByb3BzIiwiZm9yd2FyZGVkUmVmIiwiYWNjZXNzaWJpbGl0eUxhYmVsIiwiX3Byb3BzJGFjdGl2ZVRodW1iQ29sIiwiYWN0aXZlVGh1bWJDb2xvciIsIl9wcm9wcyRhY3RpdmVUcmFja0NvbCIsImFjdGl2ZVRyYWNrQ29sb3IiLCJfcHJvcHMkZGlzYWJsZWQiLCJkaXNhYmxlZCIsIm9uVmFsdWVDaGFuZ2UiLCJfcHJvcHMkc3R5bGUiLCJzdHlsZSIsIl9wcm9wcyR0aHVtYkNvbG9yIiwidGh1bWJDb2xvciIsIl9wcm9wcyR0cmFja0NvbG9yIiwidHJhY2tDb2xvciIsIl9wcm9wcyR2YWx1ZSIsIm90aGVyIiwidGh1bWJSZWYiLCJ1c2VSZWYiLCJoYW5kbGVDaGFuZ2UiLCJldmVudCIsIm5hdGl2ZUV2ZW50IiwiY2hlY2tlZCIsImhhbmRsZUZvY3VzU3RhdGUiLCJpc0ZvY3VzZWQiLCJ0eXBlIiwiYm94U2hhZG93IiwiY3VycmVudCIsIl9TdHlsZVNoZWV0JGZsYXR0ZW4iLCJmbGF0dGVuIiwic3R5bGVIZWlnaHQiLCJoZWlnaHQiLCJzdHlsZVdpZHRoIiwid2lkdGgiLCJtaW5XaWR0aCIsInRyYWNrQm9yZGVyUmFkaXVzIiwidHJhY2tDdXJyZW50Q29sb3IiLCJ0cnVlIiwiZmFsc2UiLCJ0aHVtYkN1cnJlbnRDb2xvciIsInRodW1iSGVpZ2h0IiwidGh1bWJXaWR0aCIsInJvb3RTdHlsZSIsInN0eWxlcyIsInJvb3QiLCJjdXJzb3JEZWZhdWx0IiwidHJhY2tTdHlsZSIsInRyYWNrIiwiYmFja2dyb3VuZENvbG9yIiwiYm9yZGVyUmFkaXVzIiwidGh1bWJTdHlsZSIsInRodW1iIiwidGh1bWJBY3RpdmUiLCJtYXJnaW5TdGFydCIsIm5hdGl2ZUNvbnRyb2wiLCJvbkJsdXIiLCJvbkNoYW5nZSIsIm9uRm9jdXMiLCJyZWYiLCJjdXJzb3JJbmhlcml0Iiwicm9sZSIsImNyZWF0ZUVsZW1lbnQiLCJkaXNwbGF5TmFtZSIsImNyZWF0ZSIsImN1cnNvciIsInVzZXJTZWxlY3QiLCJmb3JjZWRDb2xvckFkanVzdCIsImFic29sdXRlRmlsbE9iamVjdCIsIm1hcmdpbiIsInRyYW5zaXRpb25EdXJhdGlvbiIsImFsaWduU2VsZiIsInN0YXJ0IiwidHJhbnNmb3JtIiwidHJhbnNsYXRlWiIsIm9wYWNpdHkiLCJwYWRkaW5nIiwiX2RlZmF1bHQiLCJtb2R1bGUiXSwibWFwcGluZ3MiOiJBQUFBOztBQUVBQSxPQUFPLENBQUNDLFVBQVIsR0FBcUIsSUFBckI7QUFDQUQsT0FBTyxDQUFDRSxPQUFSLEdBQWtCLEtBQUssQ0FBdkI7O0FBRUEsSUFBSUMsS0FBSyxHQUFHQyx1QkFBdUIsQ0FBQ0MsT0FBTyxDQUFDLE9BQUQsQ0FBUixDQUFuQzs7QUFFQSxJQUFJQyxjQUFjLEdBQUdDLHNCQUFzQixDQUFDRixPQUFPLG9CQUFSLENBQTNDOztBQUVBLElBQUlHLHlCQUF5QixHQUFHRCxzQkFBc0IsQ0FBQ0YsT0FBTywwQ0FBUixDQUF0RDs7QUFFQSxJQUFJSSxXQUFXLEdBQUdGLHNCQUFzQixDQUFDRixPQUFPLGlCQUFSLENBQXhDOztBQUVBLElBQUlLLEtBQUssR0FBR0gsc0JBQXNCLENBQUNGLE9BQU8sV0FBUixDQUFsQzs7QUFFQSxTQUFTRSxzQkFBVCxDQUFnQ0ksR0FBaEMsRUFBcUM7QUFBRSxTQUFPQSxHQUFHLElBQUlBLEdBQUcsQ0FBQ1YsVUFBWCxHQUF3QlUsR0FBeEIsR0FBOEI7QUFBRVQsSUFBQUEsT0FBTyxFQUFFUztBQUFYLEdBQXJDO0FBQXdEOztBQUUvRixTQUFTQyx3QkFBVCxHQUFvQztBQUFFLE1BQUksT0FBT0MsT0FBUCxLQUFtQixVQUF2QixFQUFtQyxPQUFPLElBQVA7QUFBYSxNQUFJQyxLQUFLLEdBQUcsSUFBSUQsT0FBSixFQUFaOztBQUEyQkQsRUFBQUEsd0JBQXdCLEdBQUcsU0FBU0Esd0JBQVQsR0FBb0M7QUFBRSxXQUFPRSxLQUFQO0FBQWUsR0FBaEY7O0FBQWtGLFNBQU9BLEtBQVA7QUFBZTs7QUFFbE4sU0FBU1YsdUJBQVQsQ0FBaUNPLEdBQWpDLEVBQXNDO0FBQUUsTUFBSUEsR0FBRyxJQUFJQSxHQUFHLENBQUNWLFVBQWYsRUFBMkI7QUFBRSxXQUFPVSxHQUFQO0FBQWE7O0FBQUMsTUFBSUEsR0FBRyxLQUFLLElBQVIsSUFBZ0IsT0FBT0EsR0FBUCxLQUFlLFFBQWYsSUFBMkIsT0FBT0EsR0FBUCxLQUFlLFVBQTlELEVBQTBFO0FBQUUsV0FBTztBQUFFVCxNQUFBQSxPQUFPLEVBQUVTO0FBQVgsS0FBUDtBQUEwQjs7QUFBQyxNQUFJRyxLQUFLLEdBQUdGLHdCQUF3QixFQUFwQzs7QUFBd0MsTUFBSUUsS0FBSyxJQUFJQSxLQUFLLENBQUNDLEdBQU4sQ0FBVUosR0FBVixDQUFiLEVBQTZCO0FBQUUsV0FBT0csS0FBSyxDQUFDRSxHQUFOLENBQVVMLEdBQVYsQ0FBUDtBQUF3Qjs7QUFBQyxNQUFJTSxNQUFNLEdBQUcsRUFBYjtBQUFpQixNQUFJQyxxQkFBcUIsR0FBR0MsTUFBTSxDQUFDQyxjQUFQLElBQXlCRCxNQUFNLENBQUNFLHdCQUE1RDs7QUFBc0YsT0FBSyxJQUFJQyxHQUFULElBQWdCWCxHQUFoQixFQUFxQjtBQUFFLFFBQUlRLE1BQU0sQ0FBQ0ksU0FBUCxDQUFpQkMsY0FBakIsQ0FBZ0NDLElBQWhDLENBQXFDZCxHQUFyQyxFQUEwQ1csR0FBMUMsQ0FBSixFQUFvRDtBQUFFLFVBQUlJLElBQUksR0FBR1IscUJBQXFCLEdBQUdDLE1BQU0sQ0FBQ0Usd0JBQVAsQ0FBZ0NWLEdBQWhDLEVBQXFDVyxHQUFyQyxDQUFILEdBQStDLElBQS9FOztBQUFxRixVQUFJSSxJQUFJLEtBQUtBLElBQUksQ0FBQ1YsR0FBTCxJQUFZVSxJQUFJLENBQUNDLEdBQXRCLENBQVIsRUFBb0M7QUFBRVIsUUFBQUEsTUFBTSxDQUFDQyxjQUFQLENBQXNCSCxNQUF0QixFQUE4QkssR0FBOUIsRUFBbUNJLElBQW5DO0FBQTJDLE9BQWpGLE1BQXVGO0FBQUVULFFBQUFBLE1BQU0sQ0FBQ0ssR0FBRCxDQUFOLEdBQWNYLEdBQUcsQ0FBQ1csR0FBRCxDQUFqQjtBQUF5QjtBQUFFO0FBQUU7O0FBQUNMLEVBQUFBLE1BQU0sQ0FBQ2YsT0FBUCxHQUFpQlMsR0FBakI7O0FBQXNCLE1BQUlHLEtBQUosRUFBVztBQUFFQSxJQUFBQSxLQUFLLENBQUNhLEdBQU4sQ0FBVWhCLEdBQVYsRUFBZU0sTUFBZjtBQUF5Qjs7QUFBQyxTQUFPQSxNQUFQO0FBQWdCOztBQUV2dUIsU0FBU1csT0FBVCxDQUFpQkMsTUFBakIsRUFBeUJDLGNBQXpCLEVBQXlDO0FBQUUsTUFBSUMsSUFBSSxHQUFHWixNQUFNLENBQUNZLElBQVAsQ0FBWUYsTUFBWixDQUFYOztBQUFnQyxNQUFJVixNQUFNLENBQUNhLHFCQUFYLEVBQWtDO0FBQUUsUUFBSUMsT0FBTyxHQUFHZCxNQUFNLENBQUNhLHFCQUFQLENBQTZCSCxNQUE3QixDQUFkO0FBQW9ELFFBQUlDLGNBQUosRUFBb0JHLE9BQU8sR0FBR0EsT0FBTyxDQUFDQyxNQUFSLENBQWUsVUFBVUMsR0FBVixFQUFlO0FBQUUsYUFBT2hCLE1BQU0sQ0FBQ0Usd0JBQVAsQ0FBZ0NRLE1BQWhDLEVBQXdDTSxHQUF4QyxFQUE2Q0MsVUFBcEQ7QUFBaUUsS0FBakcsQ0FBVjtBQUE4R0wsSUFBQUEsSUFBSSxDQUFDTSxJQUFMLENBQVVDLEtBQVYsQ0FBZ0JQLElBQWhCLEVBQXNCRSxPQUF0QjtBQUFpQzs7QUFBQyxTQUFPRixJQUFQO0FBQWM7O0FBRXJWLFNBQVNRLGFBQVQsQ0FBdUJDLE1BQXZCLEVBQStCO0FBQUUsT0FBSyxJQUFJQyxDQUFDLEdBQUcsQ0FBYixFQUFnQkEsQ0FBQyxHQUFHQyxTQUFTLENBQUNDLE1BQTlCLEVBQXNDRixDQUFDLEVBQXZDLEVBQTJDO0FBQUUsUUFBSUcsTUFBTSxHQUFHRixTQUFTLENBQUNELENBQUQsQ0FBVCxJQUFnQixJQUFoQixHQUF1QkMsU0FBUyxDQUFDRCxDQUFELENBQWhDLEdBQXNDLEVBQW5EOztBQUF1RCxRQUFJQSxDQUFDLEdBQUcsQ0FBUixFQUFXO0FBQUViLE1BQUFBLE9BQU8sQ0FBQ1QsTUFBTSxDQUFDeUIsTUFBRCxDQUFQLEVBQWlCLElBQWpCLENBQVAsQ0FBOEJDLE9BQTlCLENBQXNDLFVBQVV2QixHQUFWLEVBQWU7QUFBRXdCLFFBQUFBLGVBQWUsQ0FBQ04sTUFBRCxFQUFTbEIsR0FBVCxFQUFjc0IsTUFBTSxDQUFDdEIsR0FBRCxDQUFwQixDQUFmO0FBQTRDLE9BQW5HO0FBQXVHLEtBQXBILE1BQTBILElBQUlILE1BQU0sQ0FBQzRCLHlCQUFYLEVBQXNDO0FBQUU1QixNQUFBQSxNQUFNLENBQUM2QixnQkFBUCxDQUF3QlIsTUFBeEIsRUFBZ0NyQixNQUFNLENBQUM0Qix5QkFBUCxDQUFpQ0gsTUFBakMsQ0FBaEM7QUFBNEUsS0FBcEgsTUFBMEg7QUFBRWhCLE1BQUFBLE9BQU8sQ0FBQ1QsTUFBTSxDQUFDeUIsTUFBRCxDQUFQLENBQVAsQ0FBd0JDLE9BQXhCLENBQWdDLFVBQVV2QixHQUFWLEVBQWU7QUFBRUgsUUFBQUEsTUFBTSxDQUFDQyxjQUFQLENBQXNCb0IsTUFBdEIsRUFBOEJsQixHQUE5QixFQUFtQ0gsTUFBTSxDQUFDRSx3QkFBUCxDQUFnQ3VCLE1BQWhDLEVBQXdDdEIsR0FBeEMsQ0FBbkM7QUFBbUYsT0FBcEk7QUFBd0k7QUFBRTs7QUFBQyxTQUFPa0IsTUFBUDtBQUFnQjs7QUFFdGhCLFNBQVNNLGVBQVQsQ0FBeUJuQyxHQUF6QixFQUE4QlcsR0FBOUIsRUFBbUMyQixLQUFuQyxFQUEwQztBQUFFLE1BQUkzQixHQUFHLElBQUlYLEdBQVgsRUFBZ0I7QUFBRVEsSUFBQUEsTUFBTSxDQUFDQyxjQUFQLENBQXNCVCxHQUF0QixFQUEyQlcsR0FBM0IsRUFBZ0M7QUFBRTJCLE1BQUFBLEtBQUssRUFBRUEsS0FBVDtBQUFnQmIsTUFBQUEsVUFBVSxFQUFFLElBQTVCO0FBQWtDYyxNQUFBQSxZQUFZLEVBQUUsSUFBaEQ7QUFBc0RDLE1BQUFBLFFBQVEsRUFBRTtBQUFoRSxLQUFoQztBQUEwRyxHQUE1SCxNQUFrSTtBQUFFeEMsSUFBQUEsR0FBRyxDQUFDVyxHQUFELENBQUgsR0FBVzJCLEtBQVg7QUFBbUI7O0FBQUMsU0FBT3RDLEdBQVA7QUFBYTs7QUFFak4sU0FBU3lDLFFBQVQsR0FBb0I7QUFBRUEsRUFBQUEsUUFBUSxHQUFHakMsTUFBTSxDQUFDa0MsTUFBUCxJQUFpQixVQUFVYixNQUFWLEVBQWtCO0FBQUUsU0FBSyxJQUFJQyxDQUFDLEdBQUcsQ0FBYixFQUFnQkEsQ0FBQyxHQUFHQyxTQUFTLENBQUNDLE1BQTlCLEVBQXNDRixDQUFDLEVBQXZDLEVBQTJDO0FBQUUsVUFBSUcsTUFBTSxHQUFHRixTQUFTLENBQUNELENBQUQsQ0FBdEI7O0FBQTJCLFdBQUssSUFBSW5CLEdBQVQsSUFBZ0JzQixNQUFoQixFQUF3QjtBQUFFLFlBQUl6QixNQUFNLENBQUNJLFNBQVAsQ0FBaUJDLGNBQWpCLENBQWdDQyxJQUFoQyxDQUFxQ21CLE1BQXJDLEVBQTZDdEIsR0FBN0MsQ0FBSixFQUF1RDtBQUFFa0IsVUFBQUEsTUFBTSxDQUFDbEIsR0FBRCxDQUFOLEdBQWNzQixNQUFNLENBQUN0QixHQUFELENBQXBCO0FBQTRCO0FBQUU7QUFBRTs7QUFBQyxXQUFPa0IsTUFBUDtBQUFnQixHQUE1UDs7QUFBOFAsU0FBT1ksUUFBUSxDQUFDZCxLQUFULENBQWUsSUFBZixFQUFxQkksU0FBckIsQ0FBUDtBQUF5Qzs7QUFFN1QsU0FBU1ksNkJBQVQsQ0FBdUNWLE1BQXZDLEVBQStDVyxRQUEvQyxFQUF5RDtBQUFFLE1BQUlYLE1BQU0sSUFBSSxJQUFkLEVBQW9CLE9BQU8sRUFBUDtBQUFXLE1BQUlKLE1BQU0sR0FBRyxFQUFiO0FBQWlCLE1BQUlnQixVQUFVLEdBQUdyQyxNQUFNLENBQUNZLElBQVAsQ0FBWWEsTUFBWixDQUFqQjtBQUFzQyxNQUFJdEIsR0FBSixFQUFTbUIsQ0FBVDs7QUFBWSxPQUFLQSxDQUFDLEdBQUcsQ0FBVCxFQUFZQSxDQUFDLEdBQUdlLFVBQVUsQ0FBQ2IsTUFBM0IsRUFBbUNGLENBQUMsRUFBcEMsRUFBd0M7QUFBRW5CLElBQUFBLEdBQUcsR0FBR2tDLFVBQVUsQ0FBQ2YsQ0FBRCxDQUFoQjtBQUFxQixRQUFJYyxRQUFRLENBQUNFLE9BQVQsQ0FBaUJuQyxHQUFqQixLQUF5QixDQUE3QixFQUFnQztBQUFVa0IsSUFBQUEsTUFBTSxDQUFDbEIsR0FBRCxDQUFOLEdBQWNzQixNQUFNLENBQUN0QixHQUFELENBQXBCO0FBQTRCOztBQUFDLFNBQU9rQixNQUFQO0FBQWdCOztBQUVuVCxJQUFJa0IsV0FBVyxHQUFHLEVBQWxCO0FBQ0EsSUFBSUMscUJBQXFCLEdBQUcsNkJBQTVCO0FBQ0EsSUFBSUMscUJBQXFCLEdBQUdELHFCQUFxQixHQUFHLDhCQUFwRDtBQUNBLElBQUlFLE1BQU0sR0FBZ0IxRCxLQUFLLENBQUMyRCxVQUFOLENBQWlCLFVBQVVDLEtBQVYsRUFBaUJDLFlBQWpCLEVBQStCO0FBQ3hFLE1BQUlDLGtCQUFrQixHQUFHRixLQUFLLENBQUNFLGtCQUEvQjtBQUFBLE1BQ0lDLHFCQUFxQixHQUFHSCxLQUFLLENBQUNJLGdCQURsQztBQUFBLE1BRUlBLGdCQUFnQixHQUFHRCxxQkFBcUIsS0FBSyxLQUFLLENBQS9CLEdBQW1DLFNBQW5DLEdBQStDQSxxQkFGdEU7QUFBQSxNQUdJRSxxQkFBcUIsR0FBR0wsS0FBSyxDQUFDTSxnQkFIbEM7QUFBQSxNQUlJQSxnQkFBZ0IsR0FBR0QscUJBQXFCLEtBQUssS0FBSyxDQUEvQixHQUFtQyxTQUFuQyxHQUErQ0EscUJBSnRFO0FBQUEsTUFLSUUsZUFBZSxHQUFHUCxLQUFLLENBQUNRLFFBTDVCO0FBQUEsTUFNSUEsUUFBUSxHQUFHRCxlQUFlLEtBQUssS0FBSyxDQUF6QixHQUE2QixLQUE3QixHQUFxQ0EsZUFOcEQ7QUFBQSxNQU9JRSxhQUFhLEdBQUdULEtBQUssQ0FBQ1MsYUFQMUI7QUFBQSxNQVFJQyxZQUFZLEdBQUdWLEtBQUssQ0FBQ1csS0FSekI7QUFBQSxNQVNJQSxLQUFLLEdBQUdELFlBQVksS0FBSyxLQUFLLENBQXRCLEdBQTBCZixXQUExQixHQUF3Q2UsWUFUcEQ7QUFBQSxNQVVJRSxpQkFBaUIsR0FBR1osS0FBSyxDQUFDYSxVQVY5QjtBQUFBLE1BV0lBLFVBQVUsR0FBR0QsaUJBQWlCLEtBQUssS0FBSyxDQUEzQixHQUErQixTQUEvQixHQUEyQ0EsaUJBWDVEO0FBQUEsTUFZSUUsaUJBQWlCLEdBQUdkLEtBQUssQ0FBQ2UsVUFaOUI7QUFBQSxNQWFJQSxVQUFVLEdBQUdELGlCQUFpQixLQUFLLEtBQUssQ0FBM0IsR0FBK0IsU0FBL0IsR0FBMkNBLGlCQWI1RDtBQUFBLE1BY0lFLFlBQVksR0FBR2hCLEtBQUssQ0FBQ2QsS0FkekI7QUFBQSxNQWVJQSxLQUFLLEdBQUc4QixZQUFZLEtBQUssS0FBSyxDQUF0QixHQUEwQixLQUExQixHQUFrQ0EsWUFmOUM7QUFBQSxNQWdCSUMsS0FBSyxHQUFHMUIsNkJBQTZCLENBQUNTLEtBQUQsRUFBUSxDQUFDLG9CQUFELEVBQXVCLGtCQUF2QixFQUEyQyxrQkFBM0MsRUFBK0QsVUFBL0QsRUFBMkUsZUFBM0UsRUFBNEYsT0FBNUYsRUFBcUcsWUFBckcsRUFBbUgsWUFBbkgsRUFBaUksT0FBakksQ0FBUixDQWhCekM7O0FBa0JBLE1BQUlrQixRQUFRLEdBQUc5RSxLQUFLLENBQUMrRSxNQUFOLENBQWEsSUFBYixDQUFmOztBQUVBLFdBQVNDLFlBQVQsQ0FBc0JDLEtBQXRCLEVBQTZCO0FBQzNCLFFBQUlaLGFBQWEsSUFBSSxJQUFyQixFQUEyQjtBQUN6QkEsTUFBQUEsYUFBYSxDQUFDWSxLQUFLLENBQUNDLFdBQU4sQ0FBa0I3QyxNQUFsQixDQUF5QjhDLE9BQTFCLENBQWI7QUFDRDtBQUNGOztBQUVELFdBQVNDLGdCQUFULENBQTBCSCxLQUExQixFQUFpQztBQUMvQixRQUFJSSxTQUFTLEdBQUdKLEtBQUssQ0FBQ0MsV0FBTixDQUFrQkksSUFBbEIsS0FBMkIsT0FBM0M7QUFDQSxRQUFJQyxTQUFTLEdBQUdGLFNBQVMsR0FBRzVCLHFCQUFILEdBQTJCRCxxQkFBcEQ7O0FBRUEsUUFBSXNCLFFBQVEsQ0FBQ1UsT0FBVCxJQUFvQixJQUF4QixFQUE4QjtBQUM1QlYsTUFBQUEsUUFBUSxDQUFDVSxPQUFULENBQWlCakIsS0FBakIsQ0FBdUJnQixTQUF2QixHQUFtQ0EsU0FBbkM7QUFDRDtBQUNGOztBQUVELE1BQUlFLG1CQUFtQixHQUFHbkYsV0FBVyxDQUFDUCxPQUFaLENBQW9CMkYsT0FBcEIsQ0FBNEJuQixLQUE1QixDQUExQjtBQUFBLE1BQ0lvQixXQUFXLEdBQUdGLG1CQUFtQixDQUFDRyxNQUR0QztBQUFBLE1BRUlDLFVBQVUsR0FBR0osbUJBQW1CLENBQUNLLEtBRnJDOztBQUlBLE1BQUlGLE1BQU0sR0FBR0QsV0FBVyxJQUFJLE1BQTVCO0FBQ0EsTUFBSUksUUFBUSxHQUFHLENBQUMsR0FBRzFGLHlCQUF5QixDQUFDTixPQUE5QixFQUF1QzZGLE1BQXZDLEVBQStDLENBQS9DLENBQWY7QUFDQSxNQUFJRSxLQUFLLEdBQUdELFVBQVUsR0FBR0UsUUFBYixHQUF3QkYsVUFBeEIsR0FBcUNFLFFBQWpEO0FBQ0EsTUFBSUMsaUJBQWlCLEdBQUcsQ0FBQyxHQUFHM0YseUJBQXlCLENBQUNOLE9BQTlCLEVBQXVDNkYsTUFBdkMsRUFBK0MsR0FBL0MsQ0FBeEI7O0FBRUEsTUFBSUssaUJBQWlCLEdBQUcsWUFBWTtBQUNsQyxRQUFJbkQsS0FBSyxLQUFLLElBQWQsRUFBb0I7QUFDbEIsVUFBSTZCLFVBQVUsSUFBSSxJQUFkLElBQXNCLE9BQU9BLFVBQVAsS0FBc0IsUUFBaEQsRUFBMEQ7QUFDeEQsZUFBT0EsVUFBVSxDQUFDdUIsSUFBbEI7QUFDRCxPQUZELE1BRU87QUFDTCxlQUFPaEMsZ0JBQVA7QUFDRDtBQUNGLEtBTkQsTUFNTztBQUNMLFVBQUlTLFVBQVUsSUFBSSxJQUFkLElBQXNCLE9BQU9BLFVBQVAsS0FBc0IsUUFBaEQsRUFBMEQ7QUFDeEQsZUFBT0EsVUFBVSxDQUFDd0IsS0FBbEI7QUFDRCxPQUZELE1BRU87QUFDTCxlQUFPeEIsVUFBUDtBQUNEO0FBQ0Y7QUFDRixHQWR1QixFQUF4Qjs7QUFnQkEsTUFBSXlCLGlCQUFpQixHQUFHdEQsS0FBSyxHQUFHa0IsZ0JBQUgsR0FBc0JTLFVBQW5EO0FBQ0EsTUFBSTRCLFdBQVcsR0FBR1QsTUFBbEI7QUFDQSxNQUFJVSxVQUFVLEdBQUdELFdBQWpCO0FBQ0EsTUFBSUUsU0FBUyxHQUFHLENBQUNDLE1BQU0sQ0FBQ0MsSUFBUixFQUFjbEMsS0FBZCxFQUFxQkgsUUFBUSxJQUFJb0MsTUFBTSxDQUFDRSxhQUF4QyxFQUF1RDtBQUNyRWQsSUFBQUEsTUFBTSxFQUFFQSxNQUQ2RDtBQUVyRUUsSUFBQUEsS0FBSyxFQUFFQTtBQUY4RCxHQUF2RCxDQUFoQjtBQUlBLE1BQUlhLFVBQVUsR0FBRyxDQUFDSCxNQUFNLENBQUNJLEtBQVIsRUFBZTtBQUM5QkMsSUFBQUEsZUFBZSxFQUFFekMsUUFBUSxHQUFHLFNBQUgsR0FBZTZCLGlCQURWO0FBRTlCYSxJQUFBQSxZQUFZLEVBQUVkO0FBRmdCLEdBQWYsQ0FBakI7QUFJQSxNQUFJZSxVQUFVLEdBQUcsQ0FBQ1AsTUFBTSxDQUFDUSxLQUFSLEVBQWVsRSxLQUFLLElBQUkwRCxNQUFNLENBQUNTLFdBQS9CLEVBQTRDO0FBQzNESixJQUFBQSxlQUFlLEVBQUV6QyxRQUFRLEdBQUcsU0FBSCxHQUFlZ0MsaUJBRG1CO0FBRTNEUixJQUFBQSxNQUFNLEVBQUVTLFdBRm1EO0FBRzNEYSxJQUFBQSxXQUFXLEVBQUVwRSxLQUFLLEdBQUcsQ0FBQyxHQUFHekMseUJBQXlCLENBQUNOLE9BQTlCLEVBQXVDdUcsVUFBdkMsRUFBbUQsQ0FBQyxDQUFwRCxDQUFILEdBQTRELENBSG5CO0FBSTNEUixJQUFBQSxLQUFLLEVBQUVRO0FBSm9ELEdBQTVDLENBQWpCO0FBTUEsTUFBSWEsYUFBYSxHQUFHLENBQUMsR0FBR2hILGNBQWMsQ0FBQ0osT0FBbkIsRUFBNEIsT0FBNUIsRUFBcUM7QUFDdkQrRCxJQUFBQSxrQkFBa0IsRUFBRUEsa0JBRG1DO0FBRXZEcUIsSUFBQUEsT0FBTyxFQUFFckMsS0FGOEM7QUFHdkRzQixJQUFBQSxRQUFRLEVBQUVBLFFBSDZDO0FBSXZEZ0QsSUFBQUEsTUFBTSxFQUFFaEMsZ0JBSitDO0FBS3ZEaUMsSUFBQUEsUUFBUSxFQUFFckMsWUFMNkM7QUFNdkRzQyxJQUFBQSxPQUFPLEVBQUVsQyxnQkFOOEM7QUFPdkRtQyxJQUFBQSxHQUFHLEVBQUUxRCxZQVBrRDtBQVF2RFUsSUFBQUEsS0FBSyxFQUFFLENBQUNpQyxNQUFNLENBQUNXLGFBQVIsRUFBdUJYLE1BQU0sQ0FBQ2dCLGFBQTlCLENBUmdEO0FBU3ZEbEMsSUFBQUEsSUFBSSxFQUFFLFVBVGlEO0FBVXZEbUMsSUFBQUEsSUFBSSxFQUFFO0FBVmlELEdBQXJDLENBQXBCO0FBWUEsU0FBb0J6SCxLQUFLLENBQUMwSCxhQUFOLENBQW9CbkgsS0FBSyxDQUFDUixPQUExQixFQUFtQ2tELFFBQVEsQ0FBQyxFQUFELEVBQUs0QixLQUFMLEVBQVk7QUFDekVOLElBQUFBLEtBQUssRUFBRWdDO0FBRGtFLEdBQVosQ0FBM0MsRUFFSHZHLEtBQUssQ0FBQzBILGFBQU4sQ0FBb0JuSCxLQUFLLENBQUNSLE9BQTFCLEVBQW1DO0FBQ2xEd0UsSUFBQUEsS0FBSyxFQUFFb0M7QUFEMkMsR0FBbkMsQ0FGRyxFQUlIM0csS0FBSyxDQUFDMEgsYUFBTixDQUFvQm5ILEtBQUssQ0FBQ1IsT0FBMUIsRUFBbUM7QUFDbER3SCxJQUFBQSxHQUFHLEVBQUV6QyxRQUQ2QztBQUVsRFAsSUFBQUEsS0FBSyxFQUFFd0M7QUFGMkMsR0FBbkMsQ0FKRyxFQU9oQkksYUFQZ0IsQ0FBcEI7QUFRRCxDQWxHeUIsQ0FBMUI7QUFtR0F6RCxNQUFNLENBQUNpRSxXQUFQLEdBQXFCLFFBQXJCOztBQUVBLElBQUluQixNQUFNLEdBQUdsRyxXQUFXLENBQUNQLE9BQVosQ0FBb0I2SCxNQUFwQixDQUEyQjtBQUN0Q25CLEVBQUFBLElBQUksRUFBRTtBQUNKb0IsSUFBQUEsTUFBTSxFQUFFLFNBREo7QUFFSkMsSUFBQUEsVUFBVSxFQUFFO0FBRlIsR0FEZ0M7QUFLdENwQixFQUFBQSxhQUFhLEVBQUU7QUFDYm1CLElBQUFBLE1BQU0sRUFBRTtBQURLLEdBTHVCO0FBUXRDTCxFQUFBQSxhQUFhLEVBQUU7QUFDYkssSUFBQUEsTUFBTSxFQUFFO0FBREssR0FSdUI7QUFXdENqQixFQUFBQSxLQUFLLEVBQUV4RSxhQUFhLENBQUNBLGFBQWEsQ0FBQztBQUNqQzJGLElBQUFBLGlCQUFpQixFQUFFO0FBRGMsR0FBRCxFQUUvQnpILFdBQVcsQ0FBQ1AsT0FBWixDQUFvQmlJLGtCQUZXLENBQWQsRUFFd0IsRUFGeEIsRUFFNEI7QUFDOUNwQyxJQUFBQSxNQUFNLEVBQUUsS0FEc0M7QUFFOUNxQyxJQUFBQSxNQUFNLEVBQUUsTUFGc0M7QUFHOUNDLElBQUFBLGtCQUFrQixFQUFFLE1BSDBCO0FBSTlDcEMsSUFBQUEsS0FBSyxFQUFFO0FBSnVDLEdBRjVCLENBWGtCO0FBbUJ0Q2tCLEVBQUFBLEtBQUssRUFBRTtBQUNMZSxJQUFBQSxpQkFBaUIsRUFBRSxNQURkO0FBRUxJLElBQUFBLFNBQVMsRUFBRSxZQUZOO0FBR0xyQixJQUFBQSxZQUFZLEVBQUUsTUFIVDtBQUlMdkIsSUFBQUEsU0FBUyxFQUFFL0IscUJBSk47QUFLTDRFLElBQUFBLEtBQUssRUFBRSxJQUxGO0FBTUxDLElBQUFBLFNBQVMsRUFBRSxDQUFDO0FBQ1ZDLE1BQUFBLFVBQVUsRUFBRTtBQURGLEtBQUQsQ0FOTjtBQVNMSixJQUFBQSxrQkFBa0IsRUFBRTtBQVRmLEdBbkIrQjtBQThCdENqQixFQUFBQSxXQUFXLEVBQUU7QUFDWG1CLElBQUFBLEtBQUssRUFBRTtBQURJLEdBOUJ5QjtBQWlDdENqQixFQUFBQSxhQUFhLEVBQUUvRSxhQUFhLENBQUNBLGFBQWEsQ0FBQyxFQUFELEVBQUs5QixXQUFXLENBQUNQLE9BQVosQ0FBb0JpSSxrQkFBekIsQ0FBZCxFQUE0RCxFQUE1RCxFQUFnRTtBQUMxRnBDLElBQUFBLE1BQU0sRUFBRSxNQURrRjtBQUUxRnFDLElBQUFBLE1BQU0sRUFBRSxDQUZrRjtBQUcxRk0sSUFBQUEsT0FBTyxFQUFFLENBSGlGO0FBSTFGQyxJQUFBQSxPQUFPLEVBQUUsQ0FKaUY7QUFLMUYxQyxJQUFBQSxLQUFLLEVBQUU7QUFMbUYsR0FBaEU7QUFqQ1UsQ0FBM0IsQ0FBYjs7QUEwQ0EsSUFBSTJDLFFBQVEsR0FBRy9FLE1BQWY7QUFDQTdELE9BQU8sQ0FBQ0UsT0FBUixHQUFrQjBJLFFBQWxCO0FBQ0FDLE1BQU0sQ0FBQzdJLE9BQVAsR0FBaUJBLE9BQU8sQ0FBQ0UsT0FBekIiLCJzb3VyY2VzQ29udGVudCI6WyJcInVzZSBzdHJpY3RcIjtcblxuZXhwb3J0cy5fX2VzTW9kdWxlID0gdHJ1ZTtcbmV4cG9ydHMuZGVmYXVsdCA9IHZvaWQgMDtcblxudmFyIFJlYWN0ID0gX2ludGVyb3BSZXF1aXJlV2lsZGNhcmQocmVxdWlyZShcInJlYWN0XCIpKTtcblxudmFyIF9jcmVhdGVFbGVtZW50ID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChyZXF1aXJlKFwiLi4vY3JlYXRlRWxlbWVudFwiKSk7XG5cbnZhciBfbXVsdGlwbHlTdHlsZUxlbmd0aFZhbHVlID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChyZXF1aXJlKFwiLi4vLi4vbW9kdWxlcy9tdWx0aXBseVN0eWxlTGVuZ3RoVmFsdWVcIikpO1xuXG52YXIgX1N0eWxlU2hlZXQgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KHJlcXVpcmUoXCIuLi9TdHlsZVNoZWV0XCIpKTtcblxudmFyIF9WaWV3ID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChyZXF1aXJlKFwiLi4vVmlld1wiKSk7XG5cbmZ1bmN0aW9uIF9pbnRlcm9wUmVxdWlyZURlZmF1bHQob2JqKSB7IHJldHVybiBvYmogJiYgb2JqLl9fZXNNb2R1bGUgPyBvYmogOiB7IGRlZmF1bHQ6IG9iaiB9OyB9XG5cbmZ1bmN0aW9uIF9nZXRSZXF1aXJlV2lsZGNhcmRDYWNoZSgpIHsgaWYgKHR5cGVvZiBXZWFrTWFwICE9PSBcImZ1bmN0aW9uXCIpIHJldHVybiBudWxsOyB2YXIgY2FjaGUgPSBuZXcgV2Vha01hcCgpOyBfZ2V0UmVxdWlyZVdpbGRjYXJkQ2FjaGUgPSBmdW5jdGlvbiBfZ2V0UmVxdWlyZVdpbGRjYXJkQ2FjaGUoKSB7IHJldHVybiBjYWNoZTsgfTsgcmV0dXJuIGNhY2hlOyB9XG5cbmZ1bmN0aW9uIF9pbnRlcm9wUmVxdWlyZVdpbGRjYXJkKG9iaikgeyBpZiAob2JqICYmIG9iai5fX2VzTW9kdWxlKSB7IHJldHVybiBvYmo7IH0gaWYgKG9iaiA9PT0gbnVsbCB8fCB0eXBlb2Ygb2JqICE9PSBcIm9iamVjdFwiICYmIHR5cGVvZiBvYmogIT09IFwiZnVuY3Rpb25cIikgeyByZXR1cm4geyBkZWZhdWx0OiBvYmogfTsgfSB2YXIgY2FjaGUgPSBfZ2V0UmVxdWlyZVdpbGRjYXJkQ2FjaGUoKTsgaWYgKGNhY2hlICYmIGNhY2hlLmhhcyhvYmopKSB7IHJldHVybiBjYWNoZS5nZXQob2JqKTsgfSB2YXIgbmV3T2JqID0ge307IHZhciBoYXNQcm9wZXJ0eURlc2NyaXB0b3IgPSBPYmplY3QuZGVmaW5lUHJvcGVydHkgJiYgT2JqZWN0LmdldE93blByb3BlcnR5RGVzY3JpcHRvcjsgZm9yICh2YXIga2V5IGluIG9iaikgeyBpZiAoT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKG9iaiwga2V5KSkgeyB2YXIgZGVzYyA9IGhhc1Byb3BlcnR5RGVzY3JpcHRvciA/IE9iamVjdC5nZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3Iob2JqLCBrZXkpIDogbnVsbDsgaWYgKGRlc2MgJiYgKGRlc2MuZ2V0IHx8IGRlc2Muc2V0KSkgeyBPYmplY3QuZGVmaW5lUHJvcGVydHkobmV3T2JqLCBrZXksIGRlc2MpOyB9IGVsc2UgeyBuZXdPYmpba2V5XSA9IG9ialtrZXldOyB9IH0gfSBuZXdPYmouZGVmYXVsdCA9IG9iajsgaWYgKGNhY2hlKSB7IGNhY2hlLnNldChvYmosIG5ld09iaik7IH0gcmV0dXJuIG5ld09iajsgfVxuXG5mdW5jdGlvbiBvd25LZXlzKG9iamVjdCwgZW51bWVyYWJsZU9ubHkpIHsgdmFyIGtleXMgPSBPYmplY3Qua2V5cyhvYmplY3QpOyBpZiAoT2JqZWN0LmdldE93blByb3BlcnR5U3ltYm9scykgeyB2YXIgc3ltYm9scyA9IE9iamVjdC5nZXRPd25Qcm9wZXJ0eVN5bWJvbHMob2JqZWN0KTsgaWYgKGVudW1lcmFibGVPbmx5KSBzeW1ib2xzID0gc3ltYm9scy5maWx0ZXIoZnVuY3Rpb24gKHN5bSkgeyByZXR1cm4gT2JqZWN0LmdldE93blByb3BlcnR5RGVzY3JpcHRvcihvYmplY3QsIHN5bSkuZW51bWVyYWJsZTsgfSk7IGtleXMucHVzaC5hcHBseShrZXlzLCBzeW1ib2xzKTsgfSByZXR1cm4ga2V5czsgfVxuXG5mdW5jdGlvbiBfb2JqZWN0U3ByZWFkKHRhcmdldCkgeyBmb3IgKHZhciBpID0gMTsgaSA8IGFyZ3VtZW50cy5sZW5ndGg7IGkrKykgeyB2YXIgc291cmNlID0gYXJndW1lbnRzW2ldICE9IG51bGwgPyBhcmd1bWVudHNbaV0gOiB7fTsgaWYgKGkgJSAyKSB7IG93bktleXMoT2JqZWN0KHNvdXJjZSksIHRydWUpLmZvckVhY2goZnVuY3Rpb24gKGtleSkgeyBfZGVmaW5lUHJvcGVydHkodGFyZ2V0LCBrZXksIHNvdXJjZVtrZXldKTsgfSk7IH0gZWxzZSBpZiAoT2JqZWN0LmdldE93blByb3BlcnR5RGVzY3JpcHRvcnMpIHsgT2JqZWN0LmRlZmluZVByb3BlcnRpZXModGFyZ2V0LCBPYmplY3QuZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9ycyhzb3VyY2UpKTsgfSBlbHNlIHsgb3duS2V5cyhPYmplY3Qoc291cmNlKSkuZm9yRWFjaChmdW5jdGlvbiAoa2V5KSB7IE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0YXJnZXQsIGtleSwgT2JqZWN0LmdldE93blByb3BlcnR5RGVzY3JpcHRvcihzb3VyY2UsIGtleSkpOyB9KTsgfSB9IHJldHVybiB0YXJnZXQ7IH1cblxuZnVuY3Rpb24gX2RlZmluZVByb3BlcnR5KG9iaiwga2V5LCB2YWx1ZSkgeyBpZiAoa2V5IGluIG9iaikgeyBPYmplY3QuZGVmaW5lUHJvcGVydHkob2JqLCBrZXksIHsgdmFsdWU6IHZhbHVlLCBlbnVtZXJhYmxlOiB0cnVlLCBjb25maWd1cmFibGU6IHRydWUsIHdyaXRhYmxlOiB0cnVlIH0pOyB9IGVsc2UgeyBvYmpba2V5XSA9IHZhbHVlOyB9IHJldHVybiBvYmo7IH1cblxuZnVuY3Rpb24gX2V4dGVuZHMoKSB7IF9leHRlbmRzID0gT2JqZWN0LmFzc2lnbiB8fCBmdW5jdGlvbiAodGFyZ2V0KSB7IGZvciAodmFyIGkgPSAxOyBpIDwgYXJndW1lbnRzLmxlbmd0aDsgaSsrKSB7IHZhciBzb3VyY2UgPSBhcmd1bWVudHNbaV07IGZvciAodmFyIGtleSBpbiBzb3VyY2UpIHsgaWYgKE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbChzb3VyY2UsIGtleSkpIHsgdGFyZ2V0W2tleV0gPSBzb3VyY2Vba2V5XTsgfSB9IH0gcmV0dXJuIHRhcmdldDsgfTsgcmV0dXJuIF9leHRlbmRzLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7IH1cblxuZnVuY3Rpb24gX29iamVjdFdpdGhvdXRQcm9wZXJ0aWVzTG9vc2Uoc291cmNlLCBleGNsdWRlZCkgeyBpZiAoc291cmNlID09IG51bGwpIHJldHVybiB7fTsgdmFyIHRhcmdldCA9IHt9OyB2YXIgc291cmNlS2V5cyA9IE9iamVjdC5rZXlzKHNvdXJjZSk7IHZhciBrZXksIGk7IGZvciAoaSA9IDA7IGkgPCBzb3VyY2VLZXlzLmxlbmd0aDsgaSsrKSB7IGtleSA9IHNvdXJjZUtleXNbaV07IGlmIChleGNsdWRlZC5pbmRleE9mKGtleSkgPj0gMCkgY29udGludWU7IHRhcmdldFtrZXldID0gc291cmNlW2tleV07IH0gcmV0dXJuIHRhcmdldDsgfVxuXG52YXIgZW1wdHlPYmplY3QgPSB7fTtcbnZhciB0aHVtYkRlZmF1bHRCb3hTaGFkb3cgPSAnMHB4IDFweCAzcHggcmdiYSgwLDAsMCwwLjUpJztcbnZhciB0aHVtYkZvY3VzZWRCb3hTaGFkb3cgPSB0aHVtYkRlZmF1bHRCb3hTaGFkb3cgKyBcIiwgMCAwIDAgMTBweCByZ2JhKDAsMCwwLDAuMSlcIjtcbnZhciBTd2l0Y2ggPSAvKiNfX1BVUkVfXyovUmVhY3QuZm9yd2FyZFJlZihmdW5jdGlvbiAocHJvcHMsIGZvcndhcmRlZFJlZikge1xuICB2YXIgYWNjZXNzaWJpbGl0eUxhYmVsID0gcHJvcHMuYWNjZXNzaWJpbGl0eUxhYmVsLFxuICAgICAgX3Byb3BzJGFjdGl2ZVRodW1iQ29sID0gcHJvcHMuYWN0aXZlVGh1bWJDb2xvcixcbiAgICAgIGFjdGl2ZVRodW1iQ29sb3IgPSBfcHJvcHMkYWN0aXZlVGh1bWJDb2wgPT09IHZvaWQgMCA/ICcjMDA5Njg4JyA6IF9wcm9wcyRhY3RpdmVUaHVtYkNvbCxcbiAgICAgIF9wcm9wcyRhY3RpdmVUcmFja0NvbCA9IHByb3BzLmFjdGl2ZVRyYWNrQ29sb3IsXG4gICAgICBhY3RpdmVUcmFja0NvbG9yID0gX3Byb3BzJGFjdGl2ZVRyYWNrQ29sID09PSB2b2lkIDAgPyAnI0EzRDNDRicgOiBfcHJvcHMkYWN0aXZlVHJhY2tDb2wsXG4gICAgICBfcHJvcHMkZGlzYWJsZWQgPSBwcm9wcy5kaXNhYmxlZCxcbiAgICAgIGRpc2FibGVkID0gX3Byb3BzJGRpc2FibGVkID09PSB2b2lkIDAgPyBmYWxzZSA6IF9wcm9wcyRkaXNhYmxlZCxcbiAgICAgIG9uVmFsdWVDaGFuZ2UgPSBwcm9wcy5vblZhbHVlQ2hhbmdlLFxuICAgICAgX3Byb3BzJHN0eWxlID0gcHJvcHMuc3R5bGUsXG4gICAgICBzdHlsZSA9IF9wcm9wcyRzdHlsZSA9PT0gdm9pZCAwID8gZW1wdHlPYmplY3QgOiBfcHJvcHMkc3R5bGUsXG4gICAgICBfcHJvcHMkdGh1bWJDb2xvciA9IHByb3BzLnRodW1iQ29sb3IsXG4gICAgICB0aHVtYkNvbG9yID0gX3Byb3BzJHRodW1iQ29sb3IgPT09IHZvaWQgMCA/ICcjRkFGQUZBJyA6IF9wcm9wcyR0aHVtYkNvbG9yLFxuICAgICAgX3Byb3BzJHRyYWNrQ29sb3IgPSBwcm9wcy50cmFja0NvbG9yLFxuICAgICAgdHJhY2tDb2xvciA9IF9wcm9wcyR0cmFja0NvbG9yID09PSB2b2lkIDAgPyAnIzkzOTM5MycgOiBfcHJvcHMkdHJhY2tDb2xvcixcbiAgICAgIF9wcm9wcyR2YWx1ZSA9IHByb3BzLnZhbHVlLFxuICAgICAgdmFsdWUgPSBfcHJvcHMkdmFsdWUgPT09IHZvaWQgMCA/IGZhbHNlIDogX3Byb3BzJHZhbHVlLFxuICAgICAgb3RoZXIgPSBfb2JqZWN0V2l0aG91dFByb3BlcnRpZXNMb29zZShwcm9wcywgW1wiYWNjZXNzaWJpbGl0eUxhYmVsXCIsIFwiYWN0aXZlVGh1bWJDb2xvclwiLCBcImFjdGl2ZVRyYWNrQ29sb3JcIiwgXCJkaXNhYmxlZFwiLCBcIm9uVmFsdWVDaGFuZ2VcIiwgXCJzdHlsZVwiLCBcInRodW1iQ29sb3JcIiwgXCJ0cmFja0NvbG9yXCIsIFwidmFsdWVcIl0pO1xuXG4gIHZhciB0aHVtYlJlZiA9IFJlYWN0LnVzZVJlZihudWxsKTtcblxuICBmdW5jdGlvbiBoYW5kbGVDaGFuZ2UoZXZlbnQpIHtcbiAgICBpZiAob25WYWx1ZUNoYW5nZSAhPSBudWxsKSB7XG4gICAgICBvblZhbHVlQ2hhbmdlKGV2ZW50Lm5hdGl2ZUV2ZW50LnRhcmdldC5jaGVja2VkKTtcbiAgICB9XG4gIH1cblxuICBmdW5jdGlvbiBoYW5kbGVGb2N1c1N0YXRlKGV2ZW50KSB7XG4gICAgdmFyIGlzRm9jdXNlZCA9IGV2ZW50Lm5hdGl2ZUV2ZW50LnR5cGUgPT09ICdmb2N1cyc7XG4gICAgdmFyIGJveFNoYWRvdyA9IGlzRm9jdXNlZCA/IHRodW1iRm9jdXNlZEJveFNoYWRvdyA6IHRodW1iRGVmYXVsdEJveFNoYWRvdztcblxuICAgIGlmICh0aHVtYlJlZi5jdXJyZW50ICE9IG51bGwpIHtcbiAgICAgIHRodW1iUmVmLmN1cnJlbnQuc3R5bGUuYm94U2hhZG93ID0gYm94U2hhZG93O1xuICAgIH1cbiAgfVxuXG4gIHZhciBfU3R5bGVTaGVldCRmbGF0dGVuID0gX1N0eWxlU2hlZXQuZGVmYXVsdC5mbGF0dGVuKHN0eWxlKSxcbiAgICAgIHN0eWxlSGVpZ2h0ID0gX1N0eWxlU2hlZXQkZmxhdHRlbi5oZWlnaHQsXG4gICAgICBzdHlsZVdpZHRoID0gX1N0eWxlU2hlZXQkZmxhdHRlbi53aWR0aDtcblxuICB2YXIgaGVpZ2h0ID0gc3R5bGVIZWlnaHQgfHwgJzIwcHgnO1xuICB2YXIgbWluV2lkdGggPSAoMCwgX211bHRpcGx5U3R5bGVMZW5ndGhWYWx1ZS5kZWZhdWx0KShoZWlnaHQsIDIpO1xuICB2YXIgd2lkdGggPSBzdHlsZVdpZHRoID4gbWluV2lkdGggPyBzdHlsZVdpZHRoIDogbWluV2lkdGg7XG4gIHZhciB0cmFja0JvcmRlclJhZGl1cyA9ICgwLCBfbXVsdGlwbHlTdHlsZUxlbmd0aFZhbHVlLmRlZmF1bHQpKGhlaWdodCwgMC41KTtcblxuICB2YXIgdHJhY2tDdXJyZW50Q29sb3IgPSBmdW5jdGlvbiAoKSB7XG4gICAgaWYgKHZhbHVlID09PSB0cnVlKSB7XG4gICAgICBpZiAodHJhY2tDb2xvciAhPSBudWxsICYmIHR5cGVvZiB0cmFja0NvbG9yID09PSAnb2JqZWN0Jykge1xuICAgICAgICByZXR1cm4gdHJhY2tDb2xvci50cnVlO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgcmV0dXJuIGFjdGl2ZVRyYWNrQ29sb3I7XG4gICAgICB9XG4gICAgfSBlbHNlIHtcbiAgICAgIGlmICh0cmFja0NvbG9yICE9IG51bGwgJiYgdHlwZW9mIHRyYWNrQ29sb3IgPT09ICdvYmplY3QnKSB7XG4gICAgICAgIHJldHVybiB0cmFja0NvbG9yLmZhbHNlO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgcmV0dXJuIHRyYWNrQ29sb3I7XG4gICAgICB9XG4gICAgfVxuICB9KCk7XG5cbiAgdmFyIHRodW1iQ3VycmVudENvbG9yID0gdmFsdWUgPyBhY3RpdmVUaHVtYkNvbG9yIDogdGh1bWJDb2xvcjtcbiAgdmFyIHRodW1iSGVpZ2h0ID0gaGVpZ2h0O1xuICB2YXIgdGh1bWJXaWR0aCA9IHRodW1iSGVpZ2h0O1xuICB2YXIgcm9vdFN0eWxlID0gW3N0eWxlcy5yb290LCBzdHlsZSwgZGlzYWJsZWQgJiYgc3R5bGVzLmN1cnNvckRlZmF1bHQsIHtcbiAgICBoZWlnaHQ6IGhlaWdodCxcbiAgICB3aWR0aDogd2lkdGhcbiAgfV07XG4gIHZhciB0cmFja1N0eWxlID0gW3N0eWxlcy50cmFjaywge1xuICAgIGJhY2tncm91bmRDb2xvcjogZGlzYWJsZWQgPyAnI0Q1RDVENScgOiB0cmFja0N1cnJlbnRDb2xvcixcbiAgICBib3JkZXJSYWRpdXM6IHRyYWNrQm9yZGVyUmFkaXVzXG4gIH1dO1xuICB2YXIgdGh1bWJTdHlsZSA9IFtzdHlsZXMudGh1bWIsIHZhbHVlICYmIHN0eWxlcy50aHVtYkFjdGl2ZSwge1xuICAgIGJhY2tncm91bmRDb2xvcjogZGlzYWJsZWQgPyAnI0JEQkRCRCcgOiB0aHVtYkN1cnJlbnRDb2xvcixcbiAgICBoZWlnaHQ6IHRodW1iSGVpZ2h0LFxuICAgIG1hcmdpblN0YXJ0OiB2YWx1ZSA/ICgwLCBfbXVsdGlwbHlTdHlsZUxlbmd0aFZhbHVlLmRlZmF1bHQpKHRodW1iV2lkdGgsIC0xKSA6IDAsXG4gICAgd2lkdGg6IHRodW1iV2lkdGhcbiAgfV07XG4gIHZhciBuYXRpdmVDb250cm9sID0gKDAsIF9jcmVhdGVFbGVtZW50LmRlZmF1bHQpKCdpbnB1dCcsIHtcbiAgICBhY2Nlc3NpYmlsaXR5TGFiZWw6IGFjY2Vzc2liaWxpdHlMYWJlbCxcbiAgICBjaGVja2VkOiB2YWx1ZSxcbiAgICBkaXNhYmxlZDogZGlzYWJsZWQsXG4gICAgb25CbHVyOiBoYW5kbGVGb2N1c1N0YXRlLFxuICAgIG9uQ2hhbmdlOiBoYW5kbGVDaGFuZ2UsXG4gICAgb25Gb2N1czogaGFuZGxlRm9jdXNTdGF0ZSxcbiAgICByZWY6IGZvcndhcmRlZFJlZixcbiAgICBzdHlsZTogW3N0eWxlcy5uYXRpdmVDb250cm9sLCBzdHlsZXMuY3Vyc29ySW5oZXJpdF0sXG4gICAgdHlwZTogJ2NoZWNrYm94JyxcbiAgICByb2xlOiAnc3dpdGNoJ1xuICB9KTtcbiAgcmV0dXJuIC8qI19fUFVSRV9fKi9SZWFjdC5jcmVhdGVFbGVtZW50KF9WaWV3LmRlZmF1bHQsIF9leHRlbmRzKHt9LCBvdGhlciwge1xuICAgIHN0eWxlOiByb290U3R5bGVcbiAgfSksIC8qI19fUFVSRV9fKi9SZWFjdC5jcmVhdGVFbGVtZW50KF9WaWV3LmRlZmF1bHQsIHtcbiAgICBzdHlsZTogdHJhY2tTdHlsZVxuICB9KSwgLyojX19QVVJFX18qL1JlYWN0LmNyZWF0ZUVsZW1lbnQoX1ZpZXcuZGVmYXVsdCwge1xuICAgIHJlZjogdGh1bWJSZWYsXG4gICAgc3R5bGU6IHRodW1iU3R5bGVcbiAgfSksIG5hdGl2ZUNvbnRyb2wpO1xufSk7XG5Td2l0Y2guZGlzcGxheU5hbWUgPSAnU3dpdGNoJztcblxudmFyIHN0eWxlcyA9IF9TdHlsZVNoZWV0LmRlZmF1bHQuY3JlYXRlKHtcbiAgcm9vdDoge1xuICAgIGN1cnNvcjogJ3BvaW50ZXInLFxuICAgIHVzZXJTZWxlY3Q6ICdub25lJ1xuICB9LFxuICBjdXJzb3JEZWZhdWx0OiB7XG4gICAgY3Vyc29yOiAnZGVmYXVsdCdcbiAgfSxcbiAgY3Vyc29ySW5oZXJpdDoge1xuICAgIGN1cnNvcjogJ2luaGVyaXQnXG4gIH0sXG4gIHRyYWNrOiBfb2JqZWN0U3ByZWFkKF9vYmplY3RTcHJlYWQoe1xuICAgIGZvcmNlZENvbG9yQWRqdXN0OiAnbm9uZSdcbiAgfSwgX1N0eWxlU2hlZXQuZGVmYXVsdC5hYnNvbHV0ZUZpbGxPYmplY3QpLCB7fSwge1xuICAgIGhlaWdodDogJzcwJScsXG4gICAgbWFyZ2luOiAnYXV0bycsXG4gICAgdHJhbnNpdGlvbkR1cmF0aW9uOiAnMC4xcycsXG4gICAgd2lkdGg6ICcxMDAlJ1xuICB9KSxcbiAgdGh1bWI6IHtcbiAgICBmb3JjZWRDb2xvckFkanVzdDogJ25vbmUnLFxuICAgIGFsaWduU2VsZjogJ2ZsZXgtc3RhcnQnLFxuICAgIGJvcmRlclJhZGl1czogJzEwMCUnLFxuICAgIGJveFNoYWRvdzogdGh1bWJEZWZhdWx0Qm94U2hhZG93LFxuICAgIHN0YXJ0OiAnMCUnLFxuICAgIHRyYW5zZm9ybTogW3tcbiAgICAgIHRyYW5zbGF0ZVo6IDBcbiAgICB9XSxcbiAgICB0cmFuc2l0aW9uRHVyYXRpb246ICcwLjFzJ1xuICB9LFxuICB0aHVtYkFjdGl2ZToge1xuICAgIHN0YXJ0OiAnMTAwJSdcbiAgfSxcbiAgbmF0aXZlQ29udHJvbDogX29iamVjdFNwcmVhZChfb2JqZWN0U3ByZWFkKHt9LCBfU3R5bGVTaGVldC5kZWZhdWx0LmFic29sdXRlRmlsbE9iamVjdCksIHt9LCB7XG4gICAgaGVpZ2h0OiAnMTAwJScsXG4gICAgbWFyZ2luOiAwLFxuICAgIG9wYWNpdHk6IDAsXG4gICAgcGFkZGluZzogMCxcbiAgICB3aWR0aDogJzEwMCUnXG4gIH0pXG59KTtcblxudmFyIF9kZWZhdWx0ID0gU3dpdGNoO1xuZXhwb3J0cy5kZWZhdWx0ID0gX2RlZmF1bHQ7XG5tb2R1bGUuZXhwb3J0cyA9IGV4cG9ydHMuZGVmYXVsdDsiXX0=