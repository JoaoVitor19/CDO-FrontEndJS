ce97f45313b518de10fb80777fcd7944
"use strict";

exports.__esModule = true;
exports.default = void 0;

var React = _interopRequireWildcard(require("react"));

var _StyleSheet = _interopRequireDefault(require("../StyleSheet"));

var _createElement = _interopRequireDefault(require("../createElement"));

function _interopRequireDefault(obj) {
  return obj && obj.__esModule ? obj : {
    default: obj
  };
}

function _getRequireWildcardCache() {
  if (typeof WeakMap !== "function") return null;
  var cache = new WeakMap();

  _getRequireWildcardCache = function _getRequireWildcardCache() {
    return cache;
  };

  return cache;
}

function _interopRequireWildcard(obj) {
  if (obj && obj.__esModule) {
    return obj;
  }

  if (obj === null || typeof obj !== "object" && typeof obj !== "function") {
    return {
      default: obj
    };
  }

  var cache = _getRequireWildcardCache();

  if (cache && cache.has(obj)) {
    return cache.get(obj);
  }

  var newObj = {};
  var hasPropertyDescriptor = Object.defineProperty && Object.getOwnPropertyDescriptor;

  for (var key in obj) {
    if (Object.prototype.hasOwnProperty.call(obj, key)) {
      var desc = hasPropertyDescriptor ? Object.getOwnPropertyDescriptor(obj, key) : null;

      if (desc && (desc.get || desc.set)) {
        Object.defineProperty(newObj, key, desc);
      } else {
        newObj[key] = obj[key];
      }
    }
  }

  newObj.default = obj;

  if (cache) {
    cache.set(obj, newObj);
  }

  return newObj;
}

var ANIMATION_DURATION = 300;

function getAnimationStyle(animationType, visible) {
  if (animationType === 'slide') {
    return visible ? animatedSlideInStyles : animatedSlideOutStyles;
  }

  if (animationType === 'fade') {
    return visible ? animatedFadeInStyles : animatedFadeOutStyles;
  }

  return visible ? styles.container : styles.hidden;
}

function ModalAnimation(props) {
  var animationType = props.animationType,
      children = props.children,
      onDismiss = props.onDismiss,
      onShow = props.onShow,
      visible = props.visible;

  var _React$useState = React.useState(false),
      isRendering = _React$useState[0],
      setIsRendering = _React$useState[1];

  var wasVisible = React.useRef(false);
  var isAnimated = animationType && animationType !== 'none';
  var animationEndCallback = React.useCallback(function (e) {
    if (e && e.currentTarget !== e.target) {
      return;
    }

    if (visible) {
      if (onShow) {
        onShow();
      }
    } else {
      setIsRendering(false);

      if (onDismiss) {
        onDismiss();
      }
    }
  }, [onDismiss, onShow, visible]);
  React.useEffect(function () {
    if (visible) {
      setIsRendering(true);
    }

    if (visible !== wasVisible.current && !isAnimated) {
      animationEndCallback();
    }

    wasVisible.current = visible;
  }, [isAnimated, visible, animationEndCallback]);
  return isRendering || visible ? (0, _createElement.default)('div', {
    style: isRendering ? getAnimationStyle(animationType, visible) : styles.hidden,
    onAnimationEnd: animationEndCallback,
    children: children
  }) : null;
}

var styles = _StyleSheet.default.create({
  container: {
    position: 'fixed',
    top: 0,
    right: 0,
    bottom: 0,
    left: 0,
    zIndex: 9999
  },
  animatedIn: {
    animationDuration: ANIMATION_DURATION + "ms",
    animationTimingFunction: 'ease-in'
  },
  animatedOut: {
    pointerEvents: 'none',
    animationDuration: ANIMATION_DURATION + "ms",
    animationTimingFunction: 'ease-out'
  },
  fadeIn: {
    opacity: 1,
    animationKeyframes: {
      '0%': {
        opacity: 0
      },
      '100%': {
        opacity: 1
      }
    }
  },
  fadeOut: {
    opacity: 0,
    animationKeyframes: {
      '0%': {
        opacity: 1
      },
      '100%': {
        opacity: 0
      }
    }
  },
  slideIn: {
    transform: [{
      translateY: '0%'
    }],
    animationKeyframes: {
      '0%': {
        transform: [{
          translateY: '100%'
        }]
      },
      '100%': {
        transform: [{
          translateY: '0%'
        }]
      }
    }
  },
  slideOut: {
    transform: [{
      translateY: '100%'
    }],
    animationKeyframes: {
      '0%': {
        transform: [{
          translateY: '0%'
        }]
      },
      '100%': {
        transform: [{
          translateY: '100%'
        }]
      }
    }
  },
  hidden: {
    opacity: 0
  }
});

var animatedSlideInStyles = [styles.container, styles.animatedIn, styles.slideIn];
var animatedSlideOutStyles = [styles.container, styles.animatedOut, styles.slideOut];
var animatedFadeInStyles = [styles.container, styles.animatedIn, styles.fadeIn];
var animatedFadeOutStyles = [styles.container, styles.animatedOut, styles.fadeOut];
var _default = ModalAnimation;
exports.default = _default;
module.exports = exports.default;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIk1vZGFsQW5pbWF0aW9uLmpzIl0sIm5hbWVzIjpbImV4cG9ydHMiLCJfX2VzTW9kdWxlIiwiZGVmYXVsdCIsIlJlYWN0IiwiX2ludGVyb3BSZXF1aXJlV2lsZGNhcmQiLCJyZXF1aXJlIiwiX1N0eWxlU2hlZXQiLCJfaW50ZXJvcFJlcXVpcmVEZWZhdWx0IiwiX2NyZWF0ZUVsZW1lbnQiLCJvYmoiLCJfZ2V0UmVxdWlyZVdpbGRjYXJkQ2FjaGUiLCJXZWFrTWFwIiwiY2FjaGUiLCJoYXMiLCJnZXQiLCJuZXdPYmoiLCJoYXNQcm9wZXJ0eURlc2NyaXB0b3IiLCJPYmplY3QiLCJkZWZpbmVQcm9wZXJ0eSIsImdldE93blByb3BlcnR5RGVzY3JpcHRvciIsImtleSIsInByb3RvdHlwZSIsImhhc093blByb3BlcnR5IiwiY2FsbCIsImRlc2MiLCJzZXQiLCJBTklNQVRJT05fRFVSQVRJT04iLCJnZXRBbmltYXRpb25TdHlsZSIsImFuaW1hdGlvblR5cGUiLCJ2aXNpYmxlIiwiYW5pbWF0ZWRTbGlkZUluU3R5bGVzIiwiYW5pbWF0ZWRTbGlkZU91dFN0eWxlcyIsImFuaW1hdGVkRmFkZUluU3R5bGVzIiwiYW5pbWF0ZWRGYWRlT3V0U3R5bGVzIiwic3R5bGVzIiwiY29udGFpbmVyIiwiaGlkZGVuIiwiTW9kYWxBbmltYXRpb24iLCJwcm9wcyIsImNoaWxkcmVuIiwib25EaXNtaXNzIiwib25TaG93IiwiX1JlYWN0JHVzZVN0YXRlIiwidXNlU3RhdGUiLCJpc1JlbmRlcmluZyIsInNldElzUmVuZGVyaW5nIiwid2FzVmlzaWJsZSIsInVzZVJlZiIsImlzQW5pbWF0ZWQiLCJhbmltYXRpb25FbmRDYWxsYmFjayIsInVzZUNhbGxiYWNrIiwiZSIsImN1cnJlbnRUYXJnZXQiLCJ0YXJnZXQiLCJ1c2VFZmZlY3QiLCJjdXJyZW50Iiwic3R5bGUiLCJvbkFuaW1hdGlvbkVuZCIsImNyZWF0ZSIsInBvc2l0aW9uIiwidG9wIiwicmlnaHQiLCJib3R0b20iLCJsZWZ0IiwiekluZGV4IiwiYW5pbWF0ZWRJbiIsImFuaW1hdGlvbkR1cmF0aW9uIiwiYW5pbWF0aW9uVGltaW5nRnVuY3Rpb24iLCJhbmltYXRlZE91dCIsInBvaW50ZXJFdmVudHMiLCJmYWRlSW4iLCJvcGFjaXR5IiwiYW5pbWF0aW9uS2V5ZnJhbWVzIiwiZmFkZU91dCIsInNsaWRlSW4iLCJ0cmFuc2Zvcm0iLCJ0cmFuc2xhdGVZIiwic2xpZGVPdXQiLCJfZGVmYXVsdCIsIm1vZHVsZSJdLCJtYXBwaW5ncyI6IkFBQUE7O0FBRUFBLE9BQU8sQ0FBQ0MsVUFBUixHQUFxQixJQUFyQjtBQUNBRCxPQUFPLENBQUNFLE9BQVIsR0FBa0IsS0FBSyxDQUF2Qjs7QUFFQSxJQUFJQyxLQUFLLEdBQUdDLHVCQUF1QixDQUFDQyxPQUFPLENBQUMsT0FBRCxDQUFSLENBQW5DOztBQUVBLElBQUlDLFdBQVcsR0FBR0Msc0JBQXNCLENBQUNGLE9BQU8saUJBQVIsQ0FBeEM7O0FBRUEsSUFBSUcsY0FBYyxHQUFHRCxzQkFBc0IsQ0FBQ0YsT0FBTyxvQkFBUixDQUEzQzs7QUFFQSxTQUFTRSxzQkFBVCxDQUFnQ0UsR0FBaEMsRUFBcUM7QUFBRSxTQUFPQSxHQUFHLElBQUlBLEdBQUcsQ0FBQ1IsVUFBWCxHQUF3QlEsR0FBeEIsR0FBOEI7QUFBRVAsSUFBQUEsT0FBTyxFQUFFTztBQUFYLEdBQXJDO0FBQXdEOztBQUUvRixTQUFTQyx3QkFBVCxHQUFvQztBQUFFLE1BQUksT0FBT0MsT0FBUCxLQUFtQixVQUF2QixFQUFtQyxPQUFPLElBQVA7QUFBYSxNQUFJQyxLQUFLLEdBQUcsSUFBSUQsT0FBSixFQUFaOztBQUEyQkQsRUFBQUEsd0JBQXdCLEdBQUcsU0FBU0Esd0JBQVQsR0FBb0M7QUFBRSxXQUFPRSxLQUFQO0FBQWUsR0FBaEY7O0FBQWtGLFNBQU9BLEtBQVA7QUFBZTs7QUFFbE4sU0FBU1IsdUJBQVQsQ0FBaUNLLEdBQWpDLEVBQXNDO0FBQUUsTUFBSUEsR0FBRyxJQUFJQSxHQUFHLENBQUNSLFVBQWYsRUFBMkI7QUFBRSxX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b0MsTUFBN0MsQ0FBM0I7QUFDQSxJQUFJckMscUJBQXFCLEdBQUcsQ0FBQ0MsTUFBTSxDQUFDQyxTQUFSLEVBQW1CRCxNQUFNLENBQUNrQyxXQUExQixFQUF1Q2xDLE1BQU0sQ0FBQ3VDLE9BQTlDLENBQTVCO0FBQ0EsSUFBSUssUUFBUSxHQUFHekMsY0FBZjtBQUNBckMsT0FBTyxDQUFDRSxPQUFSLEdBQWtCNEUsUUFBbEI7QUFDQUMsTUFBTSxDQUFDL0UsT0FBUCxHQUFpQkEsT0FBTyxDQUFDRSxPQUF6QiIsInNvdXJjZXNDb250ZW50IjpbIlwidXNlIHN0cmljdFwiO1xuXG5leHBvcnRzLl9fZXNNb2R1bGUgPSB0cnVlO1xuZXhwb3J0cy5kZWZhdWx0ID0gdm9pZCAwO1xuXG52YXIgUmVhY3QgPSBfaW50ZXJvcFJlcXVpcmVXaWxkY2FyZChyZXF1aXJlKFwicmVhY3RcIikpO1xuXG52YXIgX1N0eWxlU2hlZXQgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KHJlcXVpcmUoXCIuLi9TdHlsZVNoZWV0XCIpKTtcblxudmFyIF9jcmVhdGVFbGVtZW50ID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChyZXF1aXJlKFwiLi4vY3JlYXRlRWxlbWVudFwiKSk7XG5cbmZ1bmN0aW9uIF9pbnRlcm9wUmVxdWlyZURlZmF1bHQob2JqKSB7IHJldHVybiBvYmogJiYgb2JqLl9fZXNNb2R1bGUgPyBvYmogOiB7IGRlZmF1bHQ6IG9iaiB9OyB9XG5cbmZ1bmN0aW9uIF9nZXRSZXF1aXJlV2lsZGNhcmRDYWNoZSgpIHsgaWYgKHR5cGVvZiBXZWFrTWFwICE9PSBcImZ1bmN0aW9uXCIpIHJldHVybiBudWxsOyB2YXIgY2FjaGUgPSBuZXcgV2Vha01hcCgpOyBfZ2V0UmVxdWlyZVdpbGRjYXJkQ2FjaGUgPSBmdW5jdGlvbiBfZ2V0UmVxdWlyZVdpbGRjYXJkQ2FjaGUoKSB7IHJldHVybiBjYWNoZTsgfTsgcmV0dXJuIGNhY2hlOyB9XG5cbmZ1bmN0aW9uIF9pbnRlcm9wUmVxdWlyZVdpbGRjYXJkKG9iaikgeyBpZiAob2JqICYmIG9iai5fX2VzTW9kdWxlKSB7IHJldHVybiBvYmo7IH0gaWYgKG9iaiA9PT0gbnVsbCB8fCB0eXBlb2Ygb2JqICE9PSBcIm9iamVjdFwiICYmIHR5cGVvZiBvYmogIT09IFwiZnVuY3Rpb25cIikgeyByZXR1cm4geyBkZWZhdWx0OiBvYmogfTsgfSB2YXIgY2FjaGUgPSBfZ2V0UmVxdWlyZVdpbGRjYXJkQ2FjaGUoKTsgaWYgKGNhY2hlICYmIGNhY2hlLmhhcyhvYmopKSB7IHJldHVybiBjYWNoZS5nZXQob2JqKTsgfSB2YXIgbmV3T2JqID0ge307IHZhciBoYXNQcm9wZXJ0eURlc2NyaXB0b3IgPSBPYmplY3QuZGVmaW5lUHJvcGVydHkgJiYgT2JqZWN0LmdldE93blByb3BlcnR5RGVzY3JpcHRvcjsgZm9yICh2YXIga2V5IGluIG9iaikgeyBpZiAoT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKG9iaiwga2V5KSkgeyB2YXIgZGVzYyA9IGhhc1Byb3BlcnR5RGVzY3JpcHRvciA/IE9iamVjdC5nZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3Iob2JqLCBrZXkpIDogbnVsbDsgaWYgKGRlc2MgJiYgKGRlc2MuZ2V0IHx8IGRlc2Muc2V0KSkgeyBPYmplY3QuZGVmaW5lUHJvcGVydHkobmV3T2JqLCBrZXksIGRlc2MpOyB9IGVsc2UgeyBuZXdPYmpba2V5XSA9IG9ialtrZXldOyB9IH0gfSBuZXdPYmouZGVmYXVsdCA9IG9iajsgaWYgKGNhY2hlKSB7IGNhY2hlLnNldChvYmosIG5ld09iaik7IH0gcmV0dXJuIG5ld09iajsgfVxuXG4vKipcbiAqIENvcHlyaWdodCAoYykgTmljb2xhcyBHYWxsYWdoZXIuXG4gKiBDb3B5cmlnaHQgKGMpIEZhY2Vib29rLCBJbmMuIGFuZCBpdHMgYWZmaWxpYXRlcy5cbiAqXG4gKiBUaGlzIHNvdXJjZSBjb2RlIGlzIGxpY2Vuc2VkIHVuZGVyIHRoZSBNSVQgbGljZW5zZSBmb3VuZCBpbiB0aGVcbiAqIExJQ0VOU0UgZmlsZSBpbiB0aGUgcm9vdCBkaXJlY3Rvcnkgb2YgdGhpcyBzb3VyY2UgdHJlZS5cbiAqXG4gKiBcbiAqL1xudmFyIEFOSU1BVElPTl9EVVJBVElPTiA9IDMwMDtcblxuZnVuY3Rpb24gZ2V0QW5pbWF0aW9uU3R5bGUoYW5pbWF0aW9uVHlwZSwgdmlzaWJsZSkge1xuICBpZiAoYW5pbWF0aW9uVHlwZSA9PT0gJ3NsaWRlJykge1xuICAgIHJldHVybiB2aXNpYmxlID8gYW5pbWF0ZWRTbGlkZUluU3R5bGVzIDogYW5pbWF0ZWRTbGlkZU91dFN0eWxlcztcbiAgfVxuXG4gIGlmIChhbmltYXRpb25UeXBlID09PSAnZmFkZScpIHtcbiAgICByZXR1cm4gdmlzaWJsZSA/IGFuaW1hdGVkRmFkZUluU3R5bGVzIDogYW5pbWF0ZWRGYWRlT3V0U3R5bGVzO1xuICB9XG5cbiAgcmV0dXJuIHZpc2libGUgPyBzdHlsZXMuY29udGFpbmVyIDogc3R5bGVzLmhpZGRlbjtcbn1cblxuZnVuY3Rpb24gTW9kYWxBbmltYXRpb24ocHJvcHMpIHtcbiAgdmFyIGFuaW1hdGlvblR5cGUgPSBwcm9wcy5hbmltYXRpb25UeXBlLFxuICAgICAgY2hpbGRyZW4gPSBwcm9wcy5jaGlsZHJlbixcbiAgICAgIG9uRGlzbWlzcyA9IHByb3BzLm9uRGlzbWlzcyxcbiAgICAgIG9uU2hvdyA9IHByb3BzLm9uU2hvdyxcbiAgICAgIHZpc2libGUgPSBwcm9wcy52aXNpYmxlO1xuXG4gIHZhciBfUmVhY3QkdXNlU3RhdGUgPSBSZWFjdC51c2VTdGF0ZShmYWxzZSksXG4gICAgICBpc1JlbmRlcmluZyA9IF9SZWFjdCR1c2VTdGF0ZVswXSxcbiAgICAgIHNldElzUmVuZGVyaW5nID0gX1JlYWN0JHVzZVN0YXRlWzFdO1xuXG4gIHZhciB3YXNWaXNpYmxlID0gUmVhY3QudXNlUmVmKGZhbHNlKTtcbiAgdmFyIGlzQW5pbWF0ZWQgPSBhbmltYXRpb25UeXBlICYmIGFuaW1hdGlvblR5cGUgIT09ICdub25lJztcbiAgdmFyIGFuaW1hdGlvbkVuZENhbGxiYWNrID0gUmVhY3QudXNlQ2FsbGJhY2soZnVuY3Rpb24gKGUpIHtcbiAgICBpZiAoZSAmJiBlLmN1cnJlbnRUYXJnZXQgIT09IGUudGFyZ2V0KSB7XG4gICAgICAvLyBJZiB0aGUgZXZlbnQgd2FzIGdlbmVyYXRlZCBmb3Igc29tZXRoaW5nIE5PVCB0aGlzIGVsZW1lbnQgd2VcbiAgICAgIC8vIHNob3VsZCBpZ25vcmUgaXQgYXMgaXQncyBub3QgcmVsZXZhbnQgdG8gdXNcbiAgICAgIHJldHVybjtcbiAgICB9XG5cbiAgICBpZiAodmlzaWJsZSkge1xuICAgICAgaWYgKG9uU2hvdykge1xuICAgICAgICBvblNob3coKTtcbiAgICAgIH1cbiAgICB9IGVsc2Uge1xuICAgICAgc2V0SXNSZW5kZXJpbmcoZmFsc2UpO1xuXG4gICAgICBpZiAob25EaXNtaXNzKSB7XG4gICAgICAgIG9uRGlzbWlzcygpO1xuICAgICAgfVxuICAgIH1cbiAgfSwgW29uRGlzbWlzcywgb25TaG93LCB2aXNpYmxlXSk7XG4gIFJlYWN0LnVzZUVmZmVjdChmdW5jdGlvbiAoKSB7XG4gICAgaWYgKHZpc2libGUpIHtcbiAgICAgIHNldElzUmVuZGVyaW5nKHRydWUpO1xuICAgIH1cblxuICAgIGlmICh2aXNpYmxlICE9PSB3YXNWaXNpYmxlLmN1cnJlbnQgJiYgIWlzQW5pbWF0ZWQpIHtcbiAgICAgIC8vIE1hbnVhbGx5IGNhbGwgYGFuaW1hdGlvbkVuZENhbGxiYWNrYCBpZiBubyBhbmltYXRpb24gaXMgdXNlZFxuICAgICAgYW5pbWF0aW9uRW5kQ2FsbGJhY2soKTtcbiAgICB9XG5cbiAgICB3YXNWaXNpYmxlLmN1cnJlbnQgPSB2aXNpYmxlO1xuICB9LCBbaXNBbmltYXRlZCwgdmlzaWJsZSwgYW5pbWF0aW9uRW5kQ2FsbGJhY2tdKTtcbiAgcmV0dXJuIGlzUmVuZGVyaW5nIHx8IHZpc2libGUgPyAoMCwgX2NyZWF0ZUVsZW1lbnQuZGVmYXVsdCkoJ2RpdicsIHtcbiAgICBzdHlsZTogaXNSZW5kZXJpbmcgPyBnZXRBbmltYXRpb25TdHlsZShhbmltYXRpb25UeXBlLCB2aXNpYmxlKSA6IHN0eWxlcy5oaWRkZW4sXG4gICAgb25BbmltYXRpb25FbmQ6IGFuaW1hdGlvbkVuZENhbGxiYWNrLFxuICAgIGNoaWxkcmVuOiBjaGlsZHJlblxuICB9KSA6IG51bGw7XG59XG5cbnZhciBzdHlsZXMgPSBfU3R5bGVTaGVldC5kZWZhdWx0LmNyZWF0ZSh7XG4gIGNvbnRhaW5lcjoge1xuICAgIHBvc2l0aW9uOiAnZml4ZWQnLFxuICAgIHRvcDogMCxcbiAgICByaWdodDogMCxcbiAgICBib3R0b206IDAsXG4gICAgbGVmdDogMCxcbiAgICB6SW5kZXg6IDk5OTlcbiAgfSxcbiAgYW5pbWF0ZWRJbjoge1xuICAgIGFuaW1hdGlvbkR1cmF0aW9uOiBBTklNQVRJT05fRFVSQVRJT04gKyBcIm1zXCIsXG4gICAgYW5pbWF0aW9uVGltaW5nRnVuY3Rpb246ICdlYXNlLWluJ1xuICB9LFxuICBhbmltYXRlZE91dDoge1xuICAgIHBvaW50ZXJFdmVudHM6ICdub25lJyxcbiAgICBhbmltYXRpb25EdXJhdGlvbjogQU5JTUFUSU9OX0RVUkFUSU9OICsgXCJtc1wiLFxuICAgIGFuaW1hdGlvblRpbWluZ0Z1bmN0aW9uOiAnZWFzZS1vdXQnXG4gIH0sXG4gIGZhZGVJbjoge1xuICAgIG9wYWNpdHk6IDEsXG4gICAgYW5pbWF0aW9uS2V5ZnJhbWVzOiB7XG4gICAgICAnMCUnOiB7XG4gICAgICAgIG9wYWNpdHk6IDBcbiAgICAgIH0sXG4gICAgICAnMTAwJSc6IHtcbiAgICAgICAgb3BhY2l0eTogMVxuICAgICAgfVxuICAgIH1cbiAgfSxcbiAgZmFkZU91dDoge1xuICAgIG9wYWNpdHk6IDAsXG4gICAgYW5pbWF0aW9uS2V5ZnJhbWVzOiB7XG4gICAgICAnMCUnOiB7XG4gICAgICAgIG9wYWNpdHk6IDFcbiAgICAgIH0sXG4gICAgICAnMTAwJSc6IHtcbiAgICAgICAgb3BhY2l0eTogMFxuICAgICAgfVxuICAgIH1cbiAgfSxcbiAgc2xpZGVJbjoge1xuICAgIHRyYW5zZm9ybTogW3tcbiAgICAgIHRyYW5zbGF0ZVk6ICcwJSdcbiAgICB9XSxcbiAgICBhbmltYXRpb25LZXlmcmFtZXM6IHtcbiAgICAgICcwJSc6IHtcbiAgICAgICAgdHJhbnNmb3JtOiBbe1xuICAgICAgICAgIHRyYW5zbGF0ZVk6ICcxMDAlJ1xuICAgICAgICB9XVxuICAgICAgfSxcbiAgICAgICcxMDAlJzoge1xuICAgICAgICB0cmFuc2Zvcm06IFt7XG4gICAgICAgICAgdHJhbnNsYXRlWTogJzAlJ1xuICAgICAgICB9XVxuICAgICAgfVxuICAgIH1cbiAgfSxcbiAgc2xpZGVPdXQ6IHtcbiAgICB0cmFuc2Zvcm06IFt7XG4gICAgICB0cmFuc2xhdGVZOiAnMTAwJSdcbiAgICB9XSxcbiAgICBhbmltYXRpb25LZXlmcmFtZXM6IHtcbiAgICAgICcwJSc6IHtcbiAgICAgICAgdHJhbnNmb3JtOiBbe1xuICAgICAgICAgIHRyYW5zbGF0ZVk6ICcwJSdcbiAgICAgICAgfV1cbiAgICAgIH0sXG4gICAgICAnMTAwJSc6IHtcbiAgICAgICAgdHJhbnNmb3JtOiBbe1xuICAgICAgICAgIHRyYW5zbGF0ZVk6ICcxMDAlJ1xuICAgICAgICB9XVxuICAgICAgfVxuICAgIH1cbiAgfSxcbiAgaGlkZGVuOiB7XG4gICAgb3BhY2l0eTogMFxuICB9XG59KTtcblxudmFyIGFuaW1hdGVkU2xpZGVJblN0eWxlcyA9IFtzdHlsZXMuY29udGFpbmVyLCBzdHlsZXMuYW5pbWF0ZWRJbiwgc3R5bGVzLnNsaWRlSW5dO1xudmFyIGFuaW1hdGVkU2xpZGVPdXRTdHlsZXMgPSBbc3R5bGVzLmNvbnRhaW5lciwgc3R5bGVzLmFuaW1hdGVkT3V0LCBzdHlsZXMuc2xpZGVPdXRdO1xudmFyIGFuaW1hdGVkRmFkZUluU3R5bGVzID0gW3N0eWxlcy5jb250YWluZXIsIHN0eWxlcy5hbmltYXRlZEluLCBzdHlsZXMuZmFkZUluXTtcbnZhciBhbmltYXRlZEZhZGVPdXRTdHlsZXMgPSBbc3R5bGVzLmNvbnRhaW5lciwgc3R5bGVzLmFuaW1hdGVkT3V0LCBzdHlsZXMuZmFkZU91dF07XG52YXIgX2RlZmF1bHQgPSBNb2RhbEFuaW1hdGlvbjtcbmV4cG9ydHMuZGVmYXVsdCA9IF9kZWZhdWx0O1xubW9kdWxlLmV4cG9ydHMgPSBleHBvcnRzLmRlZmF1bHQ7Il19