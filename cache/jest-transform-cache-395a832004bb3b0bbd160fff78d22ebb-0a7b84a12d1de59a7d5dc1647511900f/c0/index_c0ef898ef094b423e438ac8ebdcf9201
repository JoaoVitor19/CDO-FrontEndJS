15ac95414cd34c24cefafd97a5cad7c7
"use strict";

exports.__esModule = true;
exports.default = void 0;

var React = _interopRequireWildcard(require("react"));

var _createElement = _interopRequireDefault(require("../createElement"));

var _css = _interopRequireDefault(require("../StyleSheet/css"));

var forwardedProps = _interopRequireWildcard(require("../../modules/forwardedProps"));

var _pick = _interopRequireDefault(require("../../modules/pick"));

var _useElementLayout = _interopRequireDefault(require("../../modules/useElementLayout"));

var _useMergeRefs = _interopRequireDefault(require("../../modules/useMergeRefs"));

var _usePlatformMethods = _interopRequireDefault(require("../../modules/usePlatformMethods"));

var _useResponderEvents = _interopRequireDefault(require("../../modules/useResponderEvents"));

var _StyleSheet = _interopRequireDefault(require("../StyleSheet"));

var _TextAncestorContext = _interopRequireDefault(require("../Text/TextAncestorContext"));

function _interopRequireDefault(obj) {
  return obj && obj.__esModule ? obj : {
    default: obj
  };
}

function _getRequireWildcardCache() {
  if (typeof WeakMap !== "function") return null;
  var cache = new WeakMap();

  _getRequireWildcardCache = function _getRequireWildcardCache() {
    return cache;
  };

  return cache;
}

function _interopRequireWildcard(obj) {
  if (obj && obj.__esModule) {
    return obj;
  }

  if (obj === null || typeof obj !== "object" && typeof obj !== "function") {
    return {
      default: obj
    };
  }

  var cache = _getRequireWildcardCache();

  if (cache && cache.has(obj)) {
    return cache.get(obj);
  }

  var newObj = {};
  var hasPropertyDescriptor = Object.defineProperty && Object.getOwnPropertyDescriptor;

  for (var key in obj) {
    if (Object.prototype.hasOwnProperty.call(obj, key)) {
      var desc = hasPropertyDescriptor ? Object.getOwnPropertyDescriptor(obj, key) : null;

      if (desc && (desc.get || desc.set)) {
        Object.defineProperty(newObj, key, desc);
      } else {
        newObj[key] = obj[key];
      }
    }
  }

  newObj.default = obj;

  if (cache) {
    cache.set(obj, newObj);
  }

  return newObj;
}

function ownKeys(object, enumerableOnly) {
  var keys = Object.keys(object);

  if (Object.getOwnPropertySymbols) {
    var symbols = Object.getOwnPropertySymbols(object);
    if (enumerableOnly) symbols = symbols.filter(function (sym) {
      return Object.getOwnPropertyDescriptor(object, sym).enumerable;
    });
    keys.push.apply(keys, symbols);
  }

  return keys;
}

function _objectSpread(target) {
  for (var i = 1; i < arguments.length; i++) {
    var source = arguments[i] != null ? arguments[i] : {};

    if (i % 2) {
      ownKeys(Object(source), true).forEach(function (key) {
        _defineProperty(target, key, source[key]);
      });
    } else if (Object.getOwnPropertyDescriptors) {
      Object.defineProperties(target, Object.getOwnPropertyDescriptors(source));
    } else {
      ownKeys(Object(source)).forEach(function (key) {
        Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key));
      });
    }
  }

  return target;
}

function _defineProperty(obj, key, value) {
  if (key in obj) {
    Object.defineProperty(obj, key, {
      value: value,
      enumerable: true,
      configurable: true,
      writable: true
    });
  } else {
    obj[key] = value;
  }

  return obj;
}

var forwardPropsList = _objectSpread(_objectSpread(_objectSpread(_objectSpread(_objectSpread(_objectSpread(_objectSpread(_objectSpread(_objectSpread({}, forwardedProps.defaultProps), forwardedProps.accessibilityProps), forwardedProps.clickProps), forwardedProps.focusProps), forwardedProps.keyboardProps), forwardedProps.mouseProps), forwardedProps.touchProps), forwardedProps.styleProps), {}, {
  href: true,
  lang: true,
  onScroll: true,
  onWheel: true,
  pointerEvents: true
});

var pickProps = function pickProps(props) {
  return (0, _pick.default)(props, forwardPropsList);
};

var View = React.forwardRef(function (props, forwardedRef) {
  var hrefAttrs = props.hrefAttrs,
      onLayout = props.onLayout,
      onMoveShouldSetResponder = props.onMoveShouldSetResponder,
      onMoveShouldSetResponderCapture = props.onMoveShouldSetResponderCapture,
      onResponderEnd = props.onResponderEnd,
      onResponderGrant = props.onResponderGrant,
      onResponderMove = props.onResponderMove,
      onResponderReject = props.onResponderReject,
      onResponderRelease = props.onResponderRelease,
      onResponderStart = props.onResponderStart,
      onResponderTerminate = props.onResponderTerminate,
      onResponderTerminationRequest = props.onResponderTerminationRequest,
      onScrollShouldSetResponder = props.onScrollShouldSetResponder,
      onScrollShouldSetResponderCapture = props.onScrollShouldSetResponderCapture,
      onSelectionChangeShouldSetResponder = props.onSelectionChangeShouldSetResponder,
      onSelectionChangeShouldSetResponderCapture = props.onSelectionChangeShouldSetResponderCapture,
      onStartShouldSetResponder = props.onStartShouldSetResponder,
      onStartShouldSetResponderCapture = props.onStartShouldSetResponderCapture;

  if (process.env.NODE_ENV !== 'production') {
    React.Children.toArray(props.children).forEach(function (item) {
      if (typeof item === 'string') {
        console.error("Unexpected text node: " + item + ". A text node cannot be a child of a <View>.");
      }
    });
  }

  var hasTextAncestor = React.useContext(_TextAncestorContext.default);
  var hostRef = React.useRef(null);
  (0, _useElementLayout.default)(hostRef, onLayout);
  (0, _useResponderEvents.default)(hostRef, {
    onMoveShouldSetResponder: onMoveShouldSetResponder,
    onMoveShouldSetResponderCapture: onMoveShouldSetResponderCapture,
    onResponderEnd: onResponderEnd,
    onResponderGrant: onResponderGrant,
    onResponderMove: onResponderMove,
    onResponderReject: onResponderReject,
    onResponderRelease: onResponderRelease,
    onResponderStart: onResponderStart,
    onResponderTerminate: onResponderTerminate,
    onResponderTerminationRequest: onResponderTerminationRequest,
    onScrollShouldSetResponder: onScrollShouldSetResponder,
    onScrollShouldSetResponderCapture: onScrollShouldSetResponderCapture,
    onSelectionChangeShouldSetResponder: onSelectionChangeShouldSetResponder,
    onSelectionChangeShouldSetResponderCapture: onSelectionChangeShouldSetResponderCapture,
    onStartShouldSetResponder: onStartShouldSetResponder,
    onStartShouldSetResponderCapture: onStartShouldSetResponderCapture
  });
  var component = 'div';

  var style = _StyleSheet.default.compose(hasTextAncestor && styles.inline, props.style);

  var supportedProps = pickProps(props);
  supportedProps.classList = classList;
  supportedProps.style = style;

  if (props.href != null) {
    component = 'a';

    if (hrefAttrs != null) {
      var download = hrefAttrs.download,
          rel = hrefAttrs.rel,
          target = hrefAttrs.target;

      if (download != null) {
        supportedProps.download = download;
      }

      if (rel != null) {
        supportedProps.rel = rel;
      }

      if (typeof target === 'string') {
        supportedProps.target = target.charAt(0) !== '_' ? '_' + target : target;
      }
    }
  }

  var platformMethodsRef = (0, _usePlatformMethods.default)(supportedProps);
  var setRef = (0, _useMergeRefs.default)(hostRef, platformMethodsRef, forwardedRef);
  supportedProps.ref = setRef;
  return (0, _createElement.default)(component, supportedProps);
});
View.displayName = 'View';

var classes = _css.default.create({
  view: {
    alignItems: 'stretch',
    border: '0 solid black',
    boxSizing: 'border-box',
    display: 'flex',
    flexBasis: 'auto',
    flexDirection: 'column',
    flexShrink: 0,
    margin: 0,
    minHeight: 0,
    minWidth: 0,
    padding: 0,
    position: 'relative',
    zIndex: 0
  }
});

var classList = [classes.view];

var styles = _StyleSheet.default.create({
  inline: {
    display: 'inline-flex'
  }
});

var _default = View;
exports.default = _default;
module.exports = exports.default;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImluZGV4LmpzIl0sIm5hbWVzIjpbImV4cG9ydHMiLCJfX2VzTW9kdWxlIiwiZGVmYXVsdCIsIlJlYWN0IiwiX2ludGVyb3BSZXF1aXJlV2lsZGNhcmQiLCJyZXF1aXJlIiwiX2NyZWF0ZUVsZW1lbnQiLCJfaW50ZXJvcFJlcXVpcmVEZWZhdWx0IiwiX2NzcyIsImZvcndhcmRlZFByb3BzIiwiX3BpY2siLCJfdXNlRWxlbWVudExheW91dCIsIl91c2VNZXJnZVJlZnMiLCJfdXNlUGxhdGZvcm1NZXRob2RzIiwiX3VzZVJlc3BvbmRlckV2ZW50cyIsIl9TdHlsZVNoZWV0IiwiX1RleHRBbmNlc3RvckNvbnRleHQiLCJvYmoiLCJfZ2V0UmVxdWlyZVdpbGRjYXJkQ2FjaGUiLCJXZWFrTWFwIiwiY2FjaGUiLCJoYXMiLCJnZXQiLCJuZXdPYmoiLCJoYXNQcm9wZXJ0eURlc2NyaXB0b3IiLCJPYmplY3QiLCJkZWZpbmVQcm9wZXJ0eSIsImdldE93blByb3BlcnR5RGVzY3JpcHRvciIsImtleSIsInByb3RvdHlwZSIsImhhc093blByb3BlcnR5IiwiY2FsbCIsImRlc2MiLCJzZXQiLCJvd25LZXlzIiwib2JqZWN0IiwiZW51bWVyYWJsZU9ubHkiLCJrZXlzIiwiZ2V0T3duUHJvcGVydHlTeW1ib2xzIiwic3ltYm9scyIsImZpbHRlciIsInN5bSIsImVudW1lcmFibGUiLCJwdXNoIiwiYXBwbHkiLCJfb2JqZWN0U3ByZWFkIiwidGFyZ2V0IiwiaSIsImFyZ3VtZW50cyIsImxlbmd0aCIsInNvdXJjZSIsImZvckVhY2giLCJfZGVmaW5lUHJvcGVydHkiLCJnZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3JzIiwiZGVmaW5lUHJvcGVydGllcyIsInZhbHVlIiwiY29uZmlndXJhYmxlIiwid3JpdGFibGUiLCJmb3J3YXJkUHJvcHNMaXN0IiwiZGVmYXVsdFByb3BzIiwiYWNjZXNzaWJpbGl0eVByb3BzIiwiY2xpY2tQcm9wcyIsImZvY3VzUHJvcHMiLCJrZXlib2FyZFByb3BzIiwibW91c2VQcm9wcyIsInRvdWNoUHJvcHMiLCJzdHlsZVByb3BzIiwiaHJlZiIsImxhbmciLCJvblNjcm9sbCIsIm9uV2hlZWwiLCJwb2ludGVyRXZlbnRzIiwicGlja1Byb3BzIiwicHJvcHMiLCJWaWV3IiwiZm9yd2FyZFJlZiIsImZvcndhcmRlZFJlZiIsImhyZWZBdHRycyIsIm9uTGF5b3V0Iiwib25Nb3ZlU2hvdWxkU2V0UmVzcG9uZGVyIiwib25Nb3ZlU2hvdWxkU2V0UmVzcG9uZGVyQ2FwdHVyZSIsIm9uUmVzcG9uZGVyRW5kIiwib25SZXNwb25kZXJHcmFudCIsIm9uUmVzcG9uZGVyTW92ZSIsIm9uUmVzcG9uZGVyUmVqZWN0Iiwib25SZXNwb25kZXJSZWxlYXNlIiwib25SZXNwb25kZXJTdGFydCIsIm9uUmVzcG9uZGVyVGVybWluYXRlIiwib25SZXNwb25kZXJUZXJtaW5hdGlvblJlcXVlc3QiLCJvblNjcm9sbFNob3VsZFNldFJlc3BvbmRlciIsIm9uU2Nyb2xsU2hvdWxkU2V0UmVzcG9uZGVyQ2FwdHVyZSIsIm9uU2VsZWN0aW9uQ2hhbmdlU2hvdWxkU2V0UmVzcG9uZGVyIiwib25TZWxlY3Rpb25DaGFuZ2VTaG91bGRTZXRSZXNwb25kZXJDYXB0dXJlIiwib25TdGFydFNob3VsZFNldFJlc3BvbmRlciIsIm9uU3RhcnRTaG91bGRTZXRSZXNwb25kZXJDYXB0dXJlIiwicHJvY2VzcyIsImVudiIsIk5PREVfRU5WIiwiQ2hpbGRyZW4iLCJ0b0FycmF5IiwiY2hpbGRyZW4iLCJpdGVtIiwiY29uc29sZSIsImVycm9yIiwiaGFzVGV4dEFuY2VzdG9yIiwidXNlQ29udGV4dCIsImhvc3RSZWYiLCJ1c2VSZWYiLCJjb21wb25lbnQiLCJzdHlsZSIsImNvbXBvc2UiLCJzdHlsZXMiLCJpbmxpbmUiLCJzdXBwb3J0ZWRQcm9wcyIsImNsYXNzTGlzdCIsImRvd25sb2FkIiwicmVsIiwiY2hhckF0IiwicGxhdGZvcm1NZXRob2RzUmVmIiwic2V0UmVmIiwicmVmIiwiZGlzcGxheU5hbWUiLCJjbGFzc2VzIiwiY3JlYXRlIiwidmlldyIsImFsaWduSXRlbXMiLCJib3JkZXIiLCJib3hTaXppbmciLCJkaXNwbGF5IiwiZmxleEJhc2lzIiwiZmxleERpcmVjdGlvbiIsImZsZXhTaHJpbmsiLCJtYXJnaW4iLCJtaW5IZWlnaHQiLCJtaW5XaWR0aCIsInBhZGRpbmciLCJwb3NpdGlvbiIsInpJbmRleCIsIl9kZWZhdWx0IiwibW9kdWxlIl0sIm1hcHBpbmdzIjoiQUFBQTs7QUFFQUEsT0FBTyxDQUFDQyxVQUFSLEdBQXFCLElBQXJCO0FBQ0FELE9BQU8sQ0FBQ0UsT0FBUixHQUFrQixLQUFLLENBQXZCOztBQUVBLElBQUlDLEtBQUssR0FBR0MsdUJBQXVCLENBQUNDLE9BQU8sQ0FBQyxPQUFELENBQVIsQ0FBbkM7O0FBRUEsSUFBSUMsY0FBYyxHQUFHQyxzQkFBc0IsQ0FBQ0YsT0FBTyxvQkFBUixDQUEzQzs7QUFFQSxJQUFJRyxJQUFJLEdBQUdELHNCQUFzQixDQUFDRixPQUFPLHFCQUFSLENBQWpDOztBQUVBLElBQUlJLGNBQWMsR0FBR0wsdUJBQXVCLENBQUNDLE9BQU8sZ0NBQVIsQ0FBNUM7O0FBRUEsSUFBSUssS0FBSyxHQUFHSCxzQkFBc0IsQ0FBQ0YsT0FBTyxzQkFBUixDQUFsQzs7QUFFQSxJQUFJTSxpQkFBaUIsR0FBR0osc0JBQXNCLENBQUNGLE9BQU8sa0NBQVIsQ0FBOUM7O0FBRUEsSUFBSU8sYUFBYSxHQUFHTCxzQkFBc0IsQ0FBQ0YsT0FBTyw4QkFBUixDQUExQzs7QUFFQSxJQUFJUSxtQkFBbUIsR0FBR04sc0JBQXNCLENBQUNGLE9BQU8sb0NBQVIsQ0FBaEQ7O0FBRUEsSUFBSVMsbUJBQW1CLEdBQUdQLHNCQUFzQixDQUFDRixPQUFPLG9DQUFSLENBQWhEOztBQUVBLElBQUlVLFdBQVcsR0FBR1Isc0JBQXNCLENBQUNGLE9BQU8saUJBQVIsQ0FBeEM7O0FBRUEsSUFBSVcsb0JBQW9CLEdBQUdULHNCQUFzQixDQUFDRixPQUFPLCtCQUFSLENBQWpEOztBQUVBLFNBQVNFLHNCQUFU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QVdKQyxJQUFBQSxPQUFPLEVBQUUsQ0FYTDtBQVlKQyxJQUFBQSxRQUFRLEVBQUUsVUFaTjtBQWFKQyxJQUFBQSxNQUFNLEVBQUU7QUFiSjtBQUQwQixDQUFwQixDQUFkOztBQWtCQSxJQUFJdkIsU0FBUyxHQUFHLENBQUNRLE9BQU8sQ0FBQ0UsSUFBVCxDQUFoQjs7QUFFQSxJQUFJYixNQUFNLEdBQUdoRyxXQUFXLENBQUNiLE9BQVosQ0FBb0J5SCxNQUFwQixDQUEyQjtBQUN0Q1gsRUFBQUEsTUFBTSxFQUFFO0FBQ05nQixJQUFBQSxPQUFPLEVBQUU7QUFESDtBQUQ4QixDQUEzQixDQUFiOztBQU1BLElBQUlVLFFBQVEsR0FBR2hFLElBQWY7QUFDQTFFLE9BQU8sQ0FBQ0UsT0FBUixHQUFrQndJLFFBQWxCO0FBQ0FDLE1BQU0sQ0FBQzNJLE9BQVAsR0FBaUJBLE9BQU8sQ0FBQ0UsT0FBekIiLCJzb3VyY2VzQ29udGVudCI6WyJcInVzZSBzdHJpY3RcIjtcblxuZXhwb3J0cy5fX2VzTW9kdWxlID0gdHJ1ZTtcbmV4cG9ydHMuZGVmYXVsdCA9IHZvaWQgMDtcblxudmFyIFJlYWN0ID0gX2ludGVyb3BSZXF1aXJlV2lsZGNhcmQocmVxdWlyZShcInJlYWN0XCIpKTtcblxudmFyIF9jcmVhdGVFbGVtZW50ID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChyZXF1aXJlKFwiLi4vY3JlYXRlRWxlbWVudFwiKSk7XG5cbnZhciBfY3NzID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChyZXF1aXJlKFwiLi4vU3R5bGVTaGVldC9jc3NcIikpO1xuXG52YXIgZm9yd2FyZGVkUHJvcHMgPSBfaW50ZXJvcFJlcXVpcmVXaWxkY2FyZChyZXF1aXJlKFwiLi4vLi4vbW9kdWxlcy9mb3J3YXJkZWRQcm9wc1wiKSk7XG5cbnZhciBfcGljayA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQocmVxdWlyZShcIi4uLy4uL21vZHVsZXMvcGlja1wiKSk7XG5cbnZhciBfdXNlRWxlbWVudExheW91dCA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQocmVxdWlyZShcIi4uLy4uL21vZHVsZXMvdXNlRWxlbWVudExheW91dFwiKSk7XG5cbnZhciBfdXNlTWVyZ2VSZWZzID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChyZXF1aXJlKFwiLi4vLi4vbW9kdWxlcy91c2VNZXJnZVJlZnNcIikpO1xuXG52YXIgX3VzZVBsYXRmb3JtTWV0aG9kcyA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQocmVxdWlyZShcIi4uLy4uL21vZHVsZXMvdXNlUGxhdGZvcm1NZXRob2RzXCIpKTtcblxudmFyIF91c2VSZXNwb25kZXJFdmVudHMgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KHJlcXVpcmUoXCIuLi8uLi9tb2R1bGVzL3VzZVJlc3BvbmRlckV2ZW50c1wiKSk7XG5cbnZhciBfU3R5bGVTaGVldCA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQocmVxdWlyZShcIi4uL1N0eWxlU2hlZXRcIikpO1xuXG52YXIgX1RleHRBbmNlc3RvckNvbnRleHQgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KHJlcXVpcmUoXCIuLi9UZXh0L1RleHRBbmNlc3RvckNvbnRleHRcIikpO1xuXG5mdW5jdGlvbiBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KG9iaikgeyByZXR1cm4gb2JqICYmIG9iai5fX2VzTW9kdWxlID8gb2JqIDogeyBkZWZhdWx0OiBvYmogfTsgfVxuXG5mdW5jdGlvbiBfZ2V0UmVxdWlyZVdpbGRjYXJkQ2FjaGUoKSB7IGlmICh0eXBlb2YgV2Vha01hcCAhPT0gXCJmdW5jdGlvblwiKSByZXR1cm4gbnVsbDsgdmFyIGNhY2hlID0gbmV3IFdlYWtNYXAoKTsgX2dldFJlcXVpcmVXaWxkY2FyZENhY2hlID0gZnVuY3Rpb24gX2dldFJlcXVpcmVXaWxkY2FyZENhY2hlKCkgeyByZXR1cm4gY2FjaGU7IH07IHJldHVybiBjYWNoZTsgfVxuXG5mdW5jdGlvbiBfaW50ZXJvcFJlcXVpcmVXaWxkY2FyZChvYmopIHsgaWYgKG9iaiAmJiBvYmouX19lc01vZHVsZSkgeyByZXR1cm4gb2JqOyB9IGlmIChvYmogPT09IG51bGwgfHwgdHlwZW9mIG9iaiAhPT0gXCJvYmplY3RcIiAmJiB0eXBlb2Ygb2JqICE9PSBcImZ1bmN0aW9uXCIpIHsgcmV0dXJuIHsgZGVmYXVsdDogb2JqIH07IH0gdmFyIGNhY2hlID0gX2dldFJlcXVpcmVXaWxkY2FyZENhY2hlKCk7IGlmIChjYWNoZSAmJiBjYWNoZS5oYXMob2JqKSkgeyByZXR1cm4gY2FjaGUuZ2V0KG9iaik7IH0gdmFyIG5ld09iaiA9IHt9OyB2YXIgaGFzUHJvcGVydHlEZXNjcmlwdG9yID0gT2JqZWN0LmRlZmluZVByb3BlcnR5ICYmIE9iamVjdC5nZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3I7IGZvciAodmFyIGtleSBpbiBvYmopIHsgaWYgKE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbChvYmosIGtleSkpIHsgdmFyIGRlc2MgPSBoYXNQcm9wZXJ0eURlc2NyaXB0b3IgPyBPYmplY3QuZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9yKG9iaiwga2V5KSA6IG51bGw7IGlmIChkZXNjICYmIChkZXNjLmdldCB8fCBkZXNjLnNldCkpIHsgT2JqZWN0LmRlZmluZVByb3BlcnR5KG5ld09iaiwga2V5LCBkZXNjKTsgfSBlbHNlIHsgbmV3T2JqW2tleV0gPSBvYmpba2V5XTsgfSB9IH0gbmV3T2JqLmRlZmF1bHQgPSBvYmo7IGlmIChjYWNoZSkgeyBjYWNoZS5zZXQob2JqLCBuZXdPYmopOyB9IHJldHVybiBuZXdPYmo7IH1cblxuZnVuY3Rpb24gb3duS2V5cyhvYmplY3QsIGVudW1lcmFibGVPbmx5KSB7IHZhciBrZXlzID0gT2JqZWN0LmtleXMob2JqZWN0KTsgaWYgKE9iamVjdC5nZXRPd25Qcm9wZXJ0eVN5bWJvbHMpIHsgdmFyIHN5bWJvbHMgPSBPYmplY3QuZ2V0T3duUHJvcGVydHlTeW1ib2xzKG9iamVjdCk7IGlmIChlbnVtZXJhYmxlT25seSkgc3ltYm9scyA9IHN5bWJvbHMuZmlsdGVyKGZ1bmN0aW9uIChzeW0pIHsgcmV0dXJuIE9iamVjdC5nZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3Iob2JqZWN0LCBzeW0pLmVudW1lcmFibGU7IH0pOyBrZXlzLnB1c2guYXBwbHkoa2V5cywgc3ltYm9scyk7IH0gcmV0dXJuIGtleXM7IH1cblxuZnVuY3Rpb24gX29iamVjdFNwcmVhZCh0YXJnZXQpIHsgZm9yICh2YXIgaSA9IDE7IGkgPCBhcmd1bWVudHMubGVuZ3RoOyBpKyspIHsgdmFyIHNvdXJjZSA9IGFyZ3VtZW50c1tpXSAhPSBudWxsID8gYXJndW1lbnRzW2ldIDoge307IGlmIChpICUgMikgeyBvd25LZXlzKE9iamVjdChzb3VyY2UpLCB0cnVlKS5mb3JFYWNoKGZ1bmN0aW9uIChrZXkpIHsgX2RlZmluZVByb3BlcnR5KHRhcmdldCwga2V5LCBzb3VyY2Vba2V5XSk7IH0pOyB9IGVsc2UgaWYgKE9iamVjdC5nZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3JzKSB7IE9iamVjdC5kZWZpbmVQcm9wZXJ0aWVzKHRhcmdldCwgT2JqZWN0LmdldE93blByb3BlcnR5RGVzY3JpcHRvcnMoc291cmNlKSk7IH0gZWxzZSB7IG93bktleXMoT2JqZWN0KHNvdXJjZSkpLmZvckVhY2goZnVuY3Rpb24gKGtleSkgeyBPYmplY3QuZGVmaW5lUHJvcGVydHkodGFyZ2V0LCBrZXksIE9iamVjdC5nZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3Ioc291cmNlLCBrZXkpKTsgfSk7IH0gfSByZXR1cm4gdGFyZ2V0OyB9XG5cbmZ1bmN0aW9uIF9kZWZpbmVQcm9wZXJ0eShvYmosIGtleSwgdmFsdWUpIHsgaWYgKGtleSBpbiBvYmopIHsgT2JqZWN0LmRlZmluZVByb3BlcnR5KG9iaiwga2V5LCB7IHZhbHVlOiB2YWx1ZSwgZW51bWVyYWJsZTogdHJ1ZSwgY29uZmlndXJhYmxlOiB0cnVlLCB3cml0YWJsZTogdHJ1ZSB9KTsgfSBlbHNlIHsgb2JqW2tleV0gPSB2YWx1ZTsgfSByZXR1cm4gb2JqOyB9XG5cbnZhciBmb3J3YXJkUHJvcHNMaXN0ID0gX29iamVjdFNwcmVhZChfb2JqZWN0U3ByZWFkKF9vYmplY3RTcHJlYWQoX29iamVjdFNwcmVhZChfb2JqZWN0U3ByZWFkKF9vYmplY3RTcHJlYWQoX29iamVjdFNwcmVhZChfb2JqZWN0U3ByZWFkKF9vYmplY3RTcHJlYWQoe30sIGZvcndhcmRlZFByb3BzLmRlZmF1bHRQcm9wcyksIGZvcndhcmRlZFByb3BzLmFjY2Vzc2liaWxpdHlQcm9wcyksIGZvcndhcmRlZFByb3BzLmNsaWNrUHJvcHMpLCBmb3J3YXJkZWRQcm9wcy5mb2N1c1Byb3BzKSwgZm9yd2FyZGVkUHJvcHMua2V5Ym9hcmRQcm9wcyksIGZvcndhcmRlZFByb3BzLm1vdXNlUHJvcHMpLCBmb3J3YXJkZWRQcm9wcy50b3VjaFByb3BzKSwgZm9yd2FyZGVkUHJvcHMuc3R5bGVQcm9wcyksIHt9LCB7XG4gIGhyZWY6IHRydWUsXG4gIGxhbmc6IHRydWUsXG4gIG9uU2Nyb2xsOiB0cnVlLFxuICBvbldoZWVsOiB0cnVlLFxuICBwb2ludGVyRXZlbnRzOiB0cnVlXG59KTtcblxudmFyIHBpY2tQcm9wcyA9IGZ1bmN0aW9uIHBpY2tQcm9wcyhwcm9wcykge1xuICByZXR1cm4gKDAsIF9waWNrLmRlZmF1bHQpKHByb3BzLCBmb3J3YXJkUHJvcHNMaXN0KTtcbn07XG5cbnZhciBWaWV3ID0gLyojX19QVVJFX18qL1JlYWN0LmZvcndhcmRSZWYoZnVuY3Rpb24gKHByb3BzLCBmb3J3YXJkZWRSZWYpIHtcbiAgdmFyIGhyZWZBdHRycyA9IHByb3BzLmhyZWZBdHRycyxcbiAgICAgIG9uTGF5b3V0ID0gcHJvcHMub25MYXlvdXQsXG4gICAgICBvbk1vdmVTaG91bGRTZXRSZXNwb25kZXIgPSBwcm9wcy5vbk1vdmVTaG91bGRTZXRSZXNwb25kZXIsXG4gICAgICBvbk1vdmVTaG91bGRTZXRSZXNwb25kZXJDYXB0dXJlID0gcHJvcHMub25Nb3ZlU2hvdWxkU2V0UmVzcG9uZGVyQ2FwdHVyZSxcbiAgICAgIG9uUmVzcG9uZGVyRW5kID0gcHJvcHMub25SZXNwb25kZXJFbmQsXG4gICAgICBvblJlc3BvbmRlckdyYW50ID0gcHJvcHMub25SZXNwb25kZXJHcmFudCxcbiAgICAgIG9uUmVzcG9uZGVyTW92ZSA9IHByb3BzLm9uUmVzcG9uZGVyTW92ZSxcbiAgICAgIG9uUmVzcG9uZGVyUmVqZWN0ID0gcHJvcHMub25SZXNwb25kZXJSZWplY3QsXG4gICAgICBvblJlc3BvbmRlclJlbGVhc2UgPSBwcm9wcy5vblJlc3BvbmRlclJlbGVhc2UsXG4gICAgICBvblJlc3BvbmRlclN0YXJ0ID0gcHJvcHMub25SZXNwb25kZXJTdGFydCxcbiAgICAgIG9uUmVzcG9uZGVyVGVybWluYXRlID0gcHJvcHMub25SZXNwb25kZXJUZXJtaW5hdGUsXG4gICAgICBvblJlc3BvbmRlclRlcm1pbmF0aW9uUmVxdWVzdCA9IHByb3BzLm9uUmVzcG9uZGVyVGVybWluYXRpb25SZXF1ZXN0LFxuICAgICAgb25TY3JvbGxTaG91bGRTZXRSZXNwb25kZXIgPSBwcm9wcy5vblNjcm9sbFNob3VsZFNldFJlc3BvbmRlcixcbiAgICAgIG9uU2Nyb2xsU2hvdWxkU2V0UmVzcG9uZGVyQ2FwdHVyZSA9IHByb3BzLm9uU2Nyb2xsU2hvdWxkU2V0UmVzcG9uZGVyQ2FwdHVyZSxcbiAgICAgIG9uU2VsZWN0aW9uQ2hhbmdlU2hvdWxkU2V0UmVzcG9uZGVyID0gcHJvcHMub25TZWxlY3Rpb25DaGFuZ2VTaG91bGRTZXRSZXNwb25kZXIsXG4gICAgICBvblNlbGVjdGlvbkNoYW5nZVNob3VsZFNldFJlc3BvbmRlckNhcHR1cmUgPSBwcm9wcy5vblNlbGVjdGlvbkNoYW5nZVNob3VsZFNldFJlc3BvbmRlckNhcHR1cmUsXG4gICAgICBvblN0YXJ0U2hvdWxkU2V0UmVzcG9uZGVyID0gcHJvcHMub25TdGFydFNob3VsZFNldFJlc3BvbmRlcixcbiAgICAgIG9uU3RhcnRTaG91bGRTZXRSZXNwb25kZXJDYXB0dXJlID0gcHJvcHMub25TdGFydFNob3VsZFNldFJlc3BvbmRlckNhcHR1cmU7XG5cbiAgaWYgKHByb2Nlc3MuZW52Lk5PREVfRU5WICE9PSAncHJvZHVjdGlvbicpIHtcbiAgICBSZWFjdC5DaGlsZHJlbi50b0FycmF5KHByb3BzLmNoaWxkcmVuKS5mb3JFYWNoKGZ1bmN0aW9uIChpdGVtKSB7XG4gICAgICBpZiAodHlwZW9mIGl0ZW0gPT09ICdzdHJpbmcnKSB7XG4gICAgICAgIGNvbnNvbGUuZXJyb3IoXCJVbmV4cGVjdGVkIHRleHQgbm9kZTogXCIgKyBpdGVtICsgXCIuIEEgdGV4dCBub2RlIGNhbm5vdCBiZSBhIGNoaWxkIG9mIGEgPFZpZXc+LlwiKTtcbiAgICAgIH1cbiAgICB9KTtcbiAgfVxuXG4gIHZhciBoYXNUZXh0QW5jZXN0b3IgPSBSZWFjdC51c2VDb250ZXh0KF9UZXh0QW5jZXN0b3JDb250ZXh0LmRlZmF1bHQpO1xuICB2YXIgaG9zdFJlZiA9IFJlYWN0LnVzZVJlZihudWxsKTtcbiAgKDAsIF91c2VFbGVtZW50TGF5b3V0LmRlZmF1bHQpKGhvc3RSZWYsIG9uTGF5b3V0KTtcbiAgKDAsIF91c2VSZXNwb25kZXJFdmVudHMuZGVmYXVsdCkoaG9zdFJlZiwge1xuICAgIG9uTW92ZVNob3VsZFNldFJlc3BvbmRlcjogb25Nb3ZlU2hvdWxkU2V0UmVzcG9uZGVyLFxuICAgIG9uTW92ZVNob3VsZFNldFJlc3BvbmRlckNhcHR1cmU6IG9uTW92ZVNob3VsZFNldFJlc3BvbmRlckNhcHR1cmUsXG4gICAgb25SZXNwb25kZXJFbmQ6IG9uUmVzcG9uZGVyRW5kLFxuICAgIG9uUmVzcG9uZGVyR3JhbnQ6IG9uUmVzcG9uZGVyR3JhbnQsXG4gICAgb25SZXNwb25kZXJNb3ZlOiBvblJlc3BvbmRlck1vdmUsXG4gICAgb25SZXNwb25kZXJSZWplY3Q6IG9uUmVzcG9uZGVyUmVqZWN0LFxuICAgIG9uUmVzcG9uZGVyUmVsZWFzZTogb25SZXNwb25kZXJSZWxlYXNlLFxuICAgIG9uUmVzcG9uZGVyU3RhcnQ6IG9uUmVzcG9uZGVyU3RhcnQsXG4gICAgb25SZXNwb25kZXJUZXJtaW5hdGU6IG9uUmVzcG9uZGVyVGVybWluYXRlLFxuICAgIG9uUmVzcG9uZGVyVGVybWluYXRpb25SZXF1ZXN0OiBvblJlc3BvbmRlclRlcm1pbmF0aW9uUmVxdWVzdCxcbiAgICBvblNjcm9sbFNob3VsZFNldFJlc3BvbmRlcjogb25TY3JvbGxTaG91bGRTZXRSZXNwb25kZXIsXG4gICAgb25TY3JvbGxTaG91bGRTZXRSZXNwb25kZXJDYXB0dXJlOiBvblNjcm9sbFNob3VsZFNldFJlc3BvbmRlckNhcHR1cmUsXG4gICAgb25TZWxlY3Rpb25DaGFuZ2VTaG91bGRTZXRSZXNwb25kZXI6IG9uU2VsZWN0aW9uQ2hhbmdlU2hvdWxkU2V0UmVzcG9uZGVyLFxuICAgIG9uU2VsZWN0aW9uQ2hhbmdlU2hvdWxkU2V0UmVzcG9uZGVyQ2FwdHVyZTogb25TZWxlY3Rpb25DaGFuZ2VTaG91bGRTZXRSZXNwb25kZXJDYXB0dXJlLFxuICAgIG9uU3RhcnRTaG91bGRTZXRSZXNwb25kZXI6IG9uU3RhcnRTaG91bGRTZXRSZXNwb25kZXIsXG4gICAgb25TdGFydFNob3VsZFNldFJlc3BvbmRlckNhcHR1cmU6IG9uU3RhcnRTaG91bGRTZXRSZXNwb25kZXJDYXB0dXJlXG4gIH0pO1xuICB2YXIgY29tcG9uZW50ID0gJ2Rpdic7XG5cbiAgdmFyIHN0eWxlID0gX1N0eWxlU2hlZXQuZGVmYXVsdC5jb21wb3NlKGhhc1RleHRBbmNlc3RvciAmJiBzdHlsZXMuaW5saW5lLCBwcm9wcy5zdHlsZSk7XG5cbiAgdmFyIHN1cHBvcnRlZFByb3BzID0gcGlja1Byb3BzKHByb3BzKTtcbiAgc3VwcG9ydGVkUHJvcHMuY2xhc3NMaXN0ID0gY2xhc3NMaXN0O1xuICBzdXBwb3J0ZWRQcm9wcy5zdHlsZSA9IHN0eWxlO1xuXG4gIGlmIChwcm9wcy5ocmVmICE9IG51bGwpIHtcbiAgICBjb21wb25lbnQgPSAnYSc7XG5cbiAgICBpZiAoaHJlZkF0dHJzICE9IG51bGwpIHtcbiAgICAgIHZhciBkb3dubG9hZCA9IGhyZWZBdHRycy5kb3dubG9hZCxcbiAgICAgICAgICByZWwgPSBocmVmQXR0cnMucmVsLFxuICAgICAgICAgIHRhcmdldCA9IGhyZWZBdHRycy50YXJnZXQ7XG5cbiAgICAgIGlmIChkb3dubG9hZCAhPSBudWxsKSB7XG4gICAgICAgIHN1cHBvcnRlZFByb3BzLmRvd25sb2FkID0gZG93bmxvYWQ7XG4gICAgICB9XG5cbiAgICAgIGlmIChyZWwgIT0gbnVsbCkge1xuICAgICAgICBzdXBwb3J0ZWRQcm9wcy5yZWwgPSByZWw7XG4gICAgICB9XG5cbiAgICAgIGlmICh0eXBlb2YgdGFyZ2V0ID09PSAnc3RyaW5nJykge1xuICAgICAgICBzdXBwb3J0ZWRQcm9wcy50YXJnZXQgPSB0YXJnZXQuY2hhckF0KDApICE9PSAnXycgPyAnXycgKyB0YXJnZXQgOiB0YXJnZXQ7XG4gICAgICB9XG4gICAgfVxuICB9XG5cbiAgdmFyIHBsYXRmb3JtTWV0aG9kc1JlZiA9ICgwLCBfdXNlUGxhdGZvcm1NZXRob2RzLmRlZmF1bHQpKHN1cHBvcnRlZFByb3BzKTtcbiAgdmFyIHNldFJlZiA9ICgwLCBfdXNlTWVyZ2VSZWZzLmRlZmF1bHQpKGhvc3RSZWYsIHBsYXRmb3JtTWV0aG9kc1JlZiwgZm9yd2FyZGVkUmVmKTtcbiAgc3VwcG9ydGVkUHJvcHMucmVmID0gc2V0UmVmO1xuICByZXR1cm4gKDAsIF9jcmVhdGVFbGVtZW50LmRlZmF1bHQpKGNvbXBvbmVudCwgc3VwcG9ydGVkUHJvcHMpO1xufSk7XG5WaWV3LmRpc3BsYXlOYW1lID0gJ1ZpZXcnO1xuXG52YXIgY2xhc3NlcyA9IF9jc3MuZGVmYXVsdC5jcmVhdGUoe1xuICB2aWV3OiB7XG4gICAgYWxpZ25JdGVtczogJ3N0cmV0Y2gnLFxuICAgIGJvcmRlcjogJzAgc29saWQgYmxhY2snLFxuICAgIGJveFNpemluZzogJ2JvcmRlci1ib3gnLFxuICAgIGRpc3BsYXk6ICdmbGV4JyxcbiAgICBmbGV4QmFzaXM6ICdhdXRvJyxcbiAgICBmbGV4RGlyZWN0aW9uOiAnY29sdW1uJyxcbiAgICBmbGV4U2hyaW5rOiAwLFxuICAgIG1hcmdpbjogMCxcbiAgICBtaW5IZWlnaHQ6IDAsXG4gICAgbWluV2lkdGg6IDAsXG4gICAgcGFkZGluZzogMCxcbiAgICBwb3NpdGlvbjogJ3JlbGF0aXZlJyxcbiAgICB6SW5kZXg6IDBcbiAgfVxufSk7XG5cbnZhciBjbGFzc0xpc3QgPSBbY2xhc3Nlcy52aWV3XTtcblxudmFyIHN0eWxlcyA9IF9TdHlsZVNoZWV0LmRlZmF1bHQuY3JlYXRlKHtcbiAgaW5saW5lOiB7XG4gICAgZGlzcGxheTogJ2lubGluZS1mbGV4J1xuICB9XG59KTtcblxudmFyIF9kZWZhdWx0ID0gVmlldztcbmV4cG9ydHMuZGVmYXVsdCA9IF9kZWZhdWx0O1xubW9kdWxlLmV4cG9ydHMgPSBleHBvcnRzLmRlZmF1bHQ7Il19