7599228c1450eb27ff3f1f88cfd379f5
"use strict";

exports.__esModule = true;
exports.default = void 0;

var React = _interopRequireWildcard(require("react"));

var _StyleSheet = _interopRequireDefault(require("../StyleSheet"));

var _View = _interopRequireDefault(require("../View"));

var _useMergeRefs = _interopRequireDefault(require("../../modules/useMergeRefs"));

function _interopRequireDefault(obj) {
  return obj && obj.__esModule ? obj : {
    default: obj
  };
}

function _getRequireWildcardCache() {
  if (typeof WeakMap !== "function") return null;
  var cache = new WeakMap();

  _getRequireWildcardCache = function _getRequireWildcardCache() {
    return cache;
  };

  return cache;
}

function _interopRequireWildcard(obj) {
  if (obj && obj.__esModule) {
    return obj;
  }

  if (obj === null || typeof obj !== "object" && typeof obj !== "function") {
    return {
      default: obj
    };
  }

  var cache = _getRequireWildcardCache();

  if (cache && cache.has(obj)) {
    return cache.get(obj);
  }

  var newObj = {};
  var hasPropertyDescriptor = Object.defineProperty && Object.getOwnPropertyDescriptor;

  for (var key in obj) {
    if (Object.prototype.hasOwnProperty.call(obj, key)) {
      var desc = hasPropertyDescriptor ? Object.getOwnPropertyDescriptor(obj, key) : null;

      if (desc && (desc.get || desc.set)) {
        Object.defineProperty(newObj, key, desc);
      } else {
        newObj[key] = obj[key];
      }
    }
  }

  newObj.default = obj;

  if (cache) {
    cache.set(obj, newObj);
  }

  return newObj;
}

function _extends() {
  _extends = Object.assign || function (target) {
    for (var i = 1; i < arguments.length; i++) {
      var source = arguments[i];

      for (var key in source) {
        if (Object.prototype.hasOwnProperty.call(source, key)) {
          target[key] = source[key];
        }
      }
    }

    return target;
  };

  return _extends.apply(this, arguments);
}

function _objectWithoutPropertiesLoose(source, excluded) {
  if (source == null) return {};
  var target = {};
  var sourceKeys = Object.keys(source);
  var key, i;

  for (i = 0; i < sourceKeys.length; i++) {
    key = sourceKeys[i];
    if (excluded.indexOf(key) >= 0) continue;
    target[key] = source[key];
  }

  return target;
}

function normalizeScrollEvent(e) {
  return {
    nativeEvent: {
      contentOffset: {
        get x() {
          return e.target.scrollLeft;
        },

        get y() {
          return e.target.scrollTop;
        }

      },
      contentSize: {
        get height() {
          return e.target.scrollHeight;
        },

        get width() {
          return e.target.scrollWidth;
        }

      },
      layoutMeasurement: {
        get height() {
          return e.target.offsetHeight;
        },

        get width() {
          return e.target.offsetWidth;
        }

      }
    },
    timeStamp: Date.now()
  };
}

function shouldEmitScrollEvent(lastTick, eventThrottle) {
  var timeSinceLastTick = Date.now() - lastTick;
  return eventThrottle > 0 && timeSinceLastTick >= eventThrottle;
}

var ScrollViewBase = React.forwardRef(function (props, forwardedRef) {
  var onScroll = props.onScroll,
      onTouchMove = props.onTouchMove,
      onWheel = props.onWheel,
      _props$scrollEnabled = props.scrollEnabled,
      scrollEnabled = _props$scrollEnabled === void 0 ? true : _props$scrollEnabled,
      _props$scrollEventThr = props.scrollEventThrottle,
      scrollEventThrottle = _props$scrollEventThr === void 0 ? 0 : _props$scrollEventThr,
      showsHorizontalScrollIndicator = props.showsHorizontalScrollIndicator,
      showsVerticalScrollIndicator = props.showsVerticalScrollIndicator,
      style = props.style,
      rest = _objectWithoutPropertiesLoose(props, ["onScroll", "onTouchMove", "onWheel", "scrollEnabled", "scrollEventThrottle", "showsHorizontalScrollIndicator", "showsVerticalScrollIndicator", "style"]);

  var scrollState = React.useRef({
    isScrolling: false,
    scrollLastTick: 0
  });
  var scrollTimeout = React.useRef(null);
  var scrollRef = React.useRef(null);

  function createPreventableScrollHandler(handler) {
    return function (e) {
      if (scrollEnabled) {
        if (handler) {
          handler(e);
        }
      }
    };
  }

  function handleScroll(e) {
    e.stopPropagation();

    if (e.target === scrollRef.current) {
      e.persist();

      if (scrollTimeout.current != null) {
        clearTimeout(scrollTimeout.current);
      }

      scrollTimeout.current = setTimeout(function () {
        handleScrollEnd(e);
      }, 100);

      if (scrollState.current.isScrolling) {
        if (shouldEmitScrollEvent(scrollState.current.scrollLastTick, scrollEventThrottle)) {
          handleScrollTick(e);
        }
      } else {
        handleScrollStart(e);
      }
    }
  }

  function handleScrollStart(e) {
    scrollState.current.isScrolling = true;
    handleScrollTick(e);
  }

  function handleScrollTick(e) {
    scrollState.current.scrollLastTick = Date.now();

    if (onScroll) {
      onScroll(normalizeScrollEvent(e));
    }
  }

  function handleScrollEnd(e) {
    scrollState.current.isScrolling = false;

    if (onScroll) {
      onScroll(normalizeScrollEvent(e));
    }
  }

  var hideScrollbar = showsHorizontalScrollIndicator === false || showsVerticalScrollIndicator === false;
  return React.createElement(_View.default, _extends({}, rest, {
    onScroll: handleScroll,
    onTouchMove: createPreventableScrollHandler(onTouchMove),
    onWheel: createPreventableScrollHandler(onWheel),
    ref: (0, _useMergeRefs.default)(scrollRef, forwardedRef),
    style: [style, !scrollEnabled && styles.scrollDisabled, hideScrollbar && styles.hideScrollbar]
  }));
});

var styles = _StyleSheet.default.create({
  scrollDisabled: {
    overflowX: 'hidden',
    overflowY: 'hidden',
    touchAction: 'none'
  },
  hideScrollbar: {
    scrollbarWidth: 'none'
  }
});

var _default = ScrollViewBase;
exports.default = _default;
module.exports = exports.default;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIlNjcm9sbFZpZXdCYXNlLmpzIl0sIm5hbWVzIjpbImV4cG9ydHMiLCJfX2VzTW9kdWxlIiwiZGVmYXVsdCIsIlJlYWN0IiwiX2ludGVyb3BSZXF1aXJlV2lsZGNhcmQiLCJyZXF1aXJlIiwiX1N0eWxlU2hlZXQiLCJfaW50ZXJvcFJlcXVpcmVEZWZhdWx0IiwiX1ZpZXciLCJfdXNlTWVyZ2VSZWZzIiwib2JqIiwiX2dldFJlcXVpcmVXaWxkY2FyZENhY2hlIiwiV2Vha01hcCIsImNhY2hlIiwiaGFzIiwiZ2V0IiwibmV3T2JqIiwiaGFzUHJvcGVydHlEZXNjcmlwdG9yIiwiT2JqZWN0IiwiZGVmaW5lUHJvcGVydHkiLCJnZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3IiLCJrZXkiLCJwcm90b3R5cGUiLCJoYXNPd25Qcm9wZXJ0eSIsImNhbGwiLCJkZXNjIiwic2V0IiwiX2V4dGVuZHMiLCJhc3NpZ24iLCJ0YXJnZXQiLCJpIiwiYXJndW1lbnRzIiwibGVuZ3RoIiwic291cmNlIiwiYXBwbHkiLCJfb2JqZWN0V2l0aG91dFByb3BlcnRpZXNMb29zZSIsImV4Y2x1ZGVkIiwic291cmNlS2V5cyIsImtleXMiLCJpbmRleE9mIiwibm9ybWFsaXplU2Nyb2xsRXZlbnQiLCJlIiwibmF0aXZlRXZlbnQiLCJjb250ZW50T2Zmc2V0IiwieCIsInNjcm9sbExlZnQiLCJ5Iiwic2Nyb2xsVG9wIiwiY29udGVudFNpemUiLCJoZWlnaHQiLCJzY3JvbGxIZWlnaHQiLCJ3aWR0aCIsInNjcm9sbFdpZHRoIiwibGF5b3V0TWVhc3VyZW1lbnQiLCJvZmZzZXRIZWlnaHQiLCJvZmZzZXRXaWR0aCIsInRpbWVTdGFtcCIsIkRhdGUiLCJub3ciLCJzaG91bGRFbWl0U2Nyb2xsRXZlbnQiLCJsYXN0VGljayIsImV2ZW50VGhyb3R0bGUiLCJ0aW1lU2luY2VMYXN0VGljayIsIlNjcm9sbFZpZXdCYXNlIiwiZm9yd2FyZFJlZiIsInByb3BzIiwiZm9yd2FyZGVkUmVmIiwib25TY3JvbGwiLCJvblRvdWNoTW92ZSIsIm9uV2hlZWwiLCJfcHJvcHMkc2Nyb2xsRW5hYmxlZCIsInNjcm9sbEVuYWJsZWQiLCJfcHJvcHMkc2Nyb2xsRXZlbnRUaHIiLCJzY3JvbGxFdmVudFRocm90dGxlIiwic2hvd3NIb3Jpem9udGFsU2Nyb2xsSW5kaWNhdG9yIiwic2hvd3NWZXJ0aWNhbFNjcm9sbEluZGljYXRvciIsInN0eWxlIiwicmVzdCIsInNjcm9sbFN0YXRlIiwidXNlUmVmIiwiaXNTY3JvbGxpbmciLCJzY3JvbGxMYXN0VGljayIsInNjcm9sbFRpbWVvdXQiLCJzY3JvbGxSZWYiLCJjcmVhdGVQcmV2ZW50YWJsZVNjcm9sbEhhbmRsZXIiLCJoYW5kbGVyIiwiaGFuZGxlU2Nyb2xsIiwic3RvcFByb3BhZ2F0aW9uIiwiY3VycmVudCIsInBlcnNpc3QiLCJjbGVhclRpbWVvdXQiLCJzZXRUaW1lb3V0IiwiaGFuZGxlU2Nyb2xsRW5kIiwiaGFuZGxlU2Nyb2xsVGljayIsImhhbmRsZVNjcm9sbFN0YXJ0IiwiaGlkZVNjcm9sbGJhciIsImNyZWF0ZUVsZW1lbnQiLCJyZWYiLCJzdHlsZXMiLCJzY3JvbGxEaXNhYmxlZCIsImNyZWF0ZSIsIm92ZXJmbG93WCIsIm92ZXJmbG93WSIsInRvdWNoQWN0aW9uIiwic2Nyb2xsYmFyV2lkdGgiLCJfZGVmYXVsdCIsIm1vZHVsZSJdLCJtYXBwaW5ncyI6IkFBQUE7O0FBRUFBLE9BQU8sQ0FBQ0MsVUFBUixHQUFxQixJQUFyQjtBQUNBRCxPQUFPLENBQUNFLE9BQVIsR0FBa0IsS0FBSyxDQUF2Qjs7QUFFQSxJQUFJQyxLQUFLLEdBQUdDLHVCQUF1QixDQUFDQyxPQUFPLENBQUMsT0FBRCxDQUFSLENBQW5DOztBQUVBLElBQUlDLFdBQVcsR0FBR0Msc0JBQXNCLENBQUNGLE9BQU8saUJBQVIsQ0FBeEM7O0FBRUEsSUFBSUcsS0FBSyxHQUFHRCxzQkFBc0IsQ0FBQ0YsT0FBTyxXQUFSLENBQWxDOztBQUVBLElBQUlJLGFBQWEsR0FBR0Ysc0JBQXNCLENBQUNGLE9BQU8s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LE9BQVIsR0FBa0J1RyxRQUFsQjtBQUNBQyxNQUFNLENBQUMxRyxPQUFQLEdBQWlCQSxPQUFPLENBQUNFLE9BQXpCIiwic291cmNlc0NvbnRlbnQiOlsiXCJ1c2Ugc3RyaWN0XCI7XG5cbmV4cG9ydHMuX19lc01vZHVsZSA9IHRydWU7XG5leHBvcnRzLmRlZmF1bHQgPSB2b2lkIDA7XG5cbnZhciBSZWFjdCA9IF9pbnRlcm9wUmVxdWlyZVdpbGRjYXJkKHJlcXVpcmUoXCJyZWFjdFwiKSk7XG5cbnZhciBfU3R5bGVTaGVldCA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQocmVxdWlyZShcIi4uL1N0eWxlU2hlZXRcIikpO1xuXG52YXIgX1ZpZXcgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KHJlcXVpcmUoXCIuLi9WaWV3XCIpKTtcblxudmFyIF91c2VNZXJnZVJlZnMgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KHJlcXVpcmUoXCIuLi8uLi9tb2R1bGVzL3VzZU1lcmdlUmVmc1wiKSk7XG5cbmZ1bmN0aW9uIF9pbnRlcm9wUmVxdWlyZURlZmF1bHQob2JqKSB7IHJldHVybiBvYmogJiYgb2JqLl9fZXNNb2R1bGUgPyBvYmogOiB7IGRlZmF1bHQ6IG9iaiB9OyB9XG5cbmZ1bmN0aW9uIF9nZXRSZXF1aXJlV2lsZGNhcmRDYWNoZSgpIHsgaWYgKHR5cGVvZiBXZWFrTWFwICE9PSBcImZ1bmN0aW9uXCIpIHJldHVybiBudWxsOyB2YXIgY2FjaGUgPSBuZXcgV2Vha01hcCgpOyBfZ2V0UmVxdWlyZVdpbGRjYXJkQ2FjaGUgPSBmdW5jdGlvbiBfZ2V0UmVxdWlyZVdpbGRjYXJkQ2FjaGUoKSB7IHJldHVybiBjYWNoZTsgfTsgcmV0dXJuIGNhY2hlOyB9XG5cbmZ1bmN0aW9uIF9pbnRlcm9wUmVxdWlyZVdpbGRjYXJkKG9iaikgeyBpZiAob2JqICYmIG9iai5fX2VzTW9kdWxlKSB7IHJldHVybiBvYmo7IH0gaWYgKG9iaiA9PT0gbnVsbCB8fCB0eXBlb2Ygb2JqICE9PSBcIm9iamVjdFwiICYmIHR5cGVvZiBvYmogIT09IFwiZnVuY3Rpb25cIikgeyByZXR1cm4geyBkZWZhdWx0OiBvYmogfTsgfSB2YXIgY2FjaGUgPSBfZ2V0UmVxdWlyZVdpbGRjYXJkQ2FjaGUoKTsgaWYgKGNhY2hlICYmIGNhY2hlLmhhcyhvYmopKSB7IHJldHVybiBjYWNoZS5nZXQob2JqKTsgfSB2YXIgbmV3T2JqID0ge307IHZhciBoYXNQcm9wZXJ0eURlc2NyaXB0b3IgPSBPYmplY3QuZGVmaW5lUHJvcGVydHkgJiYgT2JqZWN0LmdldE93blByb3BlcnR5RGVzY3JpcHRvcjsgZm9yICh2YXIga2V5IGluIG9iaikgeyBpZiAoT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKG9iaiwga2V5KSkgeyB2YXIgZGVzYyA9IGhhc1Byb3BlcnR5RGVzY3JpcHRvciA/IE9iamVjdC5nZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3Iob2JqLCBrZXkpIDogbnVsbDsgaWYgKGRlc2MgJiYgKGRlc2MuZ2V0IHx8IGRlc2Muc2V0KSkgeyBPYmplY3QuZGVmaW5lUHJvcGVydHkobmV3T2JqLCBrZXksIGRlc2MpOyB9IGVsc2UgeyBuZXdPYmpba2V5XSA9IG9ialtrZXldOyB9IH0gfSBuZXdPYmouZGVmYXVsdCA9IG9iajsgaWYgKGNhY2hlKSB7IGNhY2hlLnNldChvYmosIG5ld09iaik7IH0gcmV0dXJuIG5ld09iajsgfVxuXG5mdW5jdGlvbiBfZXh0ZW5kcygpIHsgX2V4dGVuZHMgPSBPYmplY3QuYXNzaWduIHx8IGZ1bmN0aW9uICh0YXJnZXQpIHsgZm9yICh2YXIgaSA9IDE7IGkgPCBhcmd1bWVudHMubGVuZ3RoOyBpKyspIHsgdmFyIHNvdXJjZSA9IGFyZ3VtZW50c1tpXTsgZm9yICh2YXIga2V5IGluIHNvdXJjZSkgeyBpZiAoT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKHNvdXJjZSwga2V5KSkgeyB0YXJnZXRba2V5XSA9IHNvdXJjZVtrZXldOyB9IH0gfSByZXR1cm4gdGFyZ2V0OyB9OyByZXR1cm4gX2V4dGVuZHMuYXBwbHkodGhpcywgYXJndW1lbnRzKTsgfVxuXG5mdW5jdGlvbiBfb2JqZWN0V2l0aG91dFByb3BlcnRpZXNMb29zZShzb3VyY2UsIGV4Y2x1ZGVkKSB7IGlmIChzb3VyY2UgPT0gbnVsbCkgcmV0dXJuIHt9OyB2YXIgdGFyZ2V0ID0ge307IHZhciBzb3VyY2VLZXlzID0gT2JqZWN0LmtleXMoc291cmNlKTsgdmFyIGtleSwgaTsgZm9yIChpID0gMDsgaSA8IHNvdXJjZUtleXMubGVuZ3RoOyBpKyspIHsga2V5ID0gc291cmNlS2V5c1tpXTsgaWYgKGV4Y2x1ZGVkLmluZGV4T2Yoa2V5KSA+PSAwKSBjb250aW51ZTsgdGFyZ2V0W2tleV0gPSBzb3VyY2Vba2V5XTsgfSByZXR1cm4gdGFyZ2V0OyB9XG5cbmZ1bmN0aW9uIG5vcm1hbGl6ZVNjcm9sbEV2ZW50KGUpIHtcbiAgcmV0dXJuIHtcbiAgICBuYXRpdmVFdmVudDoge1xuICAgICAgY29udGVudE9mZnNldDoge1xuICAgICAgICBnZXQgeCgpIHtcbiAgICAgICAgICByZXR1cm4gZS50YXJnZXQuc2Nyb2xsTGVmdDtcbiAgICAgICAgfSxcblxuICAgICAgICBnZXQgeSgpIHtcbiAgICAgICAgICByZXR1cm4gZS50YXJnZXQuc2Nyb2xsVG9wO1xuICAgICAgICB9XG5cbiAgICAgIH0sXG4gICAgICBjb250ZW50U2l6ZToge1xuICAgICAgICBnZXQgaGVpZ2h0KCkge1xuICAgICAgICAgIHJldHVybiBlLnRhcmdldC5zY3JvbGxIZWlnaHQ7XG4gICAgICAgIH0sXG5cbiAgICAgICAgZ2V0IHdpZHRoKCkge1xuICAgICAgICAgIHJldHVybiBlLnRhcmdldC5zY3JvbGxXaWR0aDtcbiAgICAgICAgfVxuXG4gICAgICB9LFxuICAgICAgbGF5b3V0TWVhc3VyZW1lbnQ6IHtcbiAgICAgICAgZ2V0IGhlaWdodCgpIHtcbiAgICAgICAgICByZXR1cm4gZS50YXJnZXQub2Zmc2V0SGVpZ2h0O1xuICAgICAgICB9LFxuXG4gICAgICAgIGdldCB3aWR0aCgpIHtcbiAgICAgICAgICByZXR1cm4gZS50YXJnZXQub2Zmc2V0V2lkdGg7XG4gICAgICAgIH1cblxuICAgICAgfVxuICAgIH0sXG4gICAgdGltZVN0YW1wOiBEYXRlLm5vdygpXG4gIH07XG59XG5cbmZ1bmN0aW9uIHNob3VsZEVtaXRTY3JvbGxFdmVudChsYXN0VGljaywgZXZlbnRUaHJvdHRsZSkge1xuICB2YXIgdGltZVNpbmNlTGFzdFRpY2sgPSBEYXRlLm5vdygpIC0gbGFzdFRpY2s7XG4gIHJldHVybiBldmVudFRocm90dGxlID4gMCAmJiB0aW1lU2luY2VMYXN0VGljayA+PSBldmVudFRocm90dGxlO1xufVxuLyoqXG4gKiBFbmNhcHN1bGF0ZXMgdGhlIFdlYi1zcGVjaWZpYyBzY3JvbGwgdGhyb3R0bGluZyBhbmQgZGlzYWJsaW5nIGxvZ2ljXG4gKi9cblxuXG52YXIgU2Nyb2xsVmlld0Jhc2UgPSAvKiNfX1BVUkVfXyovUmVhY3QuZm9yd2FyZFJlZihmdW5jdGlvbiAocHJvcHMsIGZvcndhcmRlZFJlZikge1xuICB2YXIgb25TY3JvbGwgPSBwcm9wcy5vblNjcm9sbCxcbiAgICAgIG9uVG91Y2hNb3ZlID0gcHJvcHMub25Ub3VjaE1vdmUsXG4gICAgICBvbldoZWVsID0gcHJvcHMub25XaGVlbCxcbiAgICAgIF9wcm9wcyRzY3JvbGxFbmFibGVkID0gcHJvcHMuc2Nyb2xsRW5hYmxlZCxcbiAgICAgIHNjcm9sbEVuYWJsZWQgPSBfcHJvcHMkc2Nyb2xsRW5hYmxlZCA9PT0gdm9pZCAwID8gdHJ1ZSA6IF9wcm9wcyRzY3JvbGxFbmFibGVkLFxuICAgICAgX3Byb3BzJHNjcm9sbEV2ZW50VGhyID0gcHJvcHMuc2Nyb2xsRXZlbnRUaHJvdHRsZSxcbiAgICAgIHNjcm9sbEV2ZW50VGhyb3R0bGUgPSBfcHJvcHMkc2Nyb2xsRXZlbnRUaHIgPT09IHZvaWQgMCA/IDAgOiBfcHJvcHMkc2Nyb2xsRXZlbnRUaHIsXG4gICAgICBzaG93c0hvcml6b250YWxTY3JvbGxJbmRpY2F0b3IgPSBwcm9wcy5zaG93c0hvcml6b250YWxTY3JvbGxJbmRpY2F0b3IsXG4gICAgICBzaG93c1ZlcnRpY2FsU2Nyb2xsSW5kaWNhdG9yID0gcHJvcHMuc2hvd3NWZXJ0aWNhbFNjcm9sbEluZGljYXRvcixcbiAgICAgIHN0eWxlID0gcHJvcHMuc3R5bGUsXG4gICAgICByZXN0ID0gX29iamVjdFdpdGhvdXRQcm9wZXJ0aWVzTG9vc2UocHJvcHMsIFtcIm9uU2Nyb2xsXCIsIFwib25Ub3VjaE1vdmVcIiwgXCJvbldoZWVsXCIsIFwic2Nyb2xsRW5hYmxlZFwiLCBcInNjcm9sbEV2ZW50VGhyb3R0bGVcIiwgXCJzaG93c0hvcml6b250YWxTY3JvbGxJbmRpY2F0b3JcIiwgXCJzaG93c1ZlcnRpY2FsU2Nyb2xsSW5kaWNhdG9yXCIsIFwic3R5bGVcIl0pO1xuXG4gIHZhciBzY3JvbGxTdGF0ZSA9IFJlYWN0LnVzZVJlZih7XG4gICAgaXNTY3JvbGxpbmc6IGZhbHNlLFxuICAgIHNjcm9sbExhc3RUaWNrOiAwXG4gIH0pO1xuICB2YXIgc2Nyb2xsVGltZW91dCA9IFJlYWN0LnVzZVJlZihudWxsKTtcbiAgdmFyIHNjcm9sbFJlZiA9IFJlYWN0LnVzZVJlZihudWxsKTtcblxuICBmdW5jdGlvbiBjcmVhdGVQcmV2ZW50YWJsZVNjcm9sbEhhbmRsZXIoaGFuZGxlcikge1xuICAgIHJldHVybiBmdW5jdGlvbiAoZSkge1xuICAgICAgaWYgKHNjcm9sbEVuYWJsZWQpIHtcbiAgICAgICAgaWYgKGhhbmRsZXIpIHtcbiAgICAgICAgICBoYW5kbGVyKGUpO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgfTtcbiAgfVxuXG4gIGZ1bmN0aW9uIGhhbmRsZVNjcm9sbChlKSB7XG4gICAgZS5zdG9wUHJvcGFnYXRpb24oKTtcblxuICAgIGlmIChlLnRhcmdldCA9PT0gc2Nyb2xsUmVmLmN1cnJlbnQpIHtcbiAgICAgIGUucGVyc2lzdCgpOyAvLyBBIHNjcm9sbCBoYXBwZW5lZCwgc28gdGhlIHNjcm9sbCByZXNldHMgdGhlIHNjcm9sbGVuZCB0aW1lb3V0LlxuXG4gICAgICBpZiAoc2Nyb2xsVGltZW91dC5jdXJyZW50ICE9IG51bGwpIHtcbiAgICAgICAgY2xlYXJUaW1lb3V0KHNjcm9sbFRpbWVvdXQuY3VycmVudCk7XG4gICAgICB9XG5cbiAgICAgIHNjcm9sbFRpbWVvdXQuY3VycmVudCA9IHNldFRpbWVvdXQoZnVuY3Rpb24gKCkge1xuICAgICAgICBoYW5kbGVTY3JvbGxFbmQoZSk7XG4gICAgICB9LCAxMDApO1xuXG4gICAgICBpZiAoc2Nyb2xsU3RhdGUuY3VycmVudC5pc1Njcm9sbGluZykge1xuICAgICAgICAvLyBTY3JvbGwgbGFzdCB0aWNrIG1heSBoYXZlIGNoYW5nZWQsIGNoZWNrIGlmIHdlIG5lZWQgdG8gbm90aWZ5XG4gICAgICAgIGlmIChzaG91bGRFbWl0U2Nyb2xsRXZlbnQoc2Nyb2xsU3RhdGUuY3VycmVudC5zY3JvbGxMYXN0VGljaywgc2Nyb2xsRXZlbnRUaHJvdHRsZSkpIHtcbiAgICAgICAgICBoYW5kbGVTY3JvbGxUaWNrKGUpO1xuICAgICAgICB9XG4gICAgICB9IGVsc2Uge1xuICAgICAgICAvLyBXZXJlbid0IHNjcm9sbGluZywgc28gd2UgbXVzdCBoYXZlIGp1c3Qgc3RhcnRlZFxuICAgICAgICBoYW5kbGVTY3JvbGxTdGFydChlKTtcbiAgICAgIH1cbiAgICB9XG4gIH1cblxuICBmdW5jdGlvbiBoYW5kbGVTY3JvbGxTdGFydChlKSB7XG4gICAgc2Nyb2xsU3RhdGUuY3VycmVudC5pc1Njcm9sbGluZyA9IHRydWU7XG4gICAgaGFuZGxlU2Nyb2xsVGljayhlKTtcbiAgfVxuXG4gIGZ1bmN0aW9uIGhhbmRsZVNjcm9sbFRpY2soZSkge1xuICAgIHNjcm9sbFN0YXRlLmN1cnJlbnQuc2Nyb2xsTGFzdFRpY2sgPSBEYXRlLm5vdygpO1xuXG4gICAgaWYgKG9uU2Nyb2xsKSB7XG4gICAgICBvblNjcm9sbChub3JtYWxpemVTY3JvbGxFdmVudChlKSk7XG4gICAgfVxuICB9XG5cbiAgZnVuY3Rpb24gaGFuZGxlU2Nyb2xsRW5kKGUpIHtcbiAgICBzY3JvbGxTdGF0ZS5jdXJyZW50LmlzU2Nyb2xsaW5nID0gZmFsc2U7XG5cbiAgICBpZiAob25TY3JvbGwpIHtcbiAgICAgIG9uU2Nyb2xsKG5vcm1hbGl6ZVNjcm9sbEV2ZW50KGUpKTtcbiAgICB9XG4gIH1cblxuICB2YXIgaGlkZVNjcm9sbGJhciA9IHNob3dzSG9yaXpvbnRhbFNjcm9sbEluZGljYXRvciA9PT0gZmFsc2UgfHwgc2hvd3NWZXJ0aWNhbFNjcm9sbEluZGljYXRvciA9PT0gZmFsc2U7XG4gIHJldHVybiAvKiNfX1BVUkVfXyovUmVhY3QuY3JlYXRlRWxlbWVudChfVmlldy5kZWZhdWx0LCBfZXh0ZW5kcyh7fSwgcmVzdCwge1xuICAgIG9uU2Nyb2xsOiBoYW5kbGVTY3JvbGwsXG4gICAgb25Ub3VjaE1vdmU6IGNyZWF0ZVByZXZlbnRhYmxlU2Nyb2xsSGFuZGxlcihvblRvdWNoTW92ZSksXG4gICAgb25XaGVlbDogY3JlYXRlUHJldmVudGFibGVTY3JvbGxIYW5kbGVyKG9uV2hlZWwpLFxuICAgIHJlZjogKDAsIF91c2VNZXJnZVJlZnMuZGVmYXVsdCkoc2Nyb2xsUmVmLCBmb3J3YXJkZWRSZWYpLFxuICAgIHN0eWxlOiBbc3R5bGUsICFzY3JvbGxFbmFibGVkICYmIHN0eWxlcy5zY3JvbGxEaXNhYmxlZCwgaGlkZVNjcm9sbGJhciAmJiBzdHlsZXMuaGlkZVNjcm9sbGJhcl1cbiAgfSkpO1xufSk7IC8vIENocm9tZSBkb2Vzbid0IHN1cHBvcnQgZS5wcmV2ZW50RGVmYXVsdCBpbiB0aGlzIGNhc2U7IHRvdWNoLWFjdGlvbiBtdXN0IGJlXG4vLyB1c2VkIHRvIGRpc2FibGUgc2Nyb2xsaW5nLlxuLy8gaHR0cHM6Ly9kZXZlbG9wZXJzLmdvb2dsZS5jb20vd2ViL3VwZGF0ZXMvMjAxNy8wMS9zY3JvbGxpbmctaW50ZXJ2ZW50aW9uXG5cbnZhciBzdHlsZXMgPSBfU3R5bGVTaGVldC5kZWZhdWx0LmNyZWF0ZSh7XG4gIHNjcm9sbERpc2FibGVkOiB7XG4gICAgb3ZlcmZsb3dYOiAnaGlkZGVuJyxcbiAgICBvdmVyZmxvd1k6ICdoaWRkZW4nLFxuICAgIHRvdWNoQWN0aW9uOiAnbm9uZSdcbiAgfSxcbiAgaGlkZVNjcm9sbGJhcjoge1xuICAgIHNjcm9sbGJhcldpZHRoOiAnbm9uZSdcbiAgfVxufSk7XG5cbnZhciBfZGVmYXVsdCA9IFNjcm9sbFZpZXdCYXNlO1xuZXhwb3J0cy5kZWZhdWx0ID0gX2RlZmF1bHQ7XG5tb2R1bGUuZXhwb3J0cyA9IGV4cG9ydHMuZGVmYXVsdDsiXX0=