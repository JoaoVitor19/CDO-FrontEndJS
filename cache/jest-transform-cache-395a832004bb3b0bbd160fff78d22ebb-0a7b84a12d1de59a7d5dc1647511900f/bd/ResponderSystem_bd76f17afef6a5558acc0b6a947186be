061296a0ea5d373224de32bc7140936a
"use strict";

exports.__esModule = true;
exports.attachListeners = attachListeners;
exports.addNode = addNode;
exports.removeNode = removeNode;
exports.terminateResponder = terminateResponder;
exports.getResponderNode = getResponderNode;

var _ExecutionEnvironment = require("fbjs/lib/ExecutionEnvironment");

var _createResponderEvent = _interopRequireDefault(require("./createResponderEvent"));

var _ResponderEventTypes = require("./ResponderEventTypes");

var _utils = require("./utils");

var _ResponderTouchHistoryStore = _interopRequireDefault(require("./ResponderTouchHistoryStore"));

function _interopRequireDefault(obj) {
  return obj && obj.__esModule ? obj : {
    default: obj
  };
}

var emptyObject = {};
var startRegistration = ['onStartShouldSetResponderCapture', 'onStartShouldSetResponder', {
  bubbles: true
}];
var moveRegistration = ['onMoveShouldSetResponderCapture', 'onMoveShouldSetResponder', {
  bubbles: true
}];
var scrollRegistration = ['onScrollShouldSetResponderCapture', 'onScrollShouldSetResponder', {
  bubbles: false
}];
var shouldSetResponderEvents = {
  touchstart: startRegistration,
  mousedown: startRegistration,
  touchmove: moveRegistration,
  mousemove: moveRegistration,
  scroll: scrollRegistration
};
var emptyResponder = {
  id: null,
  idPath: null,
  node: null
};
var responderListenersMap = new Map();
var isEmulatingMouseEvents = false;
var trackedTouchCount = 0;
var currentResponder = {
  id: null,
  node: null,
  idPath: null
};

function changeCurrentResponder(responder) {
  currentResponder = responder;
}

function getResponderConfig(id) {
  var config = responderListenersMap.get(id);
  return config != null ? config : emptyObject;
}

function eventListener(domEvent) {
  var eventType = domEvent.type;
  var eventTarget = domEvent.target;

  if (eventType === 'touchstart') {
    isEmulatingMouseEvents = true;
  }

  if (eventType === 'touchmove' || trackedTouchCount > 1) {
    isEmulatingMouseEvents = false;
  }

  if (eventType === 'mousedown' && isEmulatingMouseEvents || eventType === 'mousemove' && isEmulatingMouseEvents || eventType === 'mousemove' && trackedTouchCount < 1) {
    return;
  }

  if (isEmulatingMouseEvents && eventType === 'mouseup') {
    if (trackedTouchCount === 0) {
      isEmulatingMouseEvents = false;
    }

    return;
  }

  var isStartEvent = (0, _ResponderEventTypes.isStartish)(eventType) && (0, _utils.isPrimaryPointerDown)(domEvent);
  var isMoveEvent = (0, _ResponderEventTypes.isMoveish)(eventType);
  var isEndEvent = (0, _ResponderEventTypes.isEndish)(eventType);
  var isScrollEvent = (0, _ResponderEventTypes.isScroll)(eventType);
  var isSelectionChangeEvent = (0, _ResponderEventTypes.isSelectionChange)(eventType);
  var responderEvent = (0, _createResponderEvent.default)(domEvent);

  if (isStartEvent || isMoveEvent || isEndEvent) {
    if (domEvent.touches) {
      trackedTouchCount = domEvent.touches.length;
    } else {
      if (isStartEvent) {
        trackedTouchCount = 1;
      } else if (isEndEvent) {
        trackedTouchCount = 0;
      }
    }

    _ResponderTouchHistoryStore.default.recordTouchTrack(eventType, responderEvent.nativeEvent);
  }

  var eventPaths = (0, _utils.getResponderPaths)(domEvent);
  var wasNegotiated = false;
  var wantsResponder;

  if (isStartEvent || isMoveEvent || isScrollEvent && trackedTouchCount > 0) {
    var currentResponderIdPath = currentResponder.idPath;
    var eventIdPath = eventPaths.idPath;

    if (currentResponderIdPath != null && eventIdPath != null) {
      var lowestCommonAncestor = (0, _utils.getLowestCommonAncestor)(currentResponderIdPath, eventIdPath);

      if (lowestCommonAncestor != null) {
        var indexOfLowestCommonAncestor = eventIdPath.indexOf(lowestCommonAncestor);
        var index = indexOfLowestCommonAncestor + (lowestCommonAncestor === currentResponder.id ? 1 : 0);
        eventPaths = {
          idPath: eventIdPath.slice(index),
          nodePath: eventPaths.nodePath.slice(index)
        };
      } else {
        eventPaths = null;
      }
    }

    if (eventPaths != null) {
      wantsResponder = findWantsResponder(eventPaths, domEvent, responderEvent);

      if (wantsResponder != null) {
        attemptTransfer(responderEvent, wantsResponder);
        wasNegotiated = true;
      }
    }
  }

  if (currentResponder.id != null && currentResponder.node != null) {
    var _currentResponder = currentResponder,
        id = _currentResponder.id,
        node = _currentResponder.node;

    var _getResponderConfig = getResponderConfig(id),
        onResponderStart = _getResponderConfig.onResponderStart,
        onResponderMove = _getResponderConfig.onResponderMove,
        onResponderEnd = _getResponderConfig.onResponderEnd,
        onResponderRelease = _getResponderConfig.onResponderRelease,
        onResponderTerminate = _getResponderConfig.onResponderTerminate,
        onResponderTerminationRequest = _getResponderConfig.onResponderTerminationRequest;

    responderEvent.bubbles = false;
    responderEvent.cancelable = false;
    responderEvent.currentTarget = node;

    if (isStartEvent) {
      if (onResponderStart != null) {
        responderEvent.dispatchConfig.registrationName = 'onResponderStart';
        onResponderStart(responderEvent);
      }
    } else if (isMoveEvent) {
      if (onResponderMove != null) {
        responderEvent.dispatchConfig.registrationName = 'onResponderMove';
        onResponderMove(responderEvent);
      }
    } else {
      var isTerminateEvent = (0, _ResponderEventTypes.isCancelish)(eventType) || eventType === 'contextmenu' || eventType === 'blur' && eventTarget === window || eventType === 'blur' && eventTarget.contains(node) && domEvent.relatedTarget !== node || isScrollEvent && trackedTouchCount === 0 || isScrollEvent && eventTarget.contains(node) && eventTarget !== node || isSelectionChangeEvent && (0, _utils.hasValidSelection)(domEvent);
      var isReleaseEvent = isEndEvent && !isTerminateEvent && !(0, _utils.hasTargetTouches)(node, domEvent.touches);

      if (isEndEvent) {
        if (onResponderEnd != null) {
          responderEvent.dispatchConfig.registrationName = 'onResponderEnd';
          onResponderEnd(responderEvent);
        }
      }

      if (isReleaseEvent) {
        if (onResponderRelease != null) {
          responderEvent.dispatchConfig.registrationName = 'onResponderRelease';
          onResponderRelease(responderEvent);
        }

        changeCurrentResponder(emptyResponder);
      }

      if (isTerminateEvent) {
        var shouldTerminate = true;

        if (eventType === 'contextmenu' || eventType === 'scroll' || eventType === 'selectionchange') {
          if (wasNegotiated) {
            shouldTerminate = false;
          } else if (onResponderTerminationRequest != null) {
            responderEvent.dispatchConfig.registrationName = 'onResponderTerminationRequest';

            if (onResponderTerminationRequest(responderEvent) === false) {
              shouldTerminate = false;
            }
          }
        }

        if (shouldTerminate) {
          if (onResponderTerminate != null) {
            responderEvent.dispatchConfig.registrationName = 'onResponderTerminate';
            onResponderTerminate(responderEvent);
          }

          changeCurrentResponder(emptyResponder);
          isEmulatingMouseEvents = false;
          trackedTouchCount = 0;
        }
      }
    }
  }
}

function findWantsResponder(eventPaths, domEvent, responderEvent) {
  var shouldSetCallbacks = shouldSetResponderEvents[domEvent.type];

  if (shouldSetCallbacks != null) {
    var idPath = eventPaths.idPath,
        nodePath = eventPaths.nodePath;
    var shouldSetCallbackCaptureName = shouldSetCallbacks[0];
    var shouldSetCallbackBubbleName = shouldSetCallbacks[1];
    var bubbles = shouldSetCallbacks[2].bubbles;

    var check = function check(id, node, callbackName) {
      var config = getResponderConfig(id);
      var shouldSetCallback = config[callbackName];

      if (shouldSetCallback != null) {
        responderEvent.currentTarget = node;

        if (shouldSetCallback(responderEvent) === true) {
          var prunedIdPath = idPath.slice(idPath.indexOf(id));
          return {
            id: id,
            node: node,
            idPath: prunedIdPath
          };
        }
      }
    };

    for (var i = idPath.length - 1; i >= 0; i--) {
      var id = idPath[i];
      var node = nodePath[i];
      var result = check(id, node, shouldSetCallbackCaptureName);

      if (result != null) {
        return result;
      }

      if (responderEvent.isPropagationStopped() === true) {
        return;
      }
    }

    if (bubbles) {
      for (var _i = 0; _i < idPath.length; _i++) {
        var _id = idPath[_i];
        var _node = nodePath[_i];

        var _result = check(_id, _node, shouldSetCallbackBubbleName);

        if (_result != null) {
          return _result;
        }

        if (responderEvent.isPropagationStopped() === true) {
          return;
        }
      }
    } else {
      var _id2 = idPath[0];
      var _node2 = nodePath[0];
      var target = domEvent.target;

      if (target === _node2) {
        return check(_id2, _node2, shouldSetCallbackBubbleName);
      }
    }
  }
}

function attemptTransfer(responderEvent, wantsResponder) {
  var _currentResponder2 = currentResponder,
      currentId = _currentResponder2.id,
      currentNode = _currentResponder2.node;
  var id = wantsResponder.id,
      node = wantsResponder.node;

  var _getResponderConfig2 = getResponderConfig(id),
      onResponderGrant = _getResponderConfig2.onResponderGrant,
      onResponderReject = _getResponderConfig2.onResponderReject;

  responderEvent.bubbles = false;
  responderEvent.cancelable = false;
  responderEvent.currentTarget = node;

  if (currentId == null) {
    if (onResponderGrant != null) {
      responderEvent.currentTarget = node;
      responderEvent.dispatchConfig.registrationName = 'onResponderGrant';
      onResponderGrant(responderEvent);
    }

    changeCurrentResponder(wantsResponder);
  } else {
    var _getResponderConfig3 = getResponderConfig(currentId),
        onResponderTerminate = _getResponderConfig3.onResponderTerminate,
        onResponderTerminationRequest = _getResponderConfig3.onResponderTerminationRequest;

    var allowTransfer = true;

    if (onResponderTerminationRequest != null) {
      responderEvent.currentTarget = currentNode;
      responderEvent.dispatchConfig.registrationName = 'onResponderTerminationRequest';

      if (onResponderTerminationRequest(responderEvent) === false) {
        allowTransfer = false;
      }
    }

    if (allowTransfer) {
      if (onResponderTerminate != null) {
        responderEvent.currentTarget = currentNode;
        responderEvent.dispatchConfig.registrationName = 'onResponderTerminate';
        onResponderTerminate(responderEvent);
      }

      if (onResponderGrant != null) {
        responderEvent.currentTarget = node;
        responderEvent.dispatchConfig.registrationName = 'onResponderGrant';
        onResponderGrant(responderEvent);
      }

      changeCurrentResponder(wantsResponder);
    } else {
      if (onResponderReject != null) {
        responderEvent.currentTarget = node;
        responderEvent.dispatchConfig.registrationName = 'onResponderReject';
        onResponderReject(responderEvent);
      }
    }
  }
}

var documentEventsCapturePhase = ['blur', 'scroll'];
var documentEventsBubblePhase = ['mousedown', 'mousemove', 'mouseup', 'dragstart', 'touchstart', 'touchmove', 'touchend', 'touchcancel', 'contextmenu', 'select', 'selectionchange'];

function attachListeners() {
  if (_ExecutionEnvironment.canUseDOM && window.__reactResponderSystemActive == null) {
    window.addEventListener('blur', eventListener);
    documentEventsBubblePhase.forEach(function (eventType) {
      document.addEventListener(eventType, eventListener);
    });
    documentEventsCapturePhase.forEach(function (eventType) {
      document.addEventListener(eventType, eventListener, true);
    });
    window.__reactResponderSystemActive = true;
  }
}

function addNode(id, node, config) {
  (0, _utils.setResponderId)(node, id);
  responderListenersMap.set(id, config);
}

function removeNode(id) {
  if (currentResponder.id === id) {
    terminateResponder();
  }

  if (responderListenersMap.has(id)) {
    responderListenersMap.delete(id);
  }
}

function terminateResponder() {
  var _currentResponder3 = currentResponder,
      id = _currentResponder3.id,
      node = _currentResponder3.node;

  if (id != null && node != null) {
    var _getResponderConfig4 = getResponderConfig(id),
        onResponderTerminate = _getResponderConfig4.onResponderTerminate;

    if (onResponderTerminate != null) {
      var event = (0, _createResponderEvent.default)({});
      event.currentTarget = node;
      onResponderTerminate(event);
    }

    changeCurrentResponder(emptyResponder);
  }

  isEmulatingMouseEvents = false;
  trackedTouchCount = 0;
}

function getResponderNode() {
  return currentResponder.node;
}
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIlJlc3BvbmRlclN5c3RlbS5qcyJdLCJuYW1lcyI6WyJleHBvcnRzIiwiX19lc01vZHVsZSIsImF0dGFjaExpc3RlbmVycyIsImFkZE5vZGUiLCJyZW1vdmVOb2RlIiwidGVybWluYXRlUmVzcG9uZGVyIiwiZ2V0UmVzcG9uZGVyTm9kZSIsIl9FeGVjdXRpb25FbnZpcm9ubWVudCIsInJlcXVpcmUiLCJfY3JlYXRlUmVzcG9uZGVyRXZlbnQiLCJfaW50ZXJvcFJlcXVpcmVEZWZhdWx0IiwiX1Jlc3BvbmRlckV2ZW50VHlwZXMiLCJfdXRpbHMiLCJfUmVzcG9uZGVyVG91Y2hIaXN0b3J5U3RvcmUiLCJvYmoiLCJkZWZhdWx0IiwiZW1wdHlPYmplY3QiLCJzdGFydFJlZ2lzdHJhdGlvbiIsImJ1YmJsZXMiLCJtb3ZlUmVnaXN0cmF0aW9uIiwic2Nyb2xsUmVnaXN0cmF0aW9uIiwic2hvdWxkU2V0UmVzcG9uZGVyRXZlbnRzIiwidG91Y2hzdGFydCIsIm1vdXNlZG93biIsInRvdWNobW92ZSIsIm1vdXNlbW92ZSIsInNjcm9sbCIsImVtcHR5UmVzcG9uZGVyIiwiaWQiLCJpZFBhdGgiLCJub2RlIiwicmVzcG9uZGVyTGlzdGVuZXJzTWFwIiwiTWFwIiwiaXNFbXVsYXRpbmdNb3VzZUV2ZW50cyIsInRyYWNrZWRUb3VjaENvdW50IiwiY3VycmVudFJlc3BvbmRlciIsImNoYW5nZUN1cnJlbnRSZXNwb25kZXIiLCJyZXNwb25kZXIiLCJnZXRSZXNwb25kZXJDb25maWciLCJjb25maWciLCJnZXQiLCJldmVudExpc3RlbmVyIiwiZG9tRXZlbnQiLCJldmVudFR5cGUiLCJ0eXBlIiwiZXZlbnRUYXJnZXQiLCJ0YXJnZXQiLCJpc1N0YXJ0RXZlbnQiLCJpc1N0YXJ0aXNoIiwiaXNQcmltYXJ5UG9pbnRlckRvd24iLCJpc01vdmVFdmVudCIsImlzTW92ZWlzaCIsImlzRW5kRXZlbnQiLCJpc0VuZGlzaCIsImlzU2Nyb2xsRXZlbnQiLCJpc1Njcm9sbCIsImlzU2VsZWN0aW9uQ2hhbmdlRXZlbnQiLCJpc1NlbGVjdGlvbkNoYW5nZSIsInJlc3BvbmRlckV2ZW50IiwidG91Y2hlcyIsImxlbmd0aCIsInJlY29yZFRvdWNoVHJhY2siLCJuYXRpdmVFdmVudCIsImV2ZW50UGF0aHMiLCJnZXRSZXNwb25kZXJQYXRocyIsIndhc05lZ290aWF0ZWQiLCJ3YW50c1Jlc3BvbmRlciIsImN1cnJlbnRSZXNwb25kZXJJZFBhdGgiLCJldmVudElkUGF0aCIsImxvd2VzdENvbW1vbkFuY2VzdG9yIiwiZ2V0TG93ZXN0Q29tbW9uQW5jZXN0b3IiLCJpbmRleE9mTG93ZXN0Q29tbW9uQW5jZXN0b3IiLCJpbmRleE9mIiwiaW5kZXgiLCJzbGljZSIsIm5vZGVQYXRoIiwiZmluZFdhbnRzUmVzcG9uZGVyIiwiYXR0ZW1wdFRyYW5zZmVyIiwiX2N1cnJlbnRSZXNwb25kZXIiLCJfZ2V0UmVzcG9uZGVyQ29uZmlnIiwib25SZXNwb25kZXJTdGFydCIsIm9uUmVzcG9uZGVyTW92ZSIsIm9uUmVzcG9uZGVyRW5kIiwib25SZXNwb25kZXJSZWxlYXNlIiwib25SZXNwb25kZXJUZXJtaW5hdGUiLCJvblJlc3BvbmRlclRlcm1pbmF0aW9uUmVxdWVzdCIsImNhbmNlbGFibGUiLCJjdXJyZW50VGFyZ2V0IiwiZGlzcGF0Y2hDb25maWciLCJyZWdpc3RyYXRpb25OYW1lIiwiaXNUZXJtaW5hdGVFdmVudCIsImlzQ2FuY2VsaXNoIiwid2luZG93IiwiY29udGFpbnMiLCJyZWxhdGVkVGFyZ2V0IiwiaGFzVmFsaWRTZWxlY3Rpb24iLCJpc1JlbGVhc2VFdmVudCIsImhhc1RhcmdldFRvdWNoZXMiLCJzaG91bGRUZXJtaW5hdGUiLCJzaG91bGRTZXRDYWxsYmFja3MiLCJzaG91bGRTZXRDYWxsYmFja0NhcHR1cmVOYW1lIiwic2hvdWxkU2V0Q2FsbGJhY2tCdWJibGVOYW1lIiwiY2hlY2siLCJjYWxsYmFja05hbWUiLCJzaG91bGRTZXRDYWxsYmFjayIsInBydW5lZElkUGF0aCIsImkiLCJyZXN1bHQiLCJpc1Byb3BhZ2F0aW9uU3RvcHBlZCIsIl9pIiwiX2lkIiwiX25vZGUiLCJfcmVzdWx0IiwiX2lkMiIsIl9ub2RlMiIsIl9jdXJyZW50UmVzcG9uZGVyMiIsImN1cnJlbnRJZCIsImN1cnJlbnROb2RlIiwiX2dldFJlc3BvbmRlckNvbmZpZzIiLCJvblJlc3BvbmRlckdyYW50Iiwib25SZXNwb25kZXJSZWplY3QiLCJfZ2V0UmVzcG9uZGVyQ29uZmlnMyIsImFsbG93VHJhbnNmZXIiLCJkb2N1bWVudEV2ZW50c0NhcHR1cmVQaGFzZSIsImRvY3VtZW50RXZlbnRzQnViYmxlUGhhc2UiLCJjYW5Vc2VET00iLCJfX3JlYWN0UmVzcG9uZGVyU3lzdGVtQWN0aXZlIiwiYWRkRXZlbnRMaXN0ZW5lciIsImZvckVhY2giLCJkb2N1bWVudCIsInNldFJlc3BvbmRlcklkIiwic2V0IiwiaGFzIiwiZGVsZXRlIiwiX2N1cnJlbnRSZXNwb25kZXIzIiwiX2dldFJlc3BvbmRlckNvbmZpZzQiLCJldmVudCJdLCJtYXBwaW5ncyI6IkFBQUE7O0FBRUFBLE9BQU8sQ0FBQ0MsVUFBUixHQUFxQixJQUFyQjtBQUNBRCxPQUFPLENBQUNFLGVBQVIsR0FBMEJBLGVBQTFCO0FBQ0FGLE9BQU8sQ0FBQ0csT0FBUixHQUFrQkEsT0FBbEI7QUFDQUgsT0FBTyxDQUFDSSxVQUFSLEdBQXFCQSxVQUFyQjtBQUNBSixPQUFPLENBQUNLLGtCQUFSLEdBQTZCQSxrQkFBN0I7QUFDQUwsT0FBTyxDQUFDTSxnQkFBUixHQUEyQkEsZ0JBQTNCOztBQUVBLElBQUlDLHFCQUFxQixHQUFHQyxPQUFPLENBQUMsK0JBQUQsQ0FBbkM7O0FBRUEsSUFBSUMscUJBQXFCLEdBQUdDLHNCQUFzQixDQUFDRixPQUFPLDBCQUFSLENBQWxEOztBQUVBLElBQUlHLG9CQUFvQixHQUFHSCxPQUFPLHlCQUFsQzs7QUFFQSxJQUFJSSxNQUFNLEdBQUdKLE9BQU8sV0FBcEI7O0FBRUEsSUFBSUssMkJBQTJCLEdBQUdILHNCQUFzQixDQUFDRixPQUFPLGdDQUFSLENB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R0FBRyxLQUF6QjtBQUNBQyxFQUFBQSxpQkFBaUIsR0FBRyxDQUFwQjtBQUNEOztBQU9ELFNBQVM1QixnQkFBVCxHQUE0QjtBQUMxQixTQUFPNkIsZ0JBQWdCLENBQUNMLElBQXhCO0FBQ0QiLCJzb3VyY2VzQ29udGVudCI6WyJcInVzZSBzdHJpY3RcIjtcblxuZXhwb3J0cy5fX2VzTW9kdWxlID0gdHJ1ZTtcbmV4cG9ydHMuYXR0YWNoTGlzdGVuZXJzID0gYXR0YWNoTGlzdGVuZXJzO1xuZXhwb3J0cy5hZGROb2RlID0gYWRkTm9kZTtcbmV4cG9ydHMucmVtb3ZlTm9kZSA9IHJlbW92ZU5vZGU7XG5leHBvcnRzLnRlcm1pbmF0ZVJlc3BvbmRlciA9IHRlcm1pbmF0ZVJlc3BvbmRlcjtcbmV4cG9ydHMuZ2V0UmVzcG9uZGVyTm9kZSA9IGdldFJlc3BvbmRlck5vZGU7XG5cbnZhciBfRXhlY3V0aW9uRW52aXJvbm1lbnQgPSByZXF1aXJlKFwiZmJqcy9saWIvRXhlY3V0aW9uRW52aXJvbm1lbnRcIik7XG5cbnZhciBfY3JlYXRlUmVzcG9uZGVyRXZlbnQgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KHJlcXVpcmUoXCIuL2NyZWF0ZVJlc3BvbmRlckV2ZW50XCIpKTtcblxudmFyIF9SZXNwb25kZXJFdmVudFR5cGVzID0gcmVxdWlyZShcIi4vUmVzcG9uZGVyRXZlbnRUeXBlc1wiKTtcblxudmFyIF91dGlscyA9IHJlcXVpcmUoXCIuL3V0aWxzXCIpO1xuXG52YXIgX1Jlc3BvbmRlclRvdWNoSGlzdG9yeVN0b3JlID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChyZXF1aXJlKFwiLi9SZXNwb25kZXJUb3VjaEhpc3RvcnlTdG9yZVwiKSk7XG5cbmZ1bmN0aW9uIF9pbnRlcm9wUmVxdWlyZURlZmF1bHQob2JqKSB7IHJldHVybiBvYmogJiYgb2JqLl9fZXNNb2R1bGUgPyBvYmogOiB7IGRlZmF1bHQ6IG9iaiB9OyB9XG5cbi8qKlxuICogQ29weXJpZ2h0IChjKSBOaWNvbGFzIEdhbGxhZ2hlclxuICpcbiAqIFRoaXMgc291cmNlIGNvZGUgaXMgbGljZW5zZWQgdW5kZXIgdGhlIE1JVCBsaWNlbnNlIGZvdW5kIGluIHRoZVxuICogTElDRU5TRSBmaWxlIGluIHRoZSByb290IGRpcmVjdG9yeSBvZiB0aGlzIHNvdXJjZSB0cmVlLlxuICpcbiAqIFxuICovXG5cbi8qKlxuICogUkVTUE9OREVSIEVWRU5UIFNZU1RFTVxuICpcbiAqIEEgc2luZ2xlLCBnbG9iYWwgXCJpbnRlcmFjdGlvbiBsb2NrXCIgb24gdmlld3MuIEZvciBhIHZpZXcgdG8gYmUgdGhlIFwicmVzcG9uZGVyXCIgbWVhbnNcbiAqIHRoYXQgcG9pbnRlciBpbnRlcmFjdGlvbnMgYXJlIGV4Y2x1c2l2ZSB0byB0aGF0IHZpZXcgYW5kIG5vbmUgb3RoZXIuIFRoZSBcImludGVyYWN0aW9uXG4gKiBsb2NrXCIgY2FuIGJlIHRyYW5zZmVycmVkIChvbmx5KSB0byBhbmNlc3RvcnMgb2YgdGhlIGN1cnJlbnQgXCJyZXNwb25kZXJcIiBhcyBsb25nIGFzXG4gKiBwb2ludGVycyBjb250aW51ZSB0byBiZSBhY3RpdmUuXG4gKlxuICogUmVzcG9uZGVyIGJlaW5nIGdyYW50ZWQ6XG4gKlxuICogQSB2aWV3IGNhbiBiZWNvbWUgdGhlIFwicmVzcG9uZGVyXCIgYWZ0ZXIgdGhlIGZvbGxvd2luZyBldmVudHM6XG4gKiAgKiBcInBvaW50ZXJkb3duXCIgKGltcGxlbWVudGVkIHVzaW5nIFwidG91Y2hzdGFydFwiLCBcIm1vdXNlZG93blwiKVxuICogICogXCJwb2ludGVybW92ZVwiIChpbXBsZW1lbnRlZCB1c2luZyBcInRvdWNobW92ZVwiLCBcIm1vdXNlbW92ZVwiKVxuICogICogXCJzY3JvbGxcIiAod2hpbGUgYSBwb2ludGVyIGlzIGRvd24pXG4gKiAgKiBcInNlbGVjdGlvbmNoYW5nZVwiICh3aGlsZSBhIHBvaW50ZXIgaXMgZG93bilcbiAqXG4gKiBJZiBub3RoaW5nIGlzIGFscmVhZHkgdGhlIFwicmVzcG9uZGVyXCIsIHRoZSBldmVudCBwcm9wYWdhdGVzIHRvIChjYXB0dXJlKSBhbmQgZnJvbVxuICogKGJ1YmJsZSkgdGhlIGV2ZW50IHRhcmdldCB1bnRpbCBhIHZpZXcgcmV0dXJucyBgdHJ1ZWAgZm9yXG4gKiBgb24qU2hvdWxkU2V0UmVzcG9uZGVyKENhcHR1cmUpYC5cbiAqXG4gKiBJZiBzb21ldGhpbmcgaXMgYWxyZWFkeSB0aGUgcmVzcG9uZGVyLCB0aGUgZXZlbnQgcHJvcGFnYXRlcyB0byAoY2FwdHVyZSkgYW5kIGZyb21cbiAqIChidWJibGUpIHRoZSBsb3dlc3QgY29tbW9uIGFuY2VzdG9yIG9mIHRoZSBldmVudCB0YXJnZXQgYW5kIHRoZSBjdXJyZW50IFwicmVzcG9uZGVyXCIuXG4gKiBUaGVuIG5lZ290aWF0aW9uIGhhcHBlbnMgYmV0d2VlbiB0aGUgY3VycmVudCBcInJlc3BvbmRlclwiIGFuZCBhIHZpZXcgdGhhdCB3YW50cyB0b1xuICogYmVjb21lIHRoZSBcInJlc3BvbmRlclwiOiBzZWUgdGhlIHRpbWluZyBkaWFncmFtIGJlbG93LlxuICpcbiAqIChOT1RFOiBTY3JvbGxlZCB2aWV3cyBlaXRoZXIgYXV0b21hdGljYWxseSBiZWNvbWUgdGhlIFwicmVzcG9uZGVyXCIgb3IgcmVsZWFzZSB0aGVcbiAqIFwiaW50ZXJhY3Rpb24gbG9ja1wiLiBBIG5hdGl2ZSBzY3JvbGwgdmlldyB0aGF0IGlzbid0IGJ1aWx0IG9uIHRvcCBvZiB0aGUgcmVzcG9uZGVyXG4gKiBzeXN0ZW0gbXVzdCByZXN1bHQgaW4gdGhlIGN1cnJlbnQgXCJyZXNwb25kZXJcIiBiZWluZyBub3RpZmllZCB0aGF0IGl0IG5vIGxvbmdlciBoYXNcbiAqIHRoZSBcImludGVyYWN0aW9uIGxvY2tcIiAtIHRoZSBuYXRpdmUgc3lzdGVtIGhhcyB0YWtlbiBvdmVyLlxuICpcbiAqIFJlc3BvbmRlciBiZWluZyByZWxlYXNlZDpcbiAqXG4gKiBBcyBzb29uIGFzIHRoZXJlIGFyZSBubyBtb3JlIGFjdGl2ZSBwb2ludGVycyB0aGF0ICpzdGFydGVkKiBpbnNpZGUgZGVzY2VuZGFudHNcbiAqIG9mIHRoZSAqY3VycmVudCogXCJyZXNwb25kZXJcIiwgYW4gYG9uUmVzcG9uZGVyUmVsZWFzZWAgZXZlbnQgaXMgZGlzcGF0Y2hlZCB0byB0aGVcbiAqIGN1cnJlbnQgXCJyZXNwb25kZXJcIiwgYW5kIHRoZSByZXNwb25kZXIgbG9jayBpcyByZWxlYXNlZC5cbiAqXG4gKiBUeXBpY2FsIHNlcXVlbmNlIG9mIGV2ZW50czpcbiAqICAqIHN0YXJ0U2hvdWxkU2V0UmVzcG9uZGVyXG4gKiAgKiByZXNwb25kZXJHcmFudC9SZWplY3RcbiAqICAqIHJlc3BvbmRlclN0YXJ0XG4gKiAgKiByZXNwb25kZXJNb3ZlXG4gKiAgKiByZXNwb25kZXJFbmRcbiAqICAqIHJlc3BvbmRlclJlbGVhc2VcbiAqL1xuXG4vKiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIE5lZ290aWF0aW9uIFBlcmZvcm1lZFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tK1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvICAgICAgICAgICAgICAgICAgICAgICAgIFxcXG5Qcm9jZXNzIGxvdyBsZXZlbCBldmVudHMgdG8gICAgKyAgICAgQ3VycmVudCBSZXNwb25kZXIgICAgICArICAgd2FudHNSZXNwb25kZXJJRFxuZGV0ZXJtaW5lIHdobyB0byBwZXJmb3JtIG5lZ290LXwgICAoaWYgYW55IGV4aXN0cyBhdCBhbGwpICAgfFxuaWF0aW9uL3RyYW5zaXRpb24gICAgICAgICAgICAgIHwgT3RoZXJ3aXNlIGp1c3QgcGFzcyB0aHJvdWdofFxuLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSstLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tKy0tLS0tLS0tLS0tLS0tLS0tLStcbkJ1YmJsZSB0byBmaW5kIGZpcnN0IElEICAgICAgICB8ICAgICAgICAgICAgICAgICAgICAgICAgICAgIHxcbnRvIHJldHVybiB0cnVlOndhbnRzUmVzcG9uZGVySUR8ICAgICAgICAgICAgICAgICAgICAgICAgICAgIHxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB8ICAgICAgICAgICAgICAgICAgICAgICAgICAgIHxcbiAgICAgKy0tLS0tLS0tLS0tLS0tKyAgICAgICAgICB8ICAgICAgICAgICAgICAgICAgICAgICAgICAgIHxcbiAgICAgfCBvblRvdWNoU3RhcnQgfCAgICAgICAgICB8ICAgICAgICAgICAgICAgICAgICAgICAgICAgIHxcbiAgICAgKy0tLS0tLSstLS0tLS0tKyAgICBub25lICB8ICAgICAgICAgICAgICAgICAgICAgICAgICAgIHxcbiAgICAgICAgICAgIHwgICAgICAgICAgICByZXR1cm58ICAgICAgICAgICAgICAgICAgICAgICAgICAgIHxcbistLS0tLS0tLS0tLXYtLS0tLS0tLS0tLS0tK3RydWV8ICstLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0rIHxcbnxvblN0YXJ0U2hvdWxkU2V0UmVzcG9uZGVyfC0tLS0tPnwgb25SZXNwb25kZXJTdGFydCAoY3VyKSB8PC0tLS0tLS0tLS0tK1xuKy0tLS0tLS0tLS0tKy0tLS0tLS0tLS0tLS0rICAgIHwgKy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSsgfCAgICAgICAgICB8XG4gICAgICAgICAgICB8ICAgICAgICAgICAgICAgICAgfCAgICAgICAgICAgICAgICAgICAgICAgICAgICB8ICstLS0tLS0tLSstLS0tLS0tK1xuICAgICAgICAgICAgfCByZXR1cm5lZCB0cnVlIGZvcnwgICAgICAgZmFsc2U6UkVKRUNUICstLS0tLS0tLT58b25SZXNwb25kZXJSZWplY3RcbiAgICAgICAgICAgIHwgd2FudHNSZXNwb25kZXJJRCB8ICAgICAgICAgICAgICAgICAgICB8ICAgICAgIHwgKy0tLS0tLS0tLS0tLS0tLS0rXG4gICAgICAgICAgICB8IChub3cgYXR0ZW1wdCAgICAgfCArLS0tLS0tLS0tLS0tLS0tLS0tKy0tLS0tKyB8XG4gICAgICAgICAgICB8ICBoYW5kb2ZmKSAgICAgICAgfCB8IG9uUmVzcG9uZGVyICAgICAgICAgICAgfCB8XG4gICAgICAgICAgICArLS0tLS0tLS0tLS0tLS0tLS0tLT58ICAgIFRlcm1pbmF0aW9uUmVxdWVzdCAgfCB8XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfCArLS0tLS0tLS0tLS0tLS0tLS0tKy0tLS0tKyB8XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfCAgICAgICAgICAgICAgICAgICAgfCAgICAgICB8ICstLS0tLS0tLS0tLS0tLS0tK1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHwgICAgICAgICB0cnVlOkdSQU5UICstLS0tLS0tLT58b25SZXNwb25kZXJHcmFudHxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB8ICAgICAgICAgICAgICAgICAgICAgICAgICAgIHwgKy0tLS0tLS0tKy0tLS0tLS0rXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfCArLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tKyB8ICAgICAgICAgIHxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB8IHwgb25SZXNwb25kZXJUZXJtaW5hdGUgICB8PC0tLS0tLS0tLS0tK1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHwgKy0tLS0tLS0tLS0tLS0tLS0tLSstLS0tLSsgfFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHwgICAgICAgICAgICAgICAgICAgIHwgICAgICAgfCArLS0tLS0tLS0tLS0tLS0tLStcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB8ICAgICAgICAgICAgICAgICAgICArLS0tLS0tLS0+fG9uUmVzcG9uZGVyU3RhcnR8XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfCAgICAgICAgICAgICAgICAgICAgICAgICAgICB8ICstLS0tLS0tLS0tLS0tLS0tK1xuQnViYmxlIHRvIGZpbmQgZmlyc3QgSUQgICAgICAgIHwgICAgICAgICAgICAgICAgICAgICAgICAgICAgfFxudG8gcmV0dXJuIHRydWU6d2FudHNSZXNwb25kZXJJRHwgICAgICAgICAgICAgICAgICAgICAgICAgICAgfFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHwgICAgICAgICAgICAgICAgICAgICAgICAgICAgfFxuICAgICArLS0tLS0tLS0tLS0tLSsgICAgICAgICAgIHwgICAgICAgICAgICAgICAgICAgICAgICAgICAgfFxuICAgICB8IG9uVG91Y2hNb3ZlIHwgICAgICAgICAgIHwgICAgICAgICAgICAgICAgICAgICAgICAgICAgfFxuICAgICArLS0tLS0tKy0tLS0tLSsgICAgIG5vbmUgIHwgICAgICAgICAgICAgICAgICAgICAgICAgICAgfFxuICAgICAgICAgICAgfCAgICAgICAgICAgIHJldHVybnwgICAgICAgICAgICAgICAgICAgICAgICAgICAgfFxuKy0tLS0tLS0tLS0tdi0tLS0tLS0tLS0tLS0rdHJ1ZXwgKy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSsgfFxufG9uTW92ZVNob3VsZFNldFJlc3BvbmRlciB8LS0tLS0+fCBvblJlc3BvbmRlck1vdmUgKGN1cikgIHw8LS0tLS0tLS0tLS0rXG4rLS0tLS0tLS0tLS0rLS0tLS0tLS0tLS0tLSsgICAgfCArLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tKyB8ICAgICAgICAgIHxcbiAgICAgICAgICAgIHwgICAgICAgICAgICAgICAgICB8ICAgICAgICAgICAgICAgICAgICAgICAgICAgIHwgKy0tLS0tLS0tKy0tLS0tLS0rXG4gICAgICAgICAgICB8IHJldHVybmVkIHRydWUgZm9yfCAgICAgICBmYWxzZTpSRUpFQ1QgKy0tLS0tLS0tPnxvblJlc3BvbmRlclJlamVjdFxuICAgICAgICAgICAgfCB3YW50c1Jlc3BvbmRlcklEIHwgICAgICAgICAgICAgICAgICAgIHwgICAgICAgfCArLS0tLS0tLS0tLS0tLS0tLStcbiAgICAgICAgICAgIHwgKG5vdyBhdHRlbXB0ICAgICB8ICstLS0tLS0tLS0tLS0tLS0tLS0rLS0tLS0rIHxcbiAgICAgICAgICAgIHwgIGhhbmRvZmYpICAgICAgICB8IHwgICBvblJlc3BvbmRlciAgICAgICAgICB8IHxcbiAgICAgICAgICAgICstLS0tLS0tLS0tLS0tLS0tLS0tPnwgICAgICBUZXJtaW5hdGlvblJlcXVlc3R8IHxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB8ICstLS0tLS0tLS0tLS0tLS0tLS0rLS0tLS0rIHxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB8ICAgICAgICAgICAgICAgICAgICB8ICAgICAgIHwgKy0tLS0tLS0tLS0tLS0tLS0rXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfCAgICAgICAgIHRydWU6R1JBTlQgKy0tLS0tLS0tPnxvblJlc3BvbmRlckdyYW50fFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHwgICAgICAgICAgICAgICAgICAgICAgICAgICAgfCArLS0tLS0tLS0rLS0tLS0tLStcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB8ICstLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0rIHwgICAgICAgICAgfFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHwgfCAgIG9uUmVzcG9uZGVyVGVybWluYXRlIHw8LS0tLS0tLS0tLS0rXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfCArLS0tLS0tLS0tLS0tLS0tLS0tKy0tLS0tKyB8XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfCAgICAgICAgICAgICAgICAgICAgfCAgICAgICB8ICstLS0tLS0tLS0tLS0tLS0tK1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHwgICAgICAgICAgICAgICAgICAgICstLS0tLS0tLT58b25SZXNwb25kZXJNb3ZlIHxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB8ICAgICAgICAgICAgICAgICAgICAgICAgICAgIHwgKy0tLS0tLS0tLS0tLS0tLS0rXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfCAgICAgICAgICAgICAgICAgICAgICAgICAgICB8XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfCAgICAgICAgICAgICAgICAgICAgICAgICAgICB8XG4gICAgICBTb21lIGFjdGl2ZSB0b3VjaCBzdGFydGVkfCAgICAgICAgICAgICAgICAgICAgICAgICAgICB8XG4gICAgICBpbnNpZGUgY3VycmVudCByZXNwb25kZXIgfCArLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tKyB8XG4gICAgICArLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLT58ICAgICAgb25SZXNwb25kZXJFbmQgICAgfCB8XG4gICAgICB8ICAgICAgICAgICAgICAgICAgICAgICAgfCArLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tKyB8XG4gICstLS0rLS0tLS0tLS0tKyAgICAgICAgICAgICAgfCAgICAgICAgICAgICAgICAgICAgICAgICAgICB8XG4gIHwgb25Ub3VjaEVuZCAgfCAgICAgICAgICAgICAgfCAgICAgICAgICAgICAgICAgICAgICAgICAgICB8XG4gICstLS0rLS0tLS0tLS0tKyAgICAgICAgICAgICAgfCAgICAgICAgICAgICAgICAgICAgICAgICAgICB8XG4gICAgICB8ICAgICAgICAgICAgICAgICAgICAgICAgfCArLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tKyB8XG4gICAgICArLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLT58ICAgICBvblJlc3BvbmRlckVuZCAgICAgfCB8XG4gICAgICBObyBhY3RpdmUgdG91Y2hlcyBzdGFydGVkfCArLS0tLS0tLS0tLS0rLS0tLS0tLS0tLS0tKyB8XG4gICAgICBpbnNpZGUgY3VycmVudCByZXNwb25kZXIgfCAgICAgICAgICAgICB8ICAgICAgICAgICAgICB8XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfCAgICAgICAgICAgICB2ICAgICAgICAgICAgICB8XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfCArLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tKyB8XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfCB8ICAgIG9uUmVzcG9uZGVyUmVsZWFzZSAgfCB8XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfCArLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tKyB8XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfCAgICAgICAgICAgICAgICAgICAgICAgICAgICB8XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKyAgICAgICAgICAgICAgICAgICAgICAgICAgICArICovXG52YXIgZW1wdHlPYmplY3QgPSB7fTtcbi8qIC0tLS0tLS0tLS0tLSBJTVBMRU1FTlRBVElPTiAtLS0tLS0tLS0tLS0gKi9cblxudmFyIHN0YXJ0UmVnaXN0cmF0aW9uID0gWydvblN0YXJ0U2hvdWxkU2V0UmVzcG9uZGVyQ2FwdHVyZScsICdvblN0YXJ0U2hvdWxkU2V0UmVzcG9uZGVyJywge1xuICBidWJibGVzOiB0cnVlXG59XTtcbnZhciBtb3ZlUmVnaXN0cmF0aW9uID0gWydvbk1vdmVTaG91bGRTZXRSZXNwb25kZXJDYXB0dXJlJywgJ29uTW92ZVNob3VsZFNldFJlc3BvbmRlcicsIHtcbiAgYnViYmxlczogdHJ1ZVxufV07XG52YXIgc2Nyb2xsUmVnaXN0cmF0aW9uID0gWydvblNjcm9sbFNob3VsZFNldFJlc3BvbmRlckNhcHR1cmUnLCAnb25TY3JvbGxTaG91bGRTZXRSZXNwb25kZXInLCB7XG4gIGJ1YmJsZXM6IGZhbHNlXG59XTtcbnZhciBzaG91bGRTZXRSZXNwb25kZXJFdmVudHMgPSB7XG4gIHRvdWNoc3RhcnQ6IHN0YXJ0UmVnaXN0cmF0aW9uLFxuICBtb3VzZWRvd246IHN0YXJ0UmVnaXN0cmF0aW9uLFxuICB0b3VjaG1vdmU6IG1vdmVSZWdpc3RyYXRpb24sXG4gIG1vdXNlbW92ZTogbW92ZVJlZ2lzdHJhdGlvbixcbiAgc2Nyb2xsOiBzY3JvbGxSZWdpc3RyYXRpb25cbn07XG52YXIgZW1wdHlSZXNwb25kZXIgPSB7XG4gIGlkOiBudWxsLFxuICBpZFBhdGg6IG51bGwsXG4gIG5vZGU6IG51bGxcbn07XG52YXIgcmVzcG9uZGVyTGlzdGVuZXJzTWFwID0gbmV3IE1hcCgpO1xudmFyIGlzRW11bGF0aW5nTW91c2VFdmVudHMgPSBmYWxzZTtcbnZhciB0cmFja2VkVG91Y2hDb3VudCA9IDA7XG52YXIgY3VycmVudFJlc3BvbmRlciA9IHtcbiAgaWQ6IG51bGwsXG4gIG5vZGU6IG51bGwsXG4gIGlkUGF0aDogbnVsbFxufTtcblxuZnVuY3Rpb24gY2hhbmdlQ3VycmVudFJlc3BvbmRlcihyZXNwb25kZXIpIHtcbiAgY3VycmVudFJlc3BvbmRlciA9IHJlc3BvbmRlcjtcbn1cblxuZnVuY3Rpb24gZ2V0UmVzcG9uZGVyQ29uZmlnKGlkKSB7XG4gIHZhciBjb25maWcgPSByZXNwb25kZXJMaXN0ZW5lcnNNYXAuZ2V0KGlkKTtcbiAgcmV0dXJuIGNvbmZpZyAhPSBudWxsID8gY29uZmlnIDogZW1wdHlPYmplY3Q7XG59XG4vKipcbiAqIFByb2Nlc3MgbmF0aXZlIGV2ZW50c1xuICpcbiAqIEEgc2luZ2xlIGV2ZW50IGxpc3RlbmVyIGlzIHVzZWQgdG8gbWFuYWdlIHRoZSByZXNwb25kZXIgc3lzdGVtLlxuICogQWxsIHBvaW50ZXJzIGFyZSB0cmFja2VkIGluIHRoZSBSZXNwb25kZXJUb3VjaEhpc3RvcnlTdG9yZS4gTmF0aXZlIGV2ZW50c1xuICogYXJlIGludGVycHJldGVkIGluIHRlcm1zIG9mIHRoZSBSZXNwb25kZXIgU3lzdGVtIGFuZCBjaGVja2VkIHRvIHNlZSBpZlxuICogdGhlIHJlc3BvbmRlciBzaG91bGQgYmUgdHJhbnNmZXJyZWQuIEVhY2ggaG9zdCBub2RlIHRoYXQgaXMgYXR0YWNoZWQgdG9cbiAqIHRoZSBSZXNwb25kZXIgU3lzdGVtIGhhcyBhbiBJRCwgd2hpY2ggaXMgdXNlZCB0byBsb29rIHVwIGl0cyBhc3NvY2lhdGVkXG4gKiBjYWxsYmFja3MuXG4gKi9cblxuXG5mdW5jdGlvbiBldmVudExpc3RlbmVyKGRvbUV2ZW50KSB7XG4gIHZhciBldmVudFR5cGUgPSBkb21FdmVudC50eXBlO1xuICB2YXIgZXZlbnRUYXJnZXQgPSBkb21FdmVudC50YXJnZXQ7XG4gIC8qKlxuICAgKiBNYW5hZ2UgZW11bGF0ZWQgZXZlbnRzIGFuZCBlYXJseSBiYWlsb3V0LlxuICAgKiBTaW5jZSBQb2ludGVyRXZlbnQgaXMgbm90IHVzZWQgeWV0IChsYWNrIG9mIHN1cHBvcnQgaW4gb2xkZXIgU2FmYXJpKSwgaXQnc1xuICAgKiBuZWNlc3NhcnkgdG8gbWFudWFsbHkgbWFuYWdlIHRoZSBtZXNzIG9mIGJyb3dzZXIgdG91Y2gvbW91c2UgZXZlbnRzLlxuICAgKiBBbmQgYmFpbG91dCBlYXJseSBmb3IgdGVybWluYXRpb24gZXZlbnRzIHdoZW4gdGhlcmUgaXMgbm8gYWN0aXZlIHJlc3BvbmRlci5cbiAgICovXG4gIC8vIEZsYWcgd2hlbiBicm93c2VyIG1heSBwcm9kdWNlIGVtdWxhdGVkIGV2ZW50c1xuXG4gIGlmIChldmVudFR5cGUgPT09ICd0b3VjaHN0YXJ0Jykge1xuICAgIGlzRW11bGF0aW5nTW91c2VFdmVudHMgPSB0cnVlO1xuICB9IC8vIFJlbW92ZSBmbGFnIHdoZW4gYnJvd3NlciB3aWxsIG5vdCBwcm9kdWNlIGVtdWxhdGVkIGV2ZW50c1xuXG5cbiAgaWYgKGV2ZW50VHlwZSA9PT0gJ3RvdWNobW92ZScgfHwgdHJhY2tlZFRvdWNoQ291bnQgPiAxKSB7XG4gICAgaXNFbXVsYXRpbmdNb3VzZUV2ZW50cyA9IGZhbHNlO1xuICB9IC8vIElnbm9yZSB2YXJpb3VzIGV2ZW50cyBpbiBwYXJ0aWN1bGFyIGNpcmN1bXN0YW5jZXNcblxuXG4gIGlmICggLy8gSWdub3JlIGJyb3dzZXIgZW11bGF0ZWQgbW91c2UgZXZlbnRzXG4gIGV2ZW50VHlwZSA9PT0gJ21vdXNlZG93bicgJiYgaXNFbXVsYXRpbmdNb3VzZUV2ZW50cyB8fCBldmVudFR5cGUgPT09ICdtb3VzZW1vdmUnICYmIGlzRW11bGF0aW5nTW91c2VFdmVudHMgfHwgLy8gSWdub3JlIG1vdXNlbW92ZSBpZiBhIG1vdXNlZG93biBkaWRuJ3Qgb2NjdXIgZmlyc3RcbiAgZXZlbnRUeXBlID09PSAnbW91c2Vtb3ZlJyAmJiB0cmFja2VkVG91Y2hDb3VudCA8IDEpIHtcbiAgICByZXR1cm47XG4gIH0gLy8gUmVtb3ZlIGZsYWcgYWZ0ZXIgZW11bGF0ZWQgZXZlbnRzIGFyZSBmaW5pc2hlZFxuXG5cbiAgaWYgKGlzRW11bGF0aW5nTW91c2VFdmVudHMgJiYgZXZlbnRUeXBlID09PSAnbW91c2V1cCcpIHtcbiAgICBpZiAodHJhY2tlZFRvdWNoQ291bnQgPT09IDApIHtcbiAgICAgIGlzRW11bGF0aW5nTW91c2VFdmVudHMgPSBmYWxzZTtcbiAgICB9XG5cbiAgICByZXR1cm47XG4gIH1cblxuICB2YXIgaXNTdGFydEV2ZW50ID0gKDAsIF9SZXNwb25kZXJFdmVudFR5cGVzLmlzU3RhcnRpc2gpKGV2ZW50VHlwZSkgJiYgKDAsIF91dGlscy5pc1ByaW1hcnlQb2ludGVyRG93bikoZG9tRXZlbnQpO1xuICB2YXIgaXNNb3ZlRXZlbnQgPSAoMCwgX1Jlc3BvbmRlckV2ZW50VHlwZXMuaXNNb3ZlaXNoKShldmVudFR5cGUpO1xuICB2YXIgaXNFbmRFdmVudCA9ICgwLCBfUmVzcG9uZGVyRXZlbnRUeXBlcy5pc0VuZGlzaCkoZXZlbnRUeXBlKTtcbiAgdmFyIGlzU2Nyb2xsRXZlbnQgPSAoMCwgX1Jlc3BvbmRlckV2ZW50VHlwZXMuaXNTY3JvbGwpKGV2ZW50VHlwZSk7XG4gIHZhciBpc1NlbGVjdGlvbkNoYW5nZUV2ZW50ID0gKDAsIF9SZXNwb25kZXJFdmVudFR5cGVzLmlzU2VsZWN0aW9uQ2hhbmdlKShldmVudFR5cGUpO1xuICB2YXIgcmVzcG9uZGVyRXZlbnQgPSAoMCwgX2NyZWF0ZVJlc3BvbmRlckV2ZW50LmRlZmF1bHQpKGRvbUV2ZW50KTtcbiAgLyoqXG4gICAqIFJlY29yZCB0aGUgc3RhdGUgb2YgYWN0aXZlIHBvaW50ZXJzXG4gICAqL1xuXG4gIGlmIChpc1N0YXJ0RXZlbnQgfHwgaXNNb3ZlRXZlbnQgfHwgaXNFbmRFdmVudCkge1xuICAgIGlmIChkb21FdmVudC50b3VjaGVzKSB7XG4gICAgICB0cmFja2VkVG91Y2hDb3VudCA9IGRvbUV2ZW50LnRvdWNoZXMubGVuZ3RoO1xuICAgIH0gZWxzZSB7XG4gICAgICBpZiAoaXNTdGFydEV2ZW50KSB7XG4gICAgICAgIHRyYWNrZWRUb3VjaENvdW50ID0gMTtcbiAgICAgIH0gZWxzZSBpZiAoaXNFbmRFdmVudCkge1xuICAgICAgICB0cmFja2VkVG91Y2hDb3VudCA9IDA7XG4gICAgICB9XG4gICAgfVxuXG4gICAgX1Jlc3BvbmRlclRvdWNoSGlzdG9yeVN0b3JlLmRlZmF1bHQucmVjb3JkVG91Y2hUcmFjayhldmVudFR5cGUsIHJlc3BvbmRlckV2ZW50Lm5hdGl2ZUV2ZW50KTtcbiAgfVxuICAvKipcbiAgICogUmVzcG9uZGVyIFN5c3RlbSBsb2dpY1xuICAgKi9cblxuXG4gIHZhciBldmVudFBhdGhzID0gKDAsIF91dGlscy5nZXRSZXNwb25kZXJQYXRocykoZG9tRXZlbnQpO1xuICB2YXIgd2FzTmVnb3RpYXRlZCA9IGZhbHNlO1xuICB2YXIgd2FudHNSZXNwb25kZXI7IC8vIElmIGFuIGV2ZW50IG9jY3VyZWQgdGhhdCBtaWdodCBjaGFuZ2UgdGhlIGN1cnJlbnQgcmVzcG9uZGVyLi4uXG5cbiAgaWYgKGlzU3RhcnRFdmVudCB8fCBpc01vdmVFdmVudCB8fCBpc1Njcm9sbEV2ZW50ICYmIHRyYWNrZWRUb3VjaENvdW50ID4gMCkge1xuICAgIC8vIElmIHRoZXJlIGlzIGFscmVhZHkgYSByZXNwb25kZXIsIHBydW5lIHRoZSBldmVudCBwYXRocyB0byB0aGUgbG93ZXN0IGNvbW1vbiBhbmNlc3RvclxuICAgIC8vIG9mIHRoZSBleGlzdGluZyByZXNwb25kZXIgYW5kIGRlZXBlc3QgdGFyZ2V0IG9mIHRoZSBldmVudC5cbiAgICB2YXIgY3VycmVudFJlc3BvbmRlcklkUGF0aCA9IGN1cnJlbnRSZXNwb25kZXIuaWRQYXRoO1xuICAgIHZhciBldmVudElkUGF0aCA9IGV2ZW50UGF0aHMuaWRQYXRoO1xuXG4gICAgaWYgKGN1cnJlbnRSZXNwb25kZXJJZFBhdGggIT0gbnVsbCAmJiBldmVudElkUGF0aCAhPSBudWxsKSB7XG4gICAgICB2YXIgbG93ZXN0Q29tbW9uQW5jZXN0b3IgPSAoMCwgX3V0aWxzLmdldExvd2VzdENvbW1vbkFuY2VzdG9yKShjdXJyZW50UmVzcG9uZGVySWRQYXRoLCBldmVudElkUGF0aCk7XG5cbiAgICAgIGlmIChsb3dlc3RDb21tb25BbmNlc3RvciAhPSBudWxsKSB7XG4gICAgICAgIHZhciBpbmRleE9mTG93ZXN0Q29tbW9uQW5jZXN0b3IgPSBldmVudElkUGF0aC5pbmRleE9mKGxvd2VzdENvbW1vbkFuY2VzdG9yKTsgLy8gU2tpcCB0aGUgY3VycmVudCByZXNwb25kZXIgc28gaXQgZG9lc24ndCByZWNlaXZlIHVuZXhwZWN0ZWQgXCJzaG91bGRTZXRcIiBldmVudHMuXG5cbiAgICAgICAgdmFyIGluZGV4ID0gaW5kZXhPZkxvd2VzdENvbW1vbkFuY2VzdG9yICsgKGxvd2VzdENvbW1vbkFuY2VzdG9yID09PSBjdXJyZW50UmVzcG9uZGVyLmlkID8gMSA6IDApO1xuICAgICAgICBldmVudFBhdGhzID0ge1xuICAgICAgICAgIGlkUGF0aDogZXZlbnRJZFBhdGguc2xpY2UoaW5kZXgpLFxuICAgICAgICAgIG5vZGVQYXRoOiBldmVudFBhdGhzLm5vZGVQYXRoLnNsaWNlKGluZGV4KVxuICAgICAgICB9O1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgZXZlbnRQYXRocyA9IG51bGw7XG4gICAgICB9XG4gICAgfVxuXG4gICAgaWYgKGV2ZW50UGF0aHMgIT0gbnVsbCkge1xuICAgICAgLy8gSWYgYSBub2RlIHdhbnRzIHRvIGJlY29tZSB0aGUgcmVzcG9uZGVyLCBhdHRlbXB0IHRvIHRyYW5zZmVyLlxuICAgICAgd2FudHNSZXNwb25kZXIgPSBmaW5kV2FudHNSZXNwb25kZXIoZXZlbnRQYXRocywgZG9tRXZlbnQsIHJlc3BvbmRlckV2ZW50KTtcblxuICAgICAgaWYgKHdhbnRzUmVzcG9uZGVyICE9IG51bGwpIHtcbiAgICAgICAgLy8gU2V0cyByZXNwb25kZXIgaWYgbm9uZSBleGlzdHMsIG9yIG5lZ290YXRlcyB3aXRoIGV4aXN0aW5nIHJlc3BvbmRlci5cbiAgICAgICAgYXR0ZW1wdFRyYW5zZmVyKHJlc3BvbmRlckV2ZW50LCB3YW50c1Jlc3BvbmRlcik7XG4gICAgICAgIHdhc05lZ290aWF0ZWQgPSB0cnVlO1xuICAgICAgfVxuICAgIH1cbiAgfSAvLyBJZiB0aGVyZSBpcyBub3cgYSByZXNwb25kZXIsIGludm9rZSBpdHMgY2FsbGJhY2tzIGZvciB0aGUgbGlmZWN5Y2xlIG9mIHRoZSBnZXN0dXJlLlxuXG5cbiAgaWYgKGN1cnJlbnRSZXNwb25kZXIuaWQgIT0gbnVsbCAmJiBjdXJyZW50UmVzcG9uZGVyLm5vZGUgIT0gbnVsbCkge1xuICAgIHZhciBfY3VycmVudFJlc3BvbmRlciA9IGN1cnJlbnRSZXNwb25kZXIsXG4gICAgICAgIGlkID0gX2N1cnJlbnRSZXNwb25kZXIuaWQsXG4gICAgICAgIG5vZGUgPSBfY3VycmVudFJlc3BvbmRlci5ub2RlO1xuXG4gICAgdmFyIF9nZXRSZXNwb25kZXJDb25maWcgPSBnZXRSZXNwb25kZXJDb25maWcoaWQpLFxuICAgICAgICBvblJlc3BvbmRlclN0YXJ0ID0gX2dldFJlc3BvbmRlckNvbmZpZy5vblJlc3BvbmRlclN0YXJ0LFxuICAgICAgICBvblJlc3BvbmRlck1vdmUgPSBfZ2V0UmVzcG9uZGVyQ29uZmlnLm9uUmVzcG9uZGVyTW92ZSxcbiAgICAgICAgb25SZXNwb25kZXJFbmQgPSBfZ2V0UmVzcG9uZGVyQ29uZmlnLm9uUmVzcG9uZGVyRW5kLFxuICAgICAgICBvblJlc3BvbmRlclJlbGVhc2UgPSBfZ2V0UmVzcG9uZGVyQ29uZmlnLm9uUmVzcG9uZGVyUmVsZWFzZSxcbiAgICAgICAgb25SZXNwb25kZXJUZXJtaW5hdGUgPSBfZ2V0UmVzcG9uZGVyQ29uZmlnLm9uUmVzcG9uZGVyVGVybWluYXRlLFxuICAgICAgICBvblJlc3BvbmRlclRlcm1pbmF0aW9uUmVxdWVzdCA9IF9nZXRSZXNwb25kZXJDb25maWcub25SZXNwb25kZXJUZXJtaW5hdGlvblJlcXVlc3Q7XG5cbiAgICByZXNwb25kZXJFdmVudC5idWJibGVzID0gZmFsc2U7XG4gICAgcmVzcG9uZGVyRXZlbnQuY2FuY2VsYWJsZSA9IGZhbHNlO1xuICAgIHJlc3BvbmRlckV2ZW50LmN1cnJlbnRUYXJnZXQgPSBub2RlOyAvLyBTdGFydFxuXG4gICAgaWYgKGlzU3RhcnRFdmVudCkge1xuICAgICAgaWYgKG9uUmVzcG9uZGVyU3RhcnQgIT0gbnVsbCkge1xuICAgICAgICByZXNwb25kZXJFdmVudC5kaXNwYXRjaENvbmZpZy5yZWdpc3RyYXRpb25OYW1lID0gJ29uUmVzcG9uZGVyU3RhcnQnO1xuICAgICAgICBvblJlc3BvbmRlclN0YXJ0KHJlc3BvbmRlckV2ZW50KTtcbiAgICAgIH1cbiAgICB9IC8vIE1vdmVcbiAgICBlbHNlIGlmIChpc01vdmVFdmVudCkge1xuICAgICAgICBpZiAob25SZXNwb25kZXJNb3ZlICE9IG51bGwpIHtcbiAgICAgICAgICByZXNwb25kZXJFdmVudC5kaXNwYXRjaENvbmZpZy5yZWdpc3RyYXRpb25OYW1lID0gJ29uUmVzcG9uZGVyTW92ZSc7XG4gICAgICAgICAgb25SZXNwb25kZXJNb3ZlKHJlc3BvbmRlckV2ZW50KTtcbiAgICAgICAgfVxuICAgICAgfSBlbHNlIHtcbiAgICAgICAgdmFyIGlzVGVybWluYXRlRXZlbnQgPSAoMCwgX1Jlc3BvbmRlckV2ZW50VHlwZXMuaXNDYW5jZWxpc2gpKGV2ZW50VHlwZSkgfHwgLy8gbmF0aXZlIGNvbnRleHQgbWVudVxuICAgICAgICBldmVudFR5cGUgPT09ICdjb250ZXh0bWVudScgfHwgLy8gd2luZG93IGJsdXJcbiAgICAgICAgZXZlbnRUeXBlID09PSAnYmx1cicgJiYgZXZlbnRUYXJnZXQgPT09IHdpbmRvdyB8fCAvLyByZXNwb25kZXIgKG9yIGFuY2VzdG9ycykgYmx1clxuICAgICAgICBldmVudFR5cGUgPT09ICdibHVyJyAmJiBldmVudFRhcmdldC5jb250YWlucyhub2RlKSAmJiBkb21FdmVudC5yZWxhdGVkVGFyZ2V0ICE9PSBub2RlIHx8IC8vIG5hdGl2ZSBzY3JvbGwgd2l0aG91dCB1c2luZyBhIHBvaW50ZXJcbiAgICAgICAgaXNTY3JvbGxFdmVudCAmJiB0cmFja2VkVG91Y2hDb3VudCA9PT0gMCB8fCAvLyBuYXRpdmUgc2Nyb2xsIG9uIG5vZGUgdGhhdCBpcyBwYXJlbnQgb2YgdGhlIHJlc3BvbmRlciAoYWxsb3cgc2libGluZ3MgdG8gc2Nyb2xsKVxuICAgICAgICBpc1Njcm9sbEV2ZW50ICYmIGV2ZW50VGFyZ2V0LmNvbnRhaW5zKG5vZGUpICYmIGV2ZW50VGFyZ2V0ICE9PSBub2RlIHx8IC8vIG5hdGl2ZSBzZWxlY3Qvc2VsZWN0aW9uY2hhbmdlIG9uIG5vZGVcbiAgICAgICAgaXNTZWxlY3Rpb25DaGFuZ2VFdmVudCAmJiAoMCwgX3V0aWxzLmhhc1ZhbGlkU2VsZWN0aW9uKShkb21FdmVudCk7XG4gICAgICAgIHZhciBpc1JlbGVhc2VFdmVudCA9IGlzRW5kRXZlbnQgJiYgIWlzVGVybWluYXRlRXZlbnQgJiYgISgwLCBfdXRpbHMuaGFzVGFyZ2V0VG91Y2hlcykobm9kZSwgZG9tRXZlbnQudG91Y2hlcyk7IC8vIEVuZFxuXG4gICAgICAgIGlmIChpc0VuZEV2ZW50KSB7XG4gICAgICAgICAgaWYgKG9uUmVzcG9uZGVyRW5kICE9IG51bGwpIHtcbiAgICAgICAgICAgIHJlc3BvbmRlckV2ZW50LmRpc3BhdGNoQ29uZmlnLnJlZ2lzdHJhdGlvbk5hbWUgPSAnb25SZXNwb25kZXJFbmQnO1xuICAgICAgICAgICAgb25SZXNwb25kZXJFbmQocmVzcG9uZGVyRXZlbnQpO1xuICAgICAgICAgIH1cbiAgICAgICAgfSAvLyBSZWxlYXNlXG5cblxuICAgICAgICBpZiAoaXNSZWxlYXNlRXZlbnQpIHtcbiAgICAgICAgICBpZiAob25SZXNwb25kZXJSZWxlYXNlICE9IG51bGwpIHtcbiAgICAgICAgICAgIHJlc3BvbmRlckV2ZW50LmRpc3BhdGNoQ29uZmlnLnJlZ2lzdHJhdGlvbk5hbWUgPSAnb25SZXNwb25kZXJSZWxlYXNlJztcbiAgICAgICAgICAgIG9uUmVzcG9uZGVyUmVsZWFzZShyZXNwb25kZXJFdmVudCk7XG4gICAgICAgICAgfVxuXG4gICAgICAgICAgY2hhbmdlQ3VycmVudFJlc3BvbmRlcihlbXB0eVJlc3BvbmRlcik7XG4gICAgICAgIH0gLy8gVGVybWluYXRlXG5cblxuICAgICAgICBpZiAoaXNUZXJtaW5hdGVFdmVudCkge1xuICAgICAgICAgIHZhciBzaG91bGRUZXJtaW5hdGUgPSB0cnVlOyAvLyBSZXNwb25kZXJzIGNhbiBzdGlsbCBhdm9pZCB0ZXJtaW5hdGlvbiBidXQgb25seSBmb3IgdGhlc2UgZXZlbnRzLlxuXG4gICAgICAgICAgaWYgKGV2ZW50VHlwZSA9PT0gJ2NvbnRleHRtZW51JyB8fCBldmVudFR5cGUgPT09ICdzY3JvbGwnIHx8IGV2ZW50VHlwZSA9PT0gJ3NlbGVjdGlvbmNoYW5nZScpIHtcbiAgICAgICAgICAgIC8vIE9ubHkgY2FsbCB0aGlzIGZ1bmN0aW9uIGlzIGl0IHdhc24ndCBhbHJlYWR5IGNhbGxlZCBkdXJpbmcgbmVnb3RpYXRpb24uXG4gICAgICAgICAgICBpZiAod2FzTmVnb3RpYXRlZCkge1xuICAgICAgICAgICAgICBzaG91bGRUZXJtaW5hdGUgPSBmYWxzZTtcbiAgICAgICAgICAgIH0gZWxzZSBpZiAob25SZXNwb25kZXJUZXJtaW5hdGlvblJlcXVlc3QgIT0gbnVsbCkge1xuICAgICAgICAgICAgICByZXNwb25kZXJFdmVudC5kaXNwYXRjaENvbmZpZy5yZWdpc3RyYXRpb25OYW1lID0gJ29uUmVzcG9uZGVyVGVybWluYXRpb25SZXF1ZXN0JztcblxuICAgICAgICAgICAgICBpZiAob25SZXNwb25kZXJUZXJtaW5hdGlvblJlcXVlc3QocmVzcG9uZGVyRXZlbnQpID09PSBmYWxzZSkge1xuICAgICAgICAgICAgICAgIHNob3VsZFRlcm1pbmF0ZSA9IGZhbHNlO1xuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfVxuXG4gICAgICAgICAgaWYgKHNob3VsZFRlcm1pbmF0ZSkge1xuICAgICAgICAgICAgaWYgKG9uUmVzcG9uZGVyVGVybWluYXRlICE9IG51bGwpIHtcbiAgICAgICAgICAgICAgcmVzcG9uZGVyRXZlbnQuZGlzcGF0Y2hDb25maWcucmVnaXN0cmF0aW9uTmFtZSA9ICdvblJlc3BvbmRlclRlcm1pbmF0ZSc7XG4gICAgICAgICAgICAgIG9uUmVzcG9uZGVyVGVybWluYXRlKHJlc3BvbmRlckV2ZW50KTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgY2hhbmdlQ3VycmVudFJlc3BvbmRlcihlbXB0eVJlc3BvbmRlcik7XG4gICAgICAgICAgICBpc0VtdWxhdGluZ01vdXNlRXZlbnRzID0gZmFsc2U7XG4gICAgICAgICAgICB0cmFja2VkVG91Y2hDb3VudCA9IDA7XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICB9XG4gIH1cbn1cbi8qKlxuICogV2FsayB0aGUgZXZlbnQgcGF0aCB0by9mcm9tIHRoZSB0YXJnZXQgbm9kZS4gQXQgZWFjaCBub2RlLCBzdG9wIGFuZCBjYWxsIHRoZVxuICogcmVsZXZhbnQgXCJzaG91bGRTZXRcIiBmdW5jdGlvbnMgZm9yIHRoZSBnaXZlbiBldmVudCB0eXBlLiBJZiBhbnkgb2YgdGhvc2UgZnVuY3Rpb25zXG4gKiBjYWxsIFwic3RvcFByb3BhZ2F0aW9uXCIgb24gdGhlIGV2ZW50LCBzdG9wIHNlYXJjaGluZyBmb3IgYSByZXNwb25kZXIuXG4gKi9cblxuXG5mdW5jdGlvbiBmaW5kV2FudHNSZXNwb25kZXIoZXZlbnRQYXRocywgZG9tRXZlbnQsIHJlc3BvbmRlckV2ZW50KSB7XG4gIHZhciBzaG91bGRTZXRDYWxsYmFja3MgPSBzaG91bGRTZXRSZXNwb25kZXJFdmVudHNbZG9tRXZlbnQudHlwZV07IC8vIGZvciBGbG93XG5cbiAgaWYgKHNob3VsZFNldENhbGxiYWNrcyAhPSBudWxsKSB7XG4gICAgdmFyIGlkUGF0aCA9IGV2ZW50UGF0aHMuaWRQYXRoLFxuICAgICAgICBub2RlUGF0aCA9IGV2ZW50UGF0aHMubm9kZVBhdGg7XG4gICAgdmFyIHNob3VsZFNldENhbGxiYWNrQ2FwdHVyZU5hbWUgPSBzaG91bGRTZXRDYWxsYmFja3NbMF07XG4gICAgdmFyIHNob3VsZFNldENhbGxiYWNrQnViYmxlTmFtZSA9IHNob3VsZFNldENhbGxiYWNrc1sxXTtcbiAgICB2YXIgYnViYmxlcyA9IHNob3VsZFNldENhbGxiYWNrc1syXS5idWJibGVzO1xuXG4gICAgdmFyIGNoZWNrID0gZnVuY3Rpb24gY2hlY2soaWQsIG5vZGUsIGNhbGxiYWNrTmFtZSkge1xuICAgICAgdmFyIGNvbmZpZyA9IGdldFJlc3BvbmRlckNvbmZpZyhpZCk7XG4gICAgICB2YXIgc2hvdWxkU2V0Q2FsbGJhY2sgPSBjb25maWdbY2FsbGJhY2tOYW1lXTtcblxuICAgICAgaWYgKHNob3VsZFNldENhbGxiYWNrICE9IG51bGwpIHtcbiAgICAgICAgcmVzcG9uZGVyRXZlbnQuY3VycmVudFRhcmdldCA9IG5vZGU7XG5cbiAgICAgICAgaWYgKHNob3VsZFNldENhbGxiYWNrKHJlc3BvbmRlckV2ZW50KSA9PT0gdHJ1ZSkge1xuICAgICAgICAgIC8vIFN0YXJ0IHRoZSBwYXRoIGZyb20gdGhlIHBvdGVudGlhbCByZXNwb25kZXJcbiAgICAgICAgICB2YXIgcHJ1bmVkSWRQYXRoID0gaWRQYXRoLnNsaWNlKGlkUGF0aC5pbmRleE9mKGlkKSk7XG4gICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgIGlkOiBpZCxcbiAgICAgICAgICAgIG5vZGU6IG5vZGUsXG4gICAgICAgICAgICBpZFBhdGg6IHBydW5lZElkUGF0aFxuICAgICAgICAgIH07XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9OyAvLyBjYXB0dXJlXG5cblxuICAgIGZvciAodmFyIGkgPSBpZFBhdGgubGVuZ3RoIC0gMTsgaSA+PSAwOyBpLS0pIHtcbiAgICAgIHZhciBpZCA9IGlkUGF0aFtpXTtcbiAgICAgIHZhciBub2RlID0gbm9kZVBhdGhbaV07XG4gICAgICB2YXIgcmVzdWx0ID0gY2hlY2soaWQsIG5vZGUsIHNob3VsZFNldENhbGxiYWNrQ2FwdHVyZU5hbWUpO1xuXG4gICAgICBpZiAocmVzdWx0ICE9IG51bGwpIHtcbiAgICAgICAgcmV0dXJuIHJlc3VsdDtcbiAgICAgIH1cblxuICAgICAgaWYgKHJlc3BvbmRlckV2ZW50LmlzUHJvcGFnYXRpb25TdG9wcGVkKCkgPT09IHRydWUpIHtcbiAgICAgICAgcmV0dXJuO1xuICAgICAgfVxuICAgIH0gLy8gYnViYmxlXG5cblxuICAgIGlmIChidWJibGVzKSB7XG4gICAgICBmb3IgKHZhciBfaSA9IDA7IF9pIDwgaWRQYXRoLmxlbmd0aDsgX2krKykge1xuICAgICAgICB2YXIgX2lkID0gaWRQYXRoW19pXTtcbiAgICAgICAgdmFyIF9ub2RlID0gbm9kZVBhdGhbX2ldO1xuXG4gICAgICAgIHZhciBfcmVzdWx0ID0gY2hlY2soX2lkLCBfbm9kZSwgc2hvdWxkU2V0Q2FsbGJhY2tCdWJibGVOYW1lKTtcblxuICAgICAgICBpZiAoX3Jlc3VsdCAhPSBudWxsKSB7XG4gICAgICAgICAgcmV0dXJuIF9yZXN1bHQ7XG4gICAgICAgIH1cblxuICAgICAgICBpZiAocmVzcG9uZGVyRXZlbnQuaXNQcm9wYWdhdGlvblN0b3BwZWQoKSA9PT0gdHJ1ZSkge1xuICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH0gZWxzZSB7XG4gICAgICB2YXIgX2lkMiA9IGlkUGF0aFswXTtcbiAgICAgIHZhciBfbm9kZTIgPSBub2RlUGF0aFswXTtcbiAgICAgIHZhciB0YXJnZXQgPSBkb21FdmVudC50YXJnZXQ7XG5cbiAgICAgIGlmICh0YXJnZXQgPT09IF9ub2RlMikge1xuICAgICAgICByZXR1cm4gY2hlY2soX2lkMiwgX25vZGUyLCBzaG91bGRTZXRDYWxsYmFja0J1YmJsZU5hbWUpO1xuICAgICAgfVxuICAgIH1cbiAgfVxufVxuLyoqXG4gKiBBdHRlbXB0IHRvIHRyYW5zZmVyIHRoZSByZXNwb25kZXIuXG4gKi9cblxuXG5mdW5jdGlvbiBhdHRlbXB0VHJhbnNmZXIocmVzcG9uZGVyRXZlbnQsIHdhbnRzUmVzcG9uZGVyKSB7XG4gIHZhciBfY3VycmVudFJlc3BvbmRlcjIgPSBjdXJyZW50UmVzcG9uZGVyLFxuICAgICAgY3VycmVudElkID0gX2N1cnJlbnRSZXNwb25kZXIyLmlkLFxuICAgICAgY3VycmVudE5vZGUgPSBfY3VycmVudFJlc3BvbmRlcjIubm9kZTtcbiAgdmFyIGlkID0gd2FudHNSZXNwb25kZXIuaWQsXG4gICAgICBub2RlID0gd2FudHNSZXNwb25kZXIubm9kZTtcblxuICB2YXIgX2dldFJlc3BvbmRlckNvbmZpZzIgPSBnZXRSZXNwb25kZXJDb25maWcoaWQpLFxuICAgICAgb25SZXNwb25kZXJHcmFudCA9IF9nZXRSZXNwb25kZXJDb25maWcyLm9uUmVzcG9uZGVyR3JhbnQsXG4gICAgICBvblJlc3BvbmRlclJlamVjdCA9IF9nZXRSZXNwb25kZXJDb25maWcyLm9uUmVzcG9uZGVyUmVqZWN0O1xuXG4gIHJlc3BvbmRlckV2ZW50LmJ1YmJsZXMgPSBmYWxzZTtcbiAgcmVzcG9uZGVyRXZlbnQuY2FuY2VsYWJsZSA9IGZhbHNlO1xuICByZXNwb25kZXJFdmVudC5jdXJyZW50VGFyZ2V0ID0gbm9kZTsgLy8gU2V0IHJlc3BvbmRlclxuXG4gIGlmIChjdXJyZW50SWQgPT0gbnVsbCkge1xuICAgIGlmIChvblJlc3BvbmRlckdyYW50ICE9IG51bGwpIHtcbiAgICAgIHJlc3BvbmRlckV2ZW50LmN1cnJlbnRUYXJnZXQgPSBub2RlO1xuICAgICAgcmVzcG9uZGVyRXZlbnQuZGlzcGF0Y2hDb25maWcucmVnaXN0cmF0aW9uTmFtZSA9ICdvblJlc3BvbmRlckdyYW50JztcbiAgICAgIG9uUmVzcG9uZGVyR3JhbnQocmVzcG9uZGVyRXZlbnQpO1xuICAgIH1cblxuICAgIGNoYW5nZUN1cnJlbnRSZXNwb25kZXIod2FudHNSZXNwb25kZXIpO1xuICB9IC8vIE5lZ290aWF0ZSB3aXRoIGN1cnJlbnQgcmVzcG9uZGVyXG4gIGVsc2Uge1xuICAgICAgdmFyIF9nZXRSZXNwb25kZXJDb25maWczID0gZ2V0UmVzcG9uZGVyQ29uZmlnKGN1cnJlbnRJZCksXG4gICAgICAgICAgb25SZXNwb25kZXJUZXJtaW5hdGUgPSBfZ2V0UmVzcG9uZGVyQ29uZmlnMy5vblJlc3BvbmRlclRlcm1pbmF0ZSxcbiAgICAgICAgICBvblJlc3BvbmRlclRlcm1pbmF0aW9uUmVxdWVzdCA9IF9nZXRSZXNwb25kZXJDb25maWczLm9uUmVzcG9uZGVyVGVybWluYXRpb25SZXF1ZXN0O1xuXG4gICAgICB2YXIgYWxsb3dUcmFuc2ZlciA9IHRydWU7XG5cbiAgICAgIGlmIChvblJlc3BvbmRlclRlcm1pbmF0aW9uUmVxdWVzdCAhPSBudWxsKSB7XG4gICAgICAgIHJlc3BvbmRlckV2ZW50LmN1cnJlbnRUYXJnZXQgPSBjdXJyZW50Tm9kZTtcbiAgICAgICAgcmVzcG9uZGVyRXZlbnQuZGlzcGF0Y2hDb25maWcucmVnaXN0cmF0aW9uTmFtZSA9ICdvblJlc3BvbmRlclRlcm1pbmF0aW9uUmVxdWVzdCc7XG5cbiAgICAgICAgaWYgKG9uUmVzcG9uZGVyVGVybWluYXRpb25SZXF1ZXN0KHJlc3BvbmRlckV2ZW50KSA9PT0gZmFsc2UpIHtcbiAgICAgICAgICBhbGxvd1RyYW5zZmVyID0gZmFsc2U7XG4gICAgICAgIH1cbiAgICAgIH1cblxuICAgICAgaWYgKGFsbG93VHJhbnNmZXIpIHtcbiAgICAgICAgLy8gVGVybWluYXRlIGV4aXN0aW5nIHJlc3BvbmRlclxuICAgICAgICBpZiAob25SZXNwb25kZXJUZXJtaW5hdGUgIT0gbnVsbCkge1xuICAgICAgICAgIHJlc3BvbmRlckV2ZW50LmN1cnJlbnRUYXJnZXQgPSBjdXJyZW50Tm9kZTtcbiAgICAgICAgICByZXNwb25kZXJFdmVudC5kaXNwYXRjaENvbmZpZy5yZWdpc3RyYXRpb25OYW1lID0gJ29uUmVzcG9uZGVyVGVybWluYXRlJztcbiAgICAgICAgICBvblJlc3BvbmRlclRlcm1pbmF0ZShyZXNwb25kZXJFdmVudCk7XG4gICAgICAgIH0gLy8gR3JhbnQgbmV4dCByZXNwb25kZXJcblxuXG4gICAgICAgIGlmIChvblJlc3BvbmRlckdyYW50ICE9IG51bGwpIHtcbiAgICAgICAgICByZXNwb25kZXJFdmVudC5jdXJyZW50VGFyZ2V0ID0gbm9kZTtcbiAgICAgICAgICByZXNwb25kZXJFdmVudC5kaXNwYXRjaENvbmZpZy5yZWdpc3RyYXRpb25OYW1lID0gJ29uUmVzcG9uZGVyR3JhbnQnO1xuICAgICAgICAgIG9uUmVzcG9uZGVyR3JhbnQocmVzcG9uZGVyRXZlbnQpO1xuICAgICAgICB9XG5cbiAgICAgICAgY2hhbmdlQ3VycmVudFJlc3BvbmRlcih3YW50c1Jlc3BvbmRlcik7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICAvLyBSZWplY3QgcmVzcG9uZGVyIHJlcXVlc3RcbiAgICAgICAgaWYgKG9uUmVzcG9uZGVyUmVqZWN0ICE9IG51bGwpIHtcbiAgICAgICAgICByZXNwb25kZXJFdmVudC5jdXJyZW50VGFyZ2V0ID0gbm9kZTtcbiAgICAgICAgICByZXNwb25kZXJFdmVudC5kaXNwYXRjaENvbmZpZy5yZWdpc3RyYXRpb25OYW1lID0gJ29uUmVzcG9uZGVyUmVqZWN0JztcbiAgICAgICAgICBvblJlc3BvbmRlclJlamVjdChyZXNwb25kZXJFdmVudCk7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9XG59XG4vKiAtLS0tLS0tLS0tLS0gUFVCTElDIEFQSSAtLS0tLS0tLS0tLS0gKi9cblxuLyoqXG4gKiBBdHRhY2ggTGlzdGVuZXJzXG4gKlxuICogVXNlIG5hdGl2ZSBldmVudHMgYXMgUmVhY3RET00gZG9lc24ndCBoYXZlIGEgbm9uLXBsdWdpbiBBUEkgdG8gaW1wbGVtZW50XG4gKiB0aGlzIHN5c3RlbS5cbiAqL1xuXG5cbnZhciBkb2N1bWVudEV2ZW50c0NhcHR1cmVQaGFzZSA9IFsnYmx1cicsICdzY3JvbGwnXTtcbnZhciBkb2N1bWVudEV2ZW50c0J1YmJsZVBoYXNlID0gWy8vIG1vdXNlXG4nbW91c2Vkb3duJywgJ21vdXNlbW92ZScsICdtb3VzZXVwJywgJ2RyYWdzdGFydCcsIC8vIHRvdWNoXG4ndG91Y2hzdGFydCcsICd0b3VjaG1vdmUnLCAndG91Y2hlbmQnLCAndG91Y2hjYW5jZWwnLCAvLyBvdGhlclxuJ2NvbnRleHRtZW51JywgJ3NlbGVjdCcsICdzZWxlY3Rpb25jaGFuZ2UnXTtcblxuZnVuY3Rpb24gYXR0YWNoTGlzdGVuZXJzKCkge1xuICBpZiAoX0V4ZWN1dGlvbkVudmlyb25tZW50LmNhblVzZURPTSAmJiB3aW5kb3cuX19yZWFjdFJlc3BvbmRlclN5c3RlbUFjdGl2ZSA9PSBudWxsKSB7XG4gICAgd2luZG93LmFkZEV2ZW50TGlzdGVuZXIoJ2JsdXInLCBldmVudExpc3RlbmVyKTtcbiAgICBkb2N1bWVudEV2ZW50c0J1YmJsZVBoYXNlLmZvckVhY2goZnVuY3Rpb24gKGV2ZW50VHlwZSkge1xuICAgICAgZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihldmVudFR5cGUsIGV2ZW50TGlzdGVuZXIpO1xuICAgIH0pO1xuICAgIGRvY3VtZW50RXZlbnRzQ2FwdHVyZVBoYXNlLmZvckVhY2goZnVuY3Rpb24gKGV2ZW50VHlwZSkge1xuICAgICAgZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihldmVudFR5cGUsIGV2ZW50TGlzdGVuZXIsIHRydWUpO1xuICAgIH0pO1xuICAgIHdpbmRvdy5fX3JlYWN0UmVzcG9uZGVyU3lzdGVtQWN0aXZlID0gdHJ1ZTtcbiAgfVxufVxuLyoqXG4gKiBSZWdpc3RlciBhIG5vZGUgd2l0aCB0aGUgUmVzcG9uZGVyU3lzdGVtLlxuICovXG5cblxuZnVuY3Rpb24gYWRkTm9kZShpZCwgbm9kZSwgY29uZmlnKSB7XG4gICgwLCBfdXRpbHMuc2V0UmVzcG9uZGVySWQpKG5vZGUsIGlkKTtcbiAgcmVzcG9uZGVyTGlzdGVuZXJzTWFwLnNldChpZCwgY29uZmlnKTtcbn1cbi8qKlxuICogVW5yZWdpc3RlciBhIG5vZGUgd2l0aCB0aGUgUmVzcG9uZGVyU3lzdGVtLlxuICovXG5cblxuZnVuY3Rpb24gcmVtb3ZlTm9kZShpZCkge1xuICBpZiAoY3VycmVudFJlc3BvbmRlci5pZCA9PT0gaWQpIHtcbiAgICB0ZXJtaW5hdGVSZXNwb25kZXIoKTtcbiAgfVxuXG4gIGlmIChyZXNwb25kZXJMaXN0ZW5lcnNNYXAuaGFzKGlkKSkge1xuICAgIHJlc3BvbmRlckxpc3RlbmVyc01hcC5kZWxldGUoaWQpO1xuICB9XG59XG4vKipcbiAqIEFsbG93IHRoZSBjdXJyZW50IHJlc3BvbmRlciB0byBiZSB0ZXJtaW5hdGVkIGZyb20gd2l0aGluIGNvbXBvbmVudHMgdG8gc3VwcG9ydFxuICogbW9yZSBjb21wbGV4IHJlcXVpcmVtZW50cywgc3VjaCBhcyB1c2Ugd2l0aCBvdGhlciBSZWFjdCBsaWJyYXJpZXMgZm9yIHdvcmtpbmdcbiAqIHdpdGggc2Nyb2xsIHZpZXdzLCBpbnB1dCB2aWV3cywgZXRjLlxuICovXG5cblxuZnVuY3Rpb24gdGVybWluYXRlUmVzcG9uZGVyKCkge1xuICB2YXIgX2N1cnJlbnRSZXNwb25kZXIzID0gY3VycmVudFJlc3BvbmRlcixcbiAgICAgIGlkID0gX2N1cnJlbnRSZXNwb25kZXIzLmlkLFxuICAgICAgbm9kZSA9IF9jdXJyZW50UmVzcG9uZGVyMy5ub2RlO1xuXG4gIGlmIChpZCAhPSBudWxsICYmIG5vZGUgIT0gbnVsbCkge1xuICAgIHZhciBfZ2V0UmVzcG9uZGVyQ29uZmlnNCA9IGdldFJlc3BvbmRlckNvbmZpZyhpZCksXG4gICAgICAgIG9uUmVzcG9uZGVyVGVybWluYXRlID0gX2dldFJlc3BvbmRlckNvbmZpZzQub25SZXNwb25kZXJUZXJtaW5hdGU7XG5cbiAgICBpZiAob25SZXNwb25kZXJUZXJtaW5hdGUgIT0gbnVsbCkge1xuICAgICAgdmFyIGV2ZW50ID0gKDAsIF9jcmVhdGVSZXNwb25kZXJFdmVudC5kZWZhdWx0KSh7fSk7XG4gICAgICBldmVudC5jdXJyZW50VGFyZ2V0ID0gbm9kZTtcbiAgICAgIG9uUmVzcG9uZGVyVGVybWluYXRlKGV2ZW50KTtcbiAgICB9XG5cbiAgICBjaGFuZ2VDdXJyZW50UmVzcG9uZGVyKGVtcHR5UmVzcG9uZGVyKTtcbiAgfVxuXG4gIGlzRW11bGF0aW5nTW91c2VFdmVudHMgPSBmYWxzZTtcbiAgdHJhY2tlZFRvdWNoQ291bnQgPSAwO1xufVxuLyoqXG4gKiBBbGxvdyB1bml0IHRlc3RzIHRvIGluc3BlY3QgdGhlIGN1cnJlbnQgcmVzcG9uZGVyIGluIHRoZSBzeXN0ZW0uXG4gKiBGT1IgVEVTVElORyBPTkxZLlxuICovXG5cblxuZnVuY3Rpb24gZ2V0UmVzcG9uZGVyTm9kZSgpIHtcbiAgcmV0dXJuIGN1cnJlbnRSZXNwb25kZXIubm9kZTtcbn0iXX0=